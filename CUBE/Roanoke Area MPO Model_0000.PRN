Page 1  (VOYAGER PILOT) 
Parsons Brinckerhoff
------------------------
PILOT (v.08/05/2014 [6.1.1]) Fri Mar 18 15:14:22 2016

Args: C:\Users\SARVEP~1\AppData\Local\Temp\Cit4D1E.tmp -SC:\PROJECTS\ROANOKE\CUBE\ -RC:\projects\Roanoke\Cube\Roanoke Area MPO Model_0000.PRN -PH:58 -PW:80 -I -P"Roan"
Input:   C:\Users\SARVEP~1\AppData\Local\Temp\Cit4D1E.tmp

SYS=(del C:\projects\Roanoke\CUBE\*.prn)
SYS=(del C:\projects\Roanoke\CUBE\*.bak)
SYS=(del C:\projects\Roanoke\CUBE\*.0??)
SYS=(del C:\projects\Roanoke\CUBE\trc*.s)
SYS=(IF NOT EXIST "C:\projects\Roanoke\Base\Output" MKDIR "C:\projects\Roanoke\Base\Output")
SYS=(IF NOT EXIST "C:\projects\Roanoke\Base\OUTPUT" MKDIR "C:\projects\Roanoke\Base\OUTPUT")
SYS=(IF NOT EXIST "C:\projects\Roanoke\Base\OUTPUT\LOGS" MKDIR "C:\projects\Roanoke\Base\OUTPUT\LOGS")
RUN PGM=NETWORK,767 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\AT_1.PRN" MSG='OUTPUT LINK AND ZONE DATA'
RUN PGM=MATRIX,2258 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\AT_2.PRN" MSG='FIND THE CLOSEST ZONE TO EACH LINK'
RUN PGM=NETWORK,3549 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\AT_3.PRN" MSG='INSERT LINK DATA TO NETWORK'
RUN PGM=NETWORK,4773 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\AT_4.PRN" MSG='ADD LAND USE DATA TO ZONES'
RUN PGM=NETWORK,5920 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\AT-5.PRN" MSG='DETERMINE AREA TYPE FROM LAND USE DENSITY AND PROXIMITY'
RUN PGM=NETWORK,9354 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\AT_6.PRN" MSG='INSERT LINK AREA TYPE ON THE NETWORK'
RUN PGM=MATRIX,10635 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\AT_7.PRN" MSG='OUTPUT AREA TYPE AS DBF FOR LATER USE'
Rexe = 'C:\projects\Roanoke\R\R-3.2.2\bin\Rscript.exe'
Rscript = 'C:\projects\Roanoke\R\calculate_capacities.R'
link_file = 'C:\projects\Roanoke\Base\Output\link_atype2012A.DBF'
output_file = 'C:\projects\Roanoke\Base\Output\link_capacities2012A.DBF'
PRINT LIST= Rexe ' ' Rscript ' ' link_file ' ' output_file,
 FILE = "C:\projects\Roanoke\CUBE\LINK_CALC.BAT"
SYS=(C:\projects\Roanoke\CUBE\LINK_CALC.BAT)
RUN PGM=NETWORK,12830 MSG='Attach capacity and FFS to network'
RUN PGM=HIGHWAY,15403 PRNFILE="C:\projects\Roanoke\Base\Output\Logs\FreeFlowSpeeds.PRN" MSG='Build Initial Skims'
SYS=(COPY C:\projects\Roanoke\Base\Output\IMPED11.MAT C:\projects\Roanoke\Base\OUTPUT\PK_FreeFlow_Skim.MAT)
SYS=(COPY C:\projects\Roanoke\Base\Output\IMPED11.MAT C:\projects\Roanoke\Base\OUTPUT\OP_FreeFlow_Skim.MAT)
Rexe = 'C:\projects\Roanoke\R\R-3.2.2\bin\Rscript.exe'
Rscript = 'C:\projects\Roanoke\R\classification.R'
input_se_file = 'C:\projects\Roanoke\Base\Input\se_2012.dbf'
lookup_dir = 'C:\projects\Roanoke\Params\classification'
output_file = 'C:\projects\Roanoke\Base\Output\se_classified_2012A.dbf'
PRINT LIST= Rexe ' ' Rscript ' ' input_se_file ' ' lookup_dir ' ' output_file,
 FILE = "C:\projects\Roanoke\CUBE\CLASSIFICATION.BAT"
SYS=(C:\projects\Roanoke\CUBE\CLASSIFICATION.BAT)
RUN PGM=GENERATION,18866 MSG='Household Trip Production'
RUN PGM=NETWORK,25975 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\TransitSpeeds.PRN" MSG='Transit Speeds'
RUN PGM='PUBLIC TRANSPORT',29619 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\BuildWalkAccessConenctors.PRN" MSG='Build Walk Access Connectors'
RUN PGM=MATRIX,31919 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\WalkAccess_ByMode.PRN" MSG='Subdivide Connectors into Separate Files by Mode'
RUN PGM='PUBLIC TRANSPORT',33920 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\Trn_PK_Skims.PRN" MSG='PK-Walk Access Paths / Skims'
RUN PGM='PUBLIC TRANSPORT',37776 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\Trn_OP_Skims.PRN" MSG='OP-Walk Access Paths / Skims'
RUN PGM=FRATAR,41563 MSG='Future year EE Table'
RUN PGM=MATRIX,42433
RUN PGM=MATRIX,43141 MSG='Process Highway Skims'
RUN PGM=GENERATION,44249 MSG='IEEI_TripGen'
RUN PGM=MATRIX,45654 MSG='NR-NHB Model'
RUN PGM=DISTRIBUTION,46302 MSG='IEEI_TripDist'
RUN PGM=MATRIX,47609
RUN PGM=MATRIX,49221 MSG='EE TOD'
RUN PGM=GENERATION,50389 MSG='CV_TripGen'
RUN PGM=DISTRIBUTION,51735Page 2  (VOYAGER PILOT) 
Parsons Brinckerhoff
------------------------
RUN PGM=MATRIX,53856
RUN PGM=MATRIX,55307 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\CV_TLFD.PRN" MSG='Trip Length Frequency'
LOOP FeedBack_ITER = 1, 5, 1
IF (FeedBack_ITER=1)
FB_ITER = 1
pk_hwy_skim = 'PK_FreeFlow_Skim.MAT'
OP_hwy_skim = 'OP_FreeFlow_Skim.MAT'
ELSE
pk_hwy_skim = 'PK_CNG_HwySkim.MAT'
OP_hwy_skim = 'OP_CNG_HwySkim.MAT'
ENDIF
RUN PGM=MATRIX,58782 MSG='Process Highway Skims'
RUN PGM=MATRIX,59848 MSG='Process Highway Skims'
  LOOP PURPOSE = 1, 4, 1
IF (PURPOSE=1) ; HBW Purpose
PURP='HBW'
PURPNO=3
PRK='LONGPARK'
hwySkim = 'pk_Hwyskim.MAT'
busSkim = 'pk_TSKIMBus.MAT'
premSkim = 'PK_TSKIMPrem.MAT'
ELSEIF (PURPOSE=2) ; HBO Purpose
PURP='HBO'
PURPNO=4
PRK='LONGPARK'
hwySkim = 'op_Hwyskim.MAT'
busSkim = 'op_TSKIMBus.MAT'
premSkim = 'op_TSKIMPrem.MAT'
ELSEIF (PURPOSE=3) ; NHB Purpose
PURP='NHB'
PURPNO=5
PRK='LONGPARK'
hwySkim = 'op_Hwyskim.MAT'
busSkim = 'op_TSKIMBus.MAT'
premSkim = 'op_TSKIMPrem.MAT'
ELSEIF (PURPOSE=4) ; HBSC Purpose
PURP='HBSC'
PURPNO=5
PRK='LONGPARK'
hwySkim = 'op_Hwyskim.MAT'
busSkim = 'op_TSKIMBus.MAT'
premSkim = 'op_TSKIMPrem.MAT'
ENDIF
RUN PGM=MATRIX,61798 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\@PURP@_logsum.PRN" MSG='Mode Choice Logsums and Probabilities'
  ENDLOOP
RUN PGM=MATRIX,74229 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\TDMAT00C.PRN" MSG='HBSC FF'
RUN PGM=DISTRIBUTION,74946 PRNFILE="C:\projects\Roanoke\Base\Output\Logs\HBSC_distribution.PRN" MSG='Gravity Model - HBSC'
RUN PGM=MATRIX,76391 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_D2D_Flwos.PRN" MSG='HBSC District - to - District Flows'
RUN PGM=MATRIX,77022 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_noSchoolTrips.PRN" MSG='HBSC - no sch bus trips'
SYS=(COPY C:\projects\Roanoke\PARAMS\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf)
  LOOP Iteration = 1, 10, 1
RUN PGM=MATRIX,77704 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN" MSG='HBW Apply Destination Choice Model'
RUN PGM=MATRIX,86640 MSG='Shadow Price'
SYS=(COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_@ITERATION@.dbf)Page 3  (VOYAGER PILOT) 
Parsons Brinckerhoff
------------------------
  ENDLOOP
  LOOP PURPOSE = 2, 4, 1
IF (PURPOSE=1) ; HBW PK
PURP='HBW'
MCLS_MAT = 'HBW'
PERIOD='PK'
PURPNO=1
MARKETS=1
isHBW=' '
noHBW=';'
isNHB=';'
noNHB=' '
PRINT LIST="Trip Distribution Loop Number = 1 of 4 HBW", printo=0
ELSEIF (PURPOSE=2) ; HBO
PURP='HBO'
MCLS_MAT = 'HBO'
PERIOD='PK'
PURPNO=2
MARKETS=1
isHBW=';'
noHBW=' '
isNHB=';'
noNHB=' '
PRINT LIST="Trip Distribution Loop Number = 2 of 4 HBO ", printo=0
ELSEIF (PURPOSE=3) ; HBSH
PURP='HBSH'
MCLS_MAT = 'HBO'
PERIOD='PK'
PURPNO=3
MARKETS=1
isHBW=';'
noHBW=' '
isNHB=';'
noNHB=' '
PRINT LIST="Trip Distribution Loop Number = 3 of 4 HBSH", printo=0
ELSEIF (PURPOSE=4) ; NHBW
PURP='NHB'
MCLS_MAT = 'NHB'
PERIOD='PK'
PURPNO=4
MARKETS=1
isHBW=';'
noHBW=' '
isNHB=' '
noNHB=';'
PRINT LIST="Trip Distribution Loop Number = 4 of 4 NHB ", printo=0
ENDIF
RUN PGM=MATRIX,88579 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_@PURP@.PRN" MSG='Apply Destination Choice Model'
RUN PGM=MATRIX,97423 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN" MSG='Non-Work Trip Length Frequency'
RUN PGM=MATRIX,98897 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN" MSG='Non-Work Trip Time Frequency'
RUN PGM=MATRIX,100339 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN" MSG='District - to - District Flows'
  ENDLOOP
RUN PGM=MATRIX,100964 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\work_tlfd_msg.PRN" MSG='Work Trip Length Frequency'
RUN PGM=MATRIX,102425 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\work_ttfd_msg.PRN" MSG='Work Trip Time Frequency'Page 4  (VOYAGER PILOT) 
Parsons Brinckerhoff
------------------------
RUN PGM=MATRIX,103853 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\work_d2d_flows.PRN" MSG='HBW District - to - District Flows'
RUN PGM=MATRIX,104509 MSG='HBO + HBSH'
  LOOP PURPOSE = 1, 4, 1
IF (PURPOSE=1) ; HBW Purpose
PURP='HBW'
PURPNAME = 'HBW'
PURPNO=3
PRK='LONGPARK'
ELSEIF (PURPOSE=2) ; HBO Purpose
PURP='HBO'
PURPNAME = 'HBO_HBSH'
PURPNO=4
PRK='LONGPARK'
ELSEIF (PURPOSE=3) ; NHB Purpose
PURP='NHB'
PURPNAME='NHB'
PURPNO=5
PRK='LONGPARK'
ELSEIF (PURPOSE=4) ; SCH Purpose
PURP='HBSC'
PURPNAME='HBSC'
PURPNO=6
PRK='LONGPARK'
ENDIF
RUN PGM=MATRIX,105616
  ENDLOOP
  LOOP PER = 1, 4, 1
IF (PER=1) ; AM
PERIOD_COL=3
PERIOD_NAME = 'AM'
ELSEIF (PER=2) ; MD
PERIOD_COL=4
PERIOD_NAME = 'MD'
ELSEIF (PER=3) ; PM
PERIOD_COL=6
PERIOD_NAME = 'PM'
ELSEIF (PER=4) ; NT
PERIOD_COL=5
PERIOD_NAME = 'NT'
ENDIF
RUN PGM=MATRIX,108811 PRNFILE="C:\projects\Roanoke\Base\Output\Logs\TOD_Model_@PERIOD_NAME@.PRN" MSG='Convert PA Trips to OD Trips'
  ENDLOOP
RUN PGM=MATRIX,110995 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\MC_Transit_Trips.PRN" MSG='Transit Trips'
  LOOP PER = 1, 4, 1
IF (PER=1) ; AM
PERIOD_COL=3
PERIOD_NAME = 'AM'
ELSEIF (PER=2) ; MD
PERIOD_COL=4
PERIOD_NAME = 'MD'
ELSEIF (PER=3) ; PM
PERIOD_COL=5
PERIOD_NAME = 'PM'
ELSEIF (PER=4) ; NTPage 5  (VOYAGER PILOT) 
Parsons Brinckerhoff
------------------------
PERIOD_COL=6
PERIOD_NAME = 'NT'
ENDIF
RUN PGM=HIGHWAY,112387 PRNFILE="C:\projects\ROANOKE\CUBE\ASHWY00A.PRN" MSG='Preload External Trips'
RUN PGM=HIGHWAY,114949 PRNFILE="C:\projects\Roanoke\Base\Output\Logs\@PERIOD_NAME@.PRN" MSG='Load Final Trips onto Network'
  ENDLOOP
RUN PGM=NETWORK,118508 PRNFILE="C:\projects\Roanoke\Base\Output\Merge_Hwy_Assignments.PRN"
RUN PGM=NETWORK,122495 PRNFILE="C:\projects\Roanoke\Base\Output\Hwy_eval.PRN"
RUN PGM=HIGHWAY,142920 PRNFILE="C:\projects\Roanoke\Base\Output\Logs\PBHWY00B.PRN" MSG='Build PK congested skims'
RUN PGM=HIGHWAY,144748 PRNFILE="C:\projects\ROANOKE\CUBE\PBHWY00A.PRN" MSG='Build OP congested skims'
SYS=(COPY C:\projects\Roanoke\Base\Output\PK_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\PK_HWYSKIM_@Feedback_ITER@.MAT)
SYS=(COPY C:\projects\Roanoke\Base\Output\OP_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\OP_HWYSKIM_@Feedback_ITER@.MAT)
ENDLOOP
RUN PGM='PUBLIC TRANSPORT',147199 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\Trn_Assignment_PK.PRN" MSG='Transit Assignment'
RUN PGM='PUBLIC TRANSPORT',148332 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\Trn_Assignment_OP.PRN" MSG='Transit Assignment'
SYS=(COPY "C:\projects\Roanoke\CUBE\*.PRN" "C:\projects\Roanoke\Base\OUTPUT\LOGS\*.PRN")
SYS=(DEL "C:\projects\Roanoke\CUBE\*.PRN")

PILOT Stack Size = 16028 bytes.
................................................................................


--------------------------------------------------------------------------------

SYS "del C:\projects\Roanoke\CUBE\*.prn"
C:\projects\Roanoke\CUBE\Roanoke Area MPO Model_0000.PRN

SYS ReturnCode = 0

--------------------------------------------------------------------------------

--------------------------------------------------------------------------------

SYS "del C:\projects\Roanoke\CUBE\*.bak"

SYS ReturnCode = 0

--------------------------------------------------------------------------------

--------------------------------------------------------------------------------

SYS "del C:\projects\Roanoke\CUBE\*.0??"

SYS ReturnCode = 0

--------------------------------------------------------------------------------

--------------------------------------------------------------------------------Page 6  (VOYAGER PILOT) 
Parsons Brinckerhoff
------------------------

SYS "del C:\projects\Roanoke\CUBE\trc*.s"

SYS ReturnCode = 0

--------------------------------------------------------------------------------

--------------------------------------------------------------------------------

SYS "IF NOT EXIST "C:\projects\Roanoke\Base\Output" MKDIR "C:\projects\Roanoke\Base\Output""

SYS ReturnCode = 0

--------------------------------------------------------------------------------

--------------------------------------------------------------------------------

SYS "IF NOT EXIST "C:\projects\Roanoke\Base\OUTPUT" MKDIR "C:\projects\Roanoke\Base\OUTPUT""

SYS ReturnCode = 0

--------------------------------------------------------------------------------

--------------------------------------------------------------------------------

SYS "IF NOT EXIST "C:\projects\Roanoke\Base\OUTPUT\LOGS" MKDIR "C:\projects\Roanoke\Base\OUTPUT\LOGS""

SYS ReturnCode = 0

--------------------------------------------------------------------------------

M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\AT_1.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Fri Mar 18 15:14:23 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\AT_2.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:14:23 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\AT_3.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Fri Mar 18 15:14:24 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\AT_4.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Fri Mar 18 15:14:24 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\AT-5.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Fri Mar 18 15:14:24 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\AT_6.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Fri Mar 18 15:14:25 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\AT_7.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:14:25 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


--------------------------------------------------------------------------------

SYS "C:\projects\Roanoke\CUBE\LINK_CALC.BAT"

C:\PROJECTS\ROANOKE\CUBE>C:\projects\Roanoke\R\R-3.2.2\bin\Rscript.exe C:\projects\Roanoke\R\calculate_capacities.R C:\projects\Roanoke\Base\Output\link_atype2012A.DBF C:\projects\Roanoke\Base\Output\link_capacities2012A.DBF 

SYS ReturnCode = 0

--------------------------------------------------------------------------------Page 23  (VOYAGER NETWORK) 
Parsons Brinckerhoff
---------------------------
NETWORK (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:03 2016

FILEO NETO = "C:\projects\Roanoke\Base\Output\RVTPOBase2012A.NET"
FILEI LINKI[2] = "C:\projects\Roanoke\Base\Output\link_capacities2012A.DBF"
FILEI LINKI[1] = "C:\projects\Roanoke\Base\Output\ATYPE NETWORK2012A.NET"

PROCESS  PHASE=INPUT
;Use this phase to modify data as it is read, such as recoding node numbers.


ENDPROCESS


PROCESS  PHASE=NODEMERGE
; Use this phase to make computations and selections of any data on the NODEI files.


ENDPROCESS


PROCESS  PHASE=LINKMERGE
; Use this phase to make computations and selections of any data on the LINKI files.
CAPE_AM = LI.2.CAPE * 2.79 ; 2.5  ; AM Capacity
CAPE_MD = LI.2.CAPE * 4.40 ; 5.5  ; MD Capacity
CAPE_PM = LI.2.CAPE * 3.18 ; 2.5  ; PM Capacity
CAPE_NT = LI.2.CAPE * 5.63 ; 4.5  ; NT Capacity
POST_SPEED = LI.1.POST_SPD



; Arterials
IF (LI.1.FACTYPE > 2 & LI.1.FACTYPE < 5 & LI.1.POST_SPD > 25 )
     FFSPEED = LI.1.POST_SPD - 5
ENDIF

; Local and collector
IF (LI.1.FACTYPE > 6 & LI.1.FACTYPE < 9 & LI.1.POST_SPD <> 0)
     FFSPEED = LI.1.POST_SPD + 3
ENDIF



ENDPROCESS


PROCESS  PHASE=SUMMARY
; Use this phase for combining and reporting of working variables.


ENDPROCESS


NETWORK Stack Size = 1302 bytes.Page 24  (VOYAGER NETWORK) 
Parsons Brinckerhoff
---------------------------
................................................................................




C:\projects\Roanoke\Base\Output\ATYPE NETWORK2012A.NET   (VOYAGER):

NET PGM=NETWORK (v.08/05/2014 [6.1.1]) DATE=Fri Mar 18 15:14:25 2016
ID= 
PAR Zones=267 Nodes=5714 Links=9073 NodeRecs=4642 
NVR 25    N    Z    DISTRICT    COUNTY    ACRES    POP    HH    WORK    VEH
    EMP    EMP_NOSG    SCHOOL    IND    RET    HTRET    OFF    SER    SG_RET
    SG_HOS    SG_AIR    SG_COL    SG_NAME=053    ID    X    Y
LVR 25    A    B    ID    LENGTH    DIR    DISTANCE    FACTYPE    LANES
    MEDIAN=001    TERRAIN    POST_SPD    RTE_NAME=029    AAWDT    TMS_ID=020
    SCREENLN    TUNNEL=001    BRIDGE=001    TRK_PHB=001    PED_PHB=001
    TRAFF_PHB=001    TOLL    DESIGNCONST    ZN    DIST_XY    ATYPE


C:\projects\Roanoke\Base\Output\link_capacities2012A.DBF (DBF):
A          B          FFSPEED    CAPD       CAPE       


Begin PROCESS PHASE INPUT
     9073 records read from LINKI[2]: C:\projects\Roanoke\Base\Output\link_capacities2012A.DBF
End   PROCESS PHASE INPUT


Begin PROCESS PHASE NODEMERGE
       4,642 records merged from NODEI[1]: C:\projects\Roanoke\Base\Output\ATYPE NETWORK2012A.NET
       4,642 data base records.Page 25  (VOYAGER NETWORK) 
Parsons Brinckerhoff
---------------------------

Variable  Obs<>0          Total        Ave        Min        Max        RMS  
--------  ------          -----        ---        ---        ---        ---  
N          4,642             --         --       1      5,714            --
Z            205      21,125        103.05       1        206        118.87
DISTRICT     205       1,333          6.5        1         12          7.41
COUNTY       205  10,556,836     51,496.76  51,019     51,775     51,497.75
ACRES        205     158,960.21     775.42      64.05   6,223.82   1,249.34
POP          201     257,292      1,280.06      22      5,661      1,585.46
HH           201     113,015        562.26      10      2,588        709.83
WORK         201     126,846        631.07      12      2,929        805.93
VEH          201     199,984        994.95      15      3,998      1,260.71
EMP          205     131,629        642.09       1      3,976        959.49
EMP_NOSG     205     124,206        605.88       1      3,441        883.78
SCHOOL        50      35,388        707.76      50      2,581        883.56
IND          181      21,155        116.88       1      1,937        254.16
RET          181      21,169        116.96       1        878        186.72
HTRET        146      10,568         72.38       1        401        112.9 
OFF          192      23,117        120.4        1      1,635        259.29
SER          204      48,197        236.26       1      1,450        377.54
SG_RET         2       2,711      1,355.5      308      2,403      1,713.08
SG_HOS         3       3,059      1,019.67     455      1,419      1,099.21
SG_AIR         1         535        535        535        535        535   
SG_COL         3       1,118        372.67     322        450        376.78
SG_NAME        9                            (Hollins )  (Virginia)
ID           204      20,910        102.5        1        204        118.21
X          4,642    -371,190.45     -79.96     -80.28     -79.78      79.96
Y          4,642     173,108.91      37.29      37.13      37.5       37.29

_Variables with values:

_ZONES              267      

End   PROCESS PHASE NODEMERGE


Begin PROCESS PHASE LINKMERGE
       9,073 records merged from NETI[1]: C:\projects\Roanoke\Base\Output\ATYPE NETWORK2012A.NET
       9,073 records merged from NETI[2]: L2.106046
       9,073 data base records.Page 26  (VOYAGER NETWORK) 
Parsons Brinckerhoff
---------------------------

Variable     Obs<>0           Total        Ave       Min         Max        RMS  
--------     ------           -----        ---       ---         ---        ---  
A             9,073              --         --      1       5,714            --
B             9,073              --         --      1       5,714            --
FFSPEED       9,073      321,454         35.43     18          74         37.19
CAPD          9,073   22,486,178      2,478.36    600     100,000      6,850.38
CAPE          9,073   23,377,272      2,576.58    700     100,000      6,880.73
ID            9,067   41,110,029      4,534.03      1       9,067      5,235.31
LENGTH        9,067        1,215.25       0.13      0.01        3.27       0.23
DISTANCE      8,324        1,004.61       0.12      0.01        3.49       0.22
FACTYPE       9,073       53,047          5.85      1          12          6.26
LANES         8,325       11,180          1.34      1           3          1.44
TERRAIN       9,069        9,069          1         1           1          1   
POST_SPD      8,325      277,475         33.33      5          70         35.16
RTE_NAME      7,336                             (        )  (        )
AAWDT           507    4,022,331      7,933.59      1      43,583     10,839.45
TMS_ID        9,063                             (        )  (  686146)
SCREENLN        120          310          2.58      1           4          2.89
TUNNEL        8,315                             (N       )  (Y       )
BRIDGE        8,315                             (N       )  (N       )
TRK_PHB       8,315                             (N       )  (Y       )
PED_PHB       8,315                             (N       )  (Y       )
TRAFF_PHB     8,315                             (Y       )  (Y       )
DESIGNCONST   1,493        1,493          1         1           1          1   
ZN            9,073      903,483         99.58      1         267        118.32
ATYPE         9,073       35,015          3.86      2           5          3.95
CAPE_AM       9,073   65,222,588.88   7,188.65  1,953     279,000     19,197.25
CAPE_MD       9,073  102,859,996.8   11,336.93  3,080     440,000     30,275.23
CAPE_PM       9,073   74,339,724.96   8,193.51  2,226     318,000     21,880.73
CAPE_NT       9,073  131,614,041.36  14,506.12  3,941     563,000     38,738.53
POST_SPEED    8,325      277,475         33.33      5          70         35.16

      Obs = 0:  DIR  MEDIAN  TOLL  DIST_XY

_Variables with values:

_ZONES              267      

End   PROCESS PHASE LINKMERGE

M(664): Unconnected Zones:  196<->  207-249<->  255-256<->


Begin PROCESS PHASE SUMMARY

_Variables with values:

_ZONES              267      

End   PROCESS PHASE SUMMARYPage 27  (VOYAGER NETWORK) 
Parsons Brinckerhoff
---------------------------

FILEO NETO=C:\projects\Roanoke\Base\Output\RVTPOBase2012A.NET

NET PGM=NETWORK (v.08/05/2014 [6.1.1]) DATE=Fri Mar 18 15:15:03 2016
ID= 
PAR Zones=267 Nodes=5714 Links=9073 NodeRecs=4642 
NVR 25    N    Z    DISTRICT    COUNTY    ACRES    POP    HH    WORK    VEH
    EMP    EMP_NOSG    SCHOOL    IND    RET    HTRET    OFF    SER    SG_RET
    SG_HOS    SG_AIR    SG_COL    SG_NAME=053    ID    X    Y
LVR 33    A    B    FFSPEED    CAPD    CAPE    ID    LENGTH    DIR
    DISTANCE    FACTYPE    LANES    MEDIAN=001    TERRAIN    POST_SPD
    RTE_NAME=029    AAWDT    TMS_ID=020    SCREENLN    TUNNEL=001    BRIDGE=001
    TRK_PHB=001    PED_PHB=001    TRAFF_PHB=001    TOLL    DESIGNCONST    ZN
    DIST_XY    ATYPE    CAPE_AM    CAPE_MD    CAPE_PM    CAPE_NT    POST_SPEED


NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\FreeFlowSpeeds.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:03 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\Output\IMPED11.MAT C:\projects\Roanoke\Base\OUTPUT\PK_FreeFlow_Skim.MAT
M(100): COPY C:\projects\Roanoke\Base\Output\IMPED11.MAT C:\projects\Roanoke\Base\OUTPUT\OP_FreeFlow_Skim.MAT

--------------------------------------------------------------------------------

SYS "C:\projects\Roanoke\CUBE\CLASSIFICATION.BAT"

C:\PROJECTS\ROANOKE\CUBE>C:\projects\Roanoke\R\R-3.2.2\bin\Rscript.exe C:\projects\Roanoke\R\classification.R C:\projects\Roanoke\Base\Input\se_2012.dbf C:\projects\Roanoke\Params\classification C:\projects\Roanoke\Base\Output\se_classified_2012A.dbf 

SYS ReturnCode = 0

--------------------------------------------------------------------------------Page 30  (VOYAGER GENERATION) 
Parsons Brinckerhoff
------------------------------
GENERATION (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:06 2016

FILEO PRINTO[1] = "C:\projects\Roanoke\Base\Output\hbw.csv"
FILEI LOOKUPI[6] = "C:\projects\Roanoke\PARAMS\TRIP_PROD\NHBO.DBF"
FILEI LOOKUPI[5] = "C:\projects\Roanoke\PARAMS\TRIP_PROD\HBSHOP.DBF"
FILEI LOOKUPI[4] = "C:\projects\Roanoke\PARAMS\TRIP_PROD\HBSCHOOL.DBF"
FILEI LOOKUPI[3] = "C:\projects\Roanoke\PARAMS\TRIP_PROD\HBO.DBF"
FILEI LOOKUPI[2] = "C:\projects\Roanoke\PARAMS\TRIP_PROD\NHBW.DBF"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\TRIP_PROD\HBW.DBF"
FILEO PAO[1] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF",
  FORM=10.3, LIST = Z, P[1], P[2], P[3], P[4], P[5], P[6], DBF=T,
  NAMES = TAZ, HBWP, NHBWP, HBOP, HBSCP, HBSHP, NHBOP
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Output\se_classified_2012A.dbf"

ZONES = 267

LOOKUP LOOKUPI=1, NAME=hbw_lu,
  LOOKUP[1]=index, RESULT=vehicle0,
  LOOKUP[2]=index, RESULT=vehicle1,
  LOOKUP[3]=index, RESULT=vehicle2,
  LOOKUP[4]=index, RESULT=vehicle3,
  FAIL[3]=0

LOOKUP LOOKUPI=2, NAME=nhbw_lu,
  LOOKUP[1]=index, RESULT=vehicle0,
  LOOKUP[2]=index, RESULT=vehicle1,
  LOOKUP[3]=index, RESULT=vehicle2,
  LOOKUP[4]=index, RESULT=vehicle3,
  FAIL[3]=0

LOOKUP LOOKUPI=3, NAME=hbo_lu,
  LOOKUP[1]=index, RESULT=vehicle0,
  LOOKUP[2]=index, RESULT=vehicle1,
  LOOKUP[3]=index, RESULT=vehicle2,
  LOOKUP[4]=index, RESULT=vehicle3,
  FAIL[3]=0

LOOKUP LOOKUPI=4, NAME=hbschool_lu,
  LOOKUP[1]=index, RESULT=vehicle0,
  LOOKUP[2]=index, RESULT=vehicle1,
  LOOKUP[3]=index, RESULT=vehicle2,
  LOOKUP[4]=index, RESULT=vehicle3,
  FAIL[3]=0

LOOKUP LOOKUPI=5, NAME=hbshop_lu,
  LOOKUP[1]=index, RESULT=vehicle0,
  LOOKUP[2]=index, RESULT=vehicle1,
  LOOKUP[3]=index, RESULT=vehicle2,
  LOOKUP[4]=index, RESULT=vehicle3,
  FAIL[3]=0

LOOKUP LOOKUPI=6, NAME=nhbo_lu,
  LOOKUP[1]=index, RESULT=vehicle0,
  LOOKUP[2]=index, RESULT=vehicle1,Page 31  (VOYAGER GENERATION) 
Parsons Brinckerhoff
------------------------------
  LOOKUP[3]=index, RESULT=vehicle2,
  LOOKUP[4]=index, RESULT=vehicle3,
  FAIL[3]=0


PROCESS PHASE=ILOOP
; This phase performs a zonal loop (I=1,Zones).  This phase is used to compute productions (P[#]=) and
; attractions (A[#]=) by zone.  Up to 20 P's and 20 A's can be computed in a single run.


  ;# Home-based work productions
  P[1] = 0 +
    zi.1.w0v0 * hbw_lu(1, 1) + zi.1.w0v1 * hbw_lu(2, 1) + zi.1.w0v2 * hbw_lu(3, 1) + zi.1.w0v3 * hbw_lu(4, 1) +
    zi.1.w1v0 * hbw_lu(1, 2) + zi.1.w1v1 * hbw_lu(2, 2) + zi.1.w1v2 * hbw_lu(3, 2) + zi.1.w1v3 * hbw_lu(4, 2) +
    zi.1.w2v0 * hbw_lu(1, 3) + zi.1.w2v1 * hbw_lu(2, 3) + zi.1.w2v2 * hbw_lu(3, 3) + zi.1.w2v3 * hbw_lu(4, 3) +
    zi.1.w3v0 * hbw_lu(1, 4) + zi.1.w3v1 * hbw_lu(2, 4) + zi.1.w3v2 * hbw_lu(3, 4) + zi.1.w3v3 * hbw_lu(4, 4)

  ;# Non home-based work productions
  P[2] = 0 +
    zi.1.w0v0 * nhbw_lu(1, 1) + zi.1.w0v1 * nhbw_lu(2, 1) + zi.1.w0v2 * nhbw_lu(3, 1) + zi.1.w0v3 * nhbw_lu(4, 1) +
    zi.1.w1v0 * nhbw_lu(1, 2) + zi.1.w1v1 * nhbw_lu(2, 2) + zi.1.w1v2 * nhbw_lu(3, 2) + zi.1.w1v3 * nhbw_lu(4, 2) +
    zi.1.w2v0 * nhbw_lu(1, 3) + zi.1.w2v1 * nhbw_lu(2, 3) + zi.1.w2v2 * nhbw_lu(3, 3) + zi.1.w2v3 * nhbw_lu(4, 3) +
    zi.1.w3v0 * nhbw_lu(1, 4) + zi.1.w3v1 * nhbw_lu(2, 4) + zi.1.w3v2 * nhbw_lu(3, 4) + zi.1.w3v3 * nhbw_lu(4, 4)

  ;# Home-based other productions
  P[3] =
    zi.1.p1v0 * hbo_lu(1, 1) + zi.1.p1v1 * hbo_lu(2, 1) + zi.1.p1v2 * hbo_lu(3, 1) + zi.1.p1v3 * hbo_lu(4, 1) +
    zi.1.p2v0 * hbo_lu(1, 2) + zi.1.p2v1 * hbo_lu(2, 2) + zi.1.p2v2 * hbo_lu(3, 2) + zi.1.p2v3 * hbo_lu(4, 2) +
    zi.1.p3v0 * hbo_lu(1, 3) + zi.1.p3v1 * hbo_lu(2, 3) + zi.1.p3v2 * hbo_lu(3, 3) + zi.1.p3v3 * hbo_lu(4, 3) +
    zi.1.p4v0 * hbo_lu(1, 4) + zi.1.p4v1 * hbo_lu(2, 4) + zi.1.p4v2 * hbo_lu(3, 4) + zi.1.p4v3 * hbo_lu(4, 4)


  ;# Home-based school productions
  P[4] = 0 +
    zi.1.p1v0 * hbschool_lu(1, 1) + zi.1.p1v1 * hbschool_lu(2, 1) + zi.1.p1v2 * hbschool_lu(3, 1) + zi.1.p1v3 * hbschool_lu(4, 1) +
    zi.1.p2v0 * hbschool_lu(1, 2) + zi.1.p2v1 * hbschool_lu(2, 2) + zi.1.p2v2 * hbschool_lu(3, 2) + zi.1.p2v3 * hbschool_lu(4, 2) +
    zi.1.p3v0 * hbschool_lu(1, 3) + zi.1.p3v1 * hbschool_lu(2, 3) + zi.1.p3v2 * hbschool_lu(3, 3) + zi.1.p3v3 * hbschool_lu(4, 3) +
    zi.1.p4v0 * hbschool_lu(1, 4) + zi.1.p4v1 * hbschool_lu(2, 4) + zi.1.p4v2 * hbschool_lu(3, 4) + zi.1.p4v3 * hbschool_lu(4, 4)


  ;# Home-based shop productions
  P[5] = 0 +
    zi.1.p1v0 * hbshop_lu(1, 1) + zi.1.p1v1 * hbshop_lu(2, 1) + zi.1.p1v2 * hbshop_lu(3, 1) + zi.1.p1v3 * hbshop_lu(4, 1) +
    zi.1.p2v0 * hbshop_lu(1, 2) + zi.1.p2v1 * hbshop_lu(2, 2) + zi.1.p2v2 * hbshop_lu(3, 2) + zi.1.p2v3 * hbshop_lu(4, 2) +
    zi.1.p3v0 * hbshop_lu(1, 3) + zi.1.p3v1 * hbshop_lu(2, 3) + zi.1.p3v2 * hbshop_lu(3, 3) + zi.1.p3v3 * hbshop_lu(4, 3) +
    zi.1.p4v0 * hbshop_lu(1, 4) + zi.1.p4v1 * hbshop_lu(2, 4) + zi.1.p4v2 * hbshop_lu(3, 4) + zi.1.p4v3 * hbshop_lu(4, 4)

  ;# non-Home-based other productions
  P[6] = 0 +
    zi.1.p1v0 * nhbo_lu(1, 1) + zi.1.p1v1 * nhbo_lu(2, 1) + zi.1.p1v2 * nhbo_lu(3, 1) + zi.1.p1v3 * nhbo_lu(4, 1) +
    zi.1.p2v0 * nhbo_lu(1, 2) + zi.1.p2v1 * nhbo_lu(2, 2) + zi.1.p2v2 * nhbo_lu(3, 2) + zi.1.p2v3 * nhbo_lu(4, 2) +
    zi.1.p3v0 * nhbo_lu(1, 3) + zi.1.p3v1 * nhbo_lu(2, 3) + zi.1.p3v2 * nhbo_lu(3, 3) + zi.1.p3v3 * nhbo_lu(4, 3) +
    zi.1.p4v0 * nhbo_lu(1, 4) + zi.1.p4v1 * nhbo_lu(2, 4) + zi.1.p4v2 * nhbo_lu(3, 4) + zi.1.p4v3 * nhbo_lu(4, 4)
Page 32  (VOYAGER GENERATION) 
Parsons Brinckerhoff
------------------------------
  p1v0 = zi.1.p1v0 * nhbo_lu(1, 1)
  p1v1 = zi.1.p1v1 * nhbo_lu(2, 1)
  p1v2 = zi.1.p1v2 * nhbo_lu(3, 1)
  p1v3 = zi.1.p1v3 * nhbo_lu(4, 1)
  p2v0 = zi.1.p2v0 * nhbo_lu(1, 2)
  p2v1 = zi.1.p2v1 * nhbo_lu(2, 2)
  p2v2 = zi.1.p2v2 * nhbo_lu(3, 2)
  p2v3 = zi.1.p2v3 * nhbo_lu(4, 2)
  p3v0 = zi.1.p3v0 * nhbo_lu(1, 3)
  p3v1 = zi.1.p3v1 * nhbo_lu(2, 3)
  p3v2 = zi.1.p3v2 * nhbo_lu(3, 3)
  p3v3 = zi.1.p3v3 * nhbo_lu(4, 3)
  p4v0 = zi.1.p4v0 * nhbo_lu(1, 4)
  p4v1 = zi.1.p4v1 * nhbo_lu(2, 4)
  p4v2 = zi.1.p4v2 * nhbo_lu(3, 4)
  p4v3 = zi.1.p4v3 * nhbo_lu(4, 4)
  all =
    p1v0 + p1v1 + p1v2 + p1v3 +
    p2v0 + p2v1 + p2v2 + p2v3 +
    p3v0 + p3v1 + p3v2 + p3v3 +
    p4v0 + p4v1 + p4v2 + p4v3


PRINT FORM = 10.10, CSV = T, LIST = Z, P[6], p1v0, p1v1, p1v2, p1v3, p2v0,
  p2v1, p2v2, p2v3, p3v0, p3v1, p3v2, p3v3, p4v0, p4v1, p4v2, p4v3, all,
  PRINTO = 1


ENDPROCESS


PROCESS PHASE=ADJUST



ENDPROCESS


GENERATION Stack Size = 6922 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Output\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        Page 33  (VOYAGER GENERATION) 
Parsons Brinckerhoff
------------------------------

LOOKUP #1: hbw_lu C:\projects\Roanoke\PARAMS\TRIP_PROD\HBW.DBF:
index       N5      workers     C8      vehicle0    N19.15  vehicle1    N19.15 
vehicle2    N19.15  vehicle3    N19.15 

LOOKUP #2: nhbw_lu C:\projects\Roanoke\PARAMS\TRIP_PROD\NHBW.DBF:
index       N5      workers     C8      vehicle0    N19.15  vehicle1    N19.15 
vehicle2    N19.15  vehicle3    N19.15 

LOOKUP #3: hbo_lu C:\projects\Roanoke\PARAMS\TRIP_PROD\HBO.DBF:
index       N5      size        C8      vehicle0    N19.15  vehicle1    N19.15 
vehicle2    N19.15  vehicle3    N19.15 

LOOKUP #4: hbschool_lu C:\projects\Roanoke\PARAMS\TRIP_PROD\HBSCHOOL.DBF:
index       N5      size        C8      vehicle0    N19.15  vehicle1    N19.15 
vehicle2    N19.15  vehicle3    N19.15 

LOOKUP #5: hbshop_lu C:\projects\Roanoke\PARAMS\TRIP_PROD\HBSHOP.DBF:
index       N5      size        C8      vehicle0    N19.15  vehicle1    N19.15 
vehicle2    N19.15  vehicle3    N19.15 

LOOKUP #6: nhbo_lu C:\projects\Roanoke\PARAMS\TRIP_PROD\NHBO.DBF:
index       N5      size        C8      vehicle0    N19.15  vehicle1    N19.15 
vehicle2    N19.15  vehicle3    N19.15 


Total P/A  1  117,678       --
Total P/A  2   62,525       --
Total P/A  3  264,074       --
Total P/A  4   45,117       --
Total P/A  5  136,095       --
Total P/A  6  222,309       --

PHASE=ADJUST:

Total P/A  1  117,678       --
Total P/A  2   62,525       --
Total P/A  3  264,074       --
Total P/A  4   45,117       --
Total P/A  5  136,095       --
Total P/A  6  222,309       --

File C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF opened

GENERATION ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\TransitSpeeds.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:06 2016
NETWORK  ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\BuildWalkAccessConenctors.PRN. 
PUBLIC TRANSPORT (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:07 2016
PUBLIC TRANSPORT ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\WalkAccess_ByMode.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:08 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:02
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\Trn_PK_Skims.PRN. 
PUBLIC TRANSPORT (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:10 2016
PUBLIC TRANSPORT ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\Trn_OP_Skims.PRN. 
PUBLIC TRANSPORT (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:11 2016
PUBLIC TRANSPORT ReturnCode = 1  Elapsed Time = 00:00:02
################################################################################
Page 508  (VOYAGER FRATAR) 
Parsons Brinckerhoff
---------------------------
FRATAR (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:13 2016

FILEI MATI[1] = "C:\projects\Roanoke\Base\INPUT\EE_seed.MAT"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\Base\INPUT\EXTERNALTRIPS_2012.DBF"
FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\EE_2012.MAT",
 MO=1,NAME = EE_TRIPS, DEC=1*D

PARAMETERS MAXRMSE=0.0001 MAXITERS=25
; USE A LOOKUP FILE TO find appropriate factors (1.0 is assumed unless expressly provided)
LOOKUP LOOKUPI=1, LIST=Y,
  NAME=GROWTHF,
  LOOKUP[1]=ZONE,RESULT=AADT_FAC,
  LOOKUP[2]=ZONE,RESULT=AADT_FAC,
  FAIL[1]=1,FAIL[2]=1,FAIL[3]=1

SETPA PGF[1]=GROWTHF(1,I) AGF[1]=GROWTHF(2,I) MW[1]=MI.1.1


FRATAR Stack Size = 606 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\INPUT\EE_seed.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 11 11:08:13 2016 
ID=Model Run
PAR Zones=267 M=1
  EE_Trips
LOOKUP #1: GROWTHF C:\projects\Roanoke\Base\INPUT\EXTERNALTRIPS_2012.DBF:
ZONE        N6      EXTTOTAL    N15.2   EE          N8.2    IEEI        N8.2   
AADT_FAC    N8.2   


LOOKUP   GROWTHF:  FAIL=  1  1  1
         GROWTHF(1,250)  = 1
         GROWTHF(1,251)  = 1
         GROWTHF(1,252)  = 1
         GROWTHF(1,253)  = 1
         GROWTHF(1,254)  = 1
         GROWTHF(1,257)  = 1
         GROWTHF(1,258)  = 1
         GROWTHF(1,259)  = 1
         GROWTHF(1,260)  = 1
         GROWTHF(1,261)  = 1
         GROWTHF(1,262)  = 1
         GROWTHF(1,263)  = 1
         GROWTHF(1,264)  = 1
         GROWTHF(1,265)  = 1
         GROWTHF(1,266)  = 1
         GROWTHF(1,267)  = 1
         GROWTHF(2,250)  = 1
         GROWTHF(2,251)  = 1
         GROWTHF(2,252)  = 1
         GROWTHF(2,253)  = 1
         GROWTHF(2,254)  = 1Page 509  (VOYAGER FRATAR) 
Parsons Brinckerhoff
---------------------------
         GROWTHF(2,257)  = 1
         GROWTHF(2,258)  = 1
         GROWTHF(2,259)  = 1
         GROWTHF(2,260)  = 1
         GROWTHF(2,261)  = 1
         GROWTHF(2,262)  = 1
         GROWTHF(2,263)  = 1
         GROWTHF(2,264)  = 1
         GROWTHF(2,265)  = 1
         GROWTHF(2,266)  = 1
         GROWTHF(2,267)  = 1


W(678): SETPA CONTROL[1]= specified 0 times.

FRATAR:

     MW[1]  =  41,787           Input Total
     P/A[1] =  41,787   41,787  Total
     MW[1]  =  41,787           Final Target

RMSE  MW= 1
-----------
 1     0.00

Totals after Iteration 1 I loop:

	MI.01.001: 41,787
	MW[1]    : 41,787
	MO.01.001: 41,787

FRATAR   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 510  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:13 2016

FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\EXTERNALTRIPS.DBF",
fields=ZONE,AADT,EE_Total,IEEI
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\EXTERNALTRIPS_2012.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\EE_2012.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t

IF ( I >= 250)
  RO.PROD1=ROWSUM(1)
  RO.ATTR1=ROWSUM(2)
  RO.ZONE=I
  RO.EE_Total = RO.PROD1 + RO.ATTR1
  RO.AADT = ZI.1.EXTTOTAL * ZI.1.AADT_FAC
  RO.IEEI = RO.AADT - RO.EE_Total

WRITE RECO=1
ENDIF


MATRIX Stack Size = 850 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\EXTERNALTRIPS_2012.DBF Opened: 16 data records  5 Fields:
ZONE(N)         EXTTOTAL(N)     EE(N)           IEEI(N)         AADT_FAC(N)    


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\EE_2012.MAT Opened
MAT PGM=FRATAR (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:13 2016 
ID=
PAR Zones=267 M=1
  EE_TRIPS

W(754): Following RO.vars not in any RECO:
   PROD1        ATTR1      

Totals from Transpose:

	MI.01.001.T: 41,787

M(660): Transpose Disk Usage (bytes): Data=4,233, Index=1,068.Page 511  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  : 41,787
	MI.01.001.T: 41,787
	MW[1]      : 41,787
	MW[2]      : 41,787

M(751): 18 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\EXTERNALTRIPS.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 512  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:13 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\Output\IMPED11.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1318 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\Output\IMPED11.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Fri Mar 18 15:15:03 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 513  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,627,851.97   @J=I:     23,000,117.16
	MI.01.002: 22,402,469,247.37
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,837,469.97   @J=I:     23,000,795.16
	MW[1]    : 22,425,627,851.97   @J=I:     23,000,117.16
	MW[2]    : 22,402,469,247.37
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,837,469.97   @J=I:     23,000,795.16
	MW[11]   :        627,851.97   @J=I:            117.16
	MW[12]   :        469,247.37
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        773,269.97   @J=I:            785.16
	MO.01.001:        627,851.97
	MO.01.002:        469,247.37
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        773,269.97

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 514  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------
GENERATION (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:13 2016

FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\EXTERNALTRIPS.DBF"
FILEO PAO[1] = "C:\projects\Roanoke\Base\Output\IEEI_PA_2012.DBF",
FORM=10.3, DBF=T, LIST=Z, P[1], A[1]
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\se_2012.dbf"

ZONES=267

PHASE=ILOOP
  CoeffHH     = 0.423546369 * 2
  CoeffIND    = 0.235065256 * 2
  CoeffSER    = 0.158333776 * 2
  CoeffOFFHTR = 0.148286574 * 2
  CoeffRET    = 0.208675310 * 2
  CoeffSG     = 0.225389103 * 2
       ; adjustent factor reflects change required to make estimated trip generation rates match observed trips

GrwthRate=1.0        ; for future year models, replace this 1.0 with the assumed growth rate

  IF (I<=206)
    TOTALSG = ZI.1.SG_RET + ZI.1.SG_HOS + ZI.1.SG_AIR + ZI.1.SG_COL
    OFFHTRET = ZI.1.OFF + ZI.1.HTRET
    A[1]=(ZI.1.HH * CoeffHH) + (ZI.1.IND * CoeffIND) + (ZI.1.RET * CoeffRET) +
       (OFFHTRET * CoeffOFFHTR) + (ZI.1.SER * CoeffSER) + (TOTALSG * CoeffSG)
    P[1]= 0
  ELSE
    A[1]=0
    P[1]= ZI.2.IEEI
  ENDIF
  ENDPHASE

PHASE=ADJUST
  BALANCE A2P=1

REPORT A=Y P=Y
ENDPHASE



GENERATION Stack Size = 1444 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\EXTERNALTRIPS.DBF Opened: 18 data records  4 Fields:
ZONE(N)         AADT(N)         EE_TOTAL(N)     IEEI(N)        


FILEI ZDATI=C:\projects\Roanoke\Base\Input\se_2012.dbf Opened: 205 data records  23 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)           Page 515  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------


Variable Values at end of Iteration 1 I loop:

    COEFFHH    :  0.84709
    COEFFIND   :  0.47013
    COEFFSER   :  0.31667
    COEFFOFFHTR:  0.29657
    COEFFRET   :  0.41735
    COEFFSG    :  0.45078
    GRWTHRATE  :  1      
    OFFHTRET   : 15      

Total P/A  1  100,844  143,113

PHASE=ADJUST:Page 516  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT P
Zone           0          1
---------------------------
   0  100,843.68 100,843.68
   1          --         --
   2          --         --
   3          --         --
   4          --         --
   5          --         --
   6          --         --
   7          --         --
   8          --         --
   9          --         --
  10          --         --
  11          --         --
  12          --         --
  13          --         --
  14          --         --
  15          --         --
  16          --         --
  17          --         --
  18          --         --
  19          --         --
  20          --         --
  21          --         --
  22          --         --
  23          --         --
  24          --         --
  25          --         --
  26          --         --
  27          --         --
  28          --         --
  29          --         --
  30          --         --
  31          --         --
  32          --         --
  33          --         --
  34          --         --
  35          --         --
  36          --         --
  37          --         --
  38          --         --
  39          --         --
  40          --         --
  41          --         --
  42          --         --
  43          --         --
  44          --         --
  45          --         --
  46          --         --
  47          --         --
  48          --         --Page 517  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT P
Zone           0          1
---------------------------
  49          --         --
  50          --         --
  51          --         --
  52          --         --
  53          --         --
  54          --         --
  55          --         --
  56          --         --
  57          --         --
  58          --         --
  59          --         --
  60          --         --
  61          --         --
  62          --         --
  63          --         --
  64          --         --
  65          --         --
  66          --         --
  67          --         --
  68          --         --
  69          --         --
  70          --         --
  71          --         --
  72          --         --
  73          --         --
  74          --         --
  75          --         --
  76          --         --
  77          --         --
  78          --         --
  79          --         --
  80          --         --
  81          --         --
  82          --         --
  83          --         --
  84          --         --
  85          --         --
  86          --         --
  87          --         --
  88          --         --
  89          --         --
  90          --         --
  91          --         --
  92          --         --
  93          --         --
  94          --         --
  95          --         --
  96          --         --
  97          --         --Page 518  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT P
Zone           0          1
---------------------------
  98          --         --
  99          --         --
 100          --         --
 101          --         --
 102          --         --
 103          --         --
 104          --         --
 105          --         --
 106          --         --
 107          --         --
 108          --         --
 109          --         --
 110          --         --
 111          --         --
 112          --         --
 113          --         --
 114          --         --
 115          --         --
 116          --         --
 117          --         --
 118          --         --
 119          --         --
 120          --         --
 121          --         --
 122          --         --
 123          --         --
 124          --         --
 125          --         --
 126          --         --
 127          --         --
 128          --         --
 129          --         --
 130          --         --
 131          --         --
 132          --         --
 133          --         --
 134          --         --
 135          --         --
 136          --         --
 137          --         --
 138          --         --
 139          --         --
 140          --         --
 141          --         --
 142          --         --
 143          --         --
 144          --         --
 145          --         --
 146          --         --Page 519  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT P
Zone           0          1
---------------------------
 147          --         --
 148          --         --
 149          --         --
 150          --         --
 151          --         --
 152          --         --
 153          --         --
 154          --         --
 155          --         --
 156          --         --
 157          --         --
 158          --         --
 159          --         --
 160          --         --
 161          --         --
 162          --         --
 163          --         --
 164          --         --
 165          --         --
 166          --         --
 167          --         --
 168          --         --
 169          --         --
 170          --         --
 171          --         --
 172          --         --
 173          --         --
 174          --         --
 175          --         --
 176          --         --
 177          --         --
 178          --         --
 179          --         --
 180          --         --
 181          --         --
 182          --         --
 183          --         --
 184          --         --
 185          --         --
 186          --         --
 187          --         --
 188          --         --
 189          --         --
 190          --         --
 191          --         --
 192          --         --
 193          --         --
 194          --         --
 195          --         --Page 520  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT P
Zone           0          1
---------------------------
 196          --         --
 197          --         --
 198          --         --
 199          --         --
 200          --         --
 201          --         --
 202          --         --
 203          --         --
 204          --         --
 205          --         --
 206          --         --
 207          --         --
 208          --         --
 209          --         --
 210          --         --
 211          --         --
 212          --         --
 213          --         --
 214          --         --
 215          --         --
 216          --         --
 217          --         --
 218          --         --
 219          --         --
 220          --         --
 221          --         --
 222          --         --
 223          --         --
 224          --         --
 225          --         --
 226          --         --
 227          --         --
 228          --         --
 229          --         --
 230          --         --
 231          --         --
 232          --         --
 233          --         --
 234          --         --
 235          --         --
 236          --         --
 237          --         --
 238          --         --
 239          --         --
 240          --         --
 241          --         --
 242          --         --
 243          --         --
 244          --         --Page 521  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT P
Zone           0          1
---------------------------
 245          --         --
 246          --         --
 247          --         --
 248          --         --
 249          --         --
 250   16,109.23  16,109.23
 251    7,673.5    7,673.5 
 252    2,028.15   2,028.15
 253      895.63     895.63
 254    9,147.92   9,147.92
 255          --         --
 256          --         --
 257   10,235.35  10,235.35
 258   14,847.79  14,847.79
 259    1,173.49   1,173.49
 260    5,589.32   5,589.32
 261    4,838.43   4,838.43
 262   21,283.07  21,283.07
 263    1,347.61   1,347.61
 264      990.34     990.34
 265    4,254.13   4,254.13
 266      177.4      177.4 
 267      252.32     252.32Page 522  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT A
Zone           0          1
---------------------------
   0  100,843.68 100,843.68
   1      501.59     501.59
   2       94.08      94.08
   3      456.11     456.11
   4      673.1      673.1 
   5      394.67     394.67
   6      191.3      191.3 
   7       78.09      78.09
   8      426.5      426.5 
   9      212.56     212.56
  10      438.06     438.06
  11      316.75     316.75
  12      309.22     309.22
  13      349.98     349.98
  14      522.42     522.42
  15      354.9      354.9 
  16      251.5      251.5 
  17       26.55      26.55
  18      301.1      301.1 
  19      202.68     202.68
  20      201.4      201.4 
  21      275.34     275.34
  22      432.53     432.53
  23      334.84     334.84
  24      229.38     229.38
  25      331.17     331.17
  26      273.01     273.01
  27      622.7      622.7 
  28      436.5      436.5 
  29      405.47     405.47
  30      441.01     441.01
  31      505.91     505.91
  32      232.57     232.57
  33      237.19     237.19
  34      364.09     364.09
  35      283.51     283.51
  36    1,450.42   1,450.42
  37      469.98     469.98
  38      252.88     252.88
  39    1,311.13   1,311.13
  40    1,455.15   1,455.15
  41    1,001.3    1,001.3 
  42      571.6      571.6 
  43    1,695.19   1,695.19
  44      657.74     657.74
  45    1,228.74   1,228.74
  46      493.53     493.53
  47      167.03     167.03
  48      178.81     178.81Page 523  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT A
Zone           0          1
---------------------------
  49      363.53     363.53
  50      577.31     577.31
  51      234.01     234.01
  52      317.78     317.78
  53      230.87     230.87
  54      255.29     255.29
  55      313.64     313.64
  56      496.3      496.3 
  57      781.86     781.86
  58      936.92     936.92
  59      913.84     913.84
  60      956.26     956.26
  61      147.88     147.88
  62      397.62     397.62
  63      680.95     680.95
  64      817.66     817.66
  65      706.44     706.44
  66      658.03     658.03
  67      426.47     426.47
  68      702.34     702.34
  69      631.01     631.01
  70      492.21     492.21
  71      201.86     201.86
  72      755.2      755.2 
  73      322.79     322.79
  74      226.66     226.66
  75      249.27     249.27
  76      177.45     177.45
  77      453.03     453.03
  78      278.03     278.03
  79      274.16     274.16
  80      278.8      278.8 
  81      299.03     299.03
  82      263.68     263.68
  83      347.48     347.48
  84      368.82     368.82
  85      379.06     379.06
  86      117.38     117.38
  87        9.77       9.77
  88      423.26     423.26
  89      414.14     414.14
  90      695.67     695.67
  91      131.31     131.31
  92    1,147.06   1,147.06
  93      212.28     212.28
  94      160.01     160.01
  95      452.64     452.64
  96    2,019.31   2,019.31
  97      632.05     632.05Page 524  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT A
Zone           0          1
---------------------------
  98      759.7      759.7 
  99      296.01     296.01
 100      961.05     961.05
 101      649.27     649.27
 102      243.29     243.29
 103      163.55     163.55
 104      726.96     726.96
 105      472.8      472.8 
 106      712.35     712.35
 107      490.97     490.97
 108    1,073.06   1,073.06
 109      654.32     654.32
 110      378.71     378.71
 111      296.17     296.17
 112      219.7      219.7 
 113      630.68     630.68
 114      557.88     557.88
 115      156        156   
 116      630.2      630.2 
 117      737.49     737.49
 118      160.78     160.78
 119      341.87     341.87
 120      166.66     166.66
 121      222.75     222.75
 122      263.98     263.98
 123      258        258   
 124      299.22     299.22
 125      351.95     351.95
 126      575.3      575.3 
 127      492.84     492.84
 128      480.95     480.95
 129      482.17     482.17
 130      303.38     303.38
 131      451.4      451.4 
 132      339.54     339.54
 133      302.43     302.43
 134      200.77     200.77
 135      358.1      358.1 
 136      691.38     691.38
 137      258.01     258.01
 138      288.3      288.3 
 139      446.35     446.35
 140      637.89     637.89
 141      867.19     867.19
 142      522.93     522.93
 143      583.88     583.88
 144      690.82     690.82
 145    1,251.44   1,251.44
 146      214.27     214.27Page 525  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT A
Zone           0          1
---------------------------
 147      616.93     616.93
 148    1,818.02   1,818.02
 149      399.9      399.9 
 150      717.11     717.11
 151      335.07     335.07
 152      527.42     527.42
 153      571.93     571.93
 154      227.78     227.78
 155      365.56     365.56
 156      805.68     805.68
 157      469.07     469.07
 158    1,090.65   1,090.65
 159    1,091.49   1,091.49
 160      381.62     381.62
 161      934.72     934.72
 162      937.56     937.56
 163      954.66     954.66
 164      706.66     706.66
 165      953.13     953.13
 166    1,537.79   1,537.79
 167      244.02     244.02
 168      330.04     330.04
 169      370.5      370.5 
 170      211.07     211.07
 171      345.87     345.87
 172      588.62     588.62
 173      472.71     472.71
 174      313.76     313.76
 175      816.19     816.19
 176      652.58     652.58
 177      957.37     957.37
 178      665.96     665.96
 179      369.83     369.83
 180      340.71     340.71
 181      618.53     618.53
 182      534.37     534.37
 183      512.91     512.91
 184      281.17     281.17
 185      499.28     499.28
 186      470.56     470.56
 187      229.8      229.8 
 188      417.56     417.56
 189      261.38     261.38
 190      260.5      260.5 
 191      401.33     401.33
 192      591.89     591.89
 193      348.75     348.75
 194      388.52     388.52
 195        6.19       6.19Page 526  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT A
Zone           0          1
---------------------------
 196          --         --
 197      510.67     510.67
 198      663.69     663.69
 199      631.46     631.46
 200      471.23     471.23
 201      259.95     259.95
 202      342.75     342.75
 203      120.18     120.18
 204      221.19     221.19
 205      215.43     215.43
 206      178.02     178.02
 207          --         --
 208          --         --
 209          --         --
 210          --         --
 211          --         --
 212          --         --
 213          --         --
 214          --         --
 215          --         --
 216          --         --
 217          --         --
 218          --         --
 219          --         --
 220          --         --
 221          --         --
 222          --         --
 223          --         --
 224          --         --
 225          --         --
 226          --         --
 227          --         --
 228          --         --
 229          --         --
 230          --         --
 231          --         --
 232          --         --
 233          --         --
 234          --         --
 235          --         --
 236          --         --
 237          --         --
 238          --         --
 239          --         --
 240          --         --
 241          --         --
 242          --         --
 243          --         --
 244          --         --Page 527  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT A
Zone           0          1
---------------------------
 245          --         --
 246          --         --
 247          --         --
 248          --         --
 249          --         --
 250          --         --
 251          --         --
 252          --         --
 253          --         --
 254          --         --
 255          --         --
 256          --         --
 257          --         --
 258          --         --
 259          --         --
 260          --         --
 261          --         --
 262          --         --
 263          --         --
 264          --         --
 265          --         --
 266          --         --
 267          --         --

Total P/A  1  100,844  100,844

File C:\projects\Roanoke\Base\Output\IEEI_PA_2012.DBF opened

GENERATION ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 528  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:13 2016

FILEO RECO[1] = "C:\projects\Roanoke\Base\Output\NHBNR_PA_2012.DBF",
 FIELDS=Z, NHBNR_P, NHBNR_A
FILEI RECI = "C:\projects\Roanoke\Base\Output\IEEI_PA_2012.DBF"


ZONES = 267
NHB_PCT = .30 ; 30% of External trips make NHB trips inside the region

RO.Z=RI.Z
RO.NHBNR_P = RI.P1 * NHB_PCT
RO.NHBNR_A = RI.A1 * NHB_PCT
WRITE RECO=1


MATRIX Stack Size = 474 bytes.
................................................................................


FILEI RECI=C:\projects\Roanoke\Base\Output\IEEI_PA_2012.DBF Opened: 267 data records  3 Fields:
Z N3                P1 N10.3            A1 N10.3           


M(705): 267 RECI records processed,  0 with errors.

Variable Values at end of Iteration 1 I loop:

    RECI   :  267   252.320     0.000
    NHB_PCT:  0.3

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\Output\NHBNR_PA_2012.DBF.

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 529  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
DISTRIBUTION (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:13 2016

FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Output\IEEI_PA_2012.DBF"
FILEO MATO[1] = "C:\projects\Roanoke\Base\Output\IEEI_2012.MAT",
 MO=1, NAME=TRIPS, DEC=D
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Hwyskim.MAT"

PAR maxiters=20 maxrmse=10
setpa p[1]=zi.1.p1, a[1]=zi.1.a1  ;Set P and A Fields

; Gamma Function parameters
alpha   =  1.3544
beta    = -4.0016
epsilon =  .14

MW[2]=mi.1.1      ; total travel time

; First replace any 0 times with a very small travel time to avoid
;  failure of the exponentiation calculation.
JLOOP
  IF (MW[2]=0)
    MW[2]=.1
    ENDIF
  ENDJLOOP

;calculate friction factor using the gamma function
mw[3]  = (alpha * (MW[2]^beta) * EXP(epsilon*MW[2]))

;apply the results of gamma formulation
PAF=0
MW[1] = A[1] * MW[3]
ATTRSUM=ROWSUM(1)
IF (ATTRSUM>0) PAF=P[1]/ATTRSUM
MW[1]=PAF * MW[1]


; ========GENERATE FREQUENCY REPORTS BASED ON TIME============
FREQUENCY VALUEMW=1 BASEMW=2, RANGE=0-42,
TITLE='** IEEI Travel Time Frequency **'

DISTRIBUTION Stack Size = 1220 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Output\IEEI_PA_2012.DBF Opened: 267 data records  3 Fields:
Z(N)            P1(N)           A1(N)          


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:13 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 530  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

Totals after Iteration 1 I loop:

	MI.01.001:     627,851.97   @J=I:         117.16
	MW[1]    :     100,843.68
	MW[2]    :     630,100.47   @J=I:         123.46
	MW[3]    : 727,880,635.47   @J=I: 145,044,671.26

Variable Values at end of Iteration 1 I loop:

    ALPHA  :  1.3544
    BETA   : -4.0016
    EPSILON:  0.14  
    PAF    : 13.882 
    ATTRSUM: 18.176 Page 531  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 2
--------------------

Totals after Iteration 2 I loop:

	MI.01.001:     627,851.97   @J=I:         117.16
	MW[1]    :     100,843.68
	MW[2]    :     630,100.47   @J=I:         123.46
	MW[3]    : 727,880,635.47   @J=I: 145,044,671.26

Variable Values at end of Iteration 2 I loop:

    ALPHA  :  1.3544
    BETA   : -4.0016
    EPSILON:  0.14  
    PAF    : 11.5464
    ATTRSUM: 21.8527Page 532  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 3
--------------------

Totals after Iteration 3 I loop:

	MI.01.001:     627,851.97   @J=I:         117.16
	MW[1]    :     100,843.68
	MW[2]    :     630,100.47   @J=I:         123.46
	MW[3]    : 727,880,635.47   @J=I: 145,044,671.26

Variable Values at end of Iteration 3 I loop:

    ALPHA  :  1.3544
    BETA   : -4.0016
    EPSILON:  0.14  
    PAF    : 11.7455
    ATTRSUM: 21.4823Page 533  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 4
--------------------

Totals after Iteration 4 I loop:

	MI.01.001:     627,851.97   @J=I:         117.16
	MW[1]    :     100,843.68
	MW[2]    :     630,100.47   @J=I:         123.46
	MW[3]    : 727,880,635.47   @J=I: 145,044,671.26

Variable Values at end of Iteration 4 I loop:

    ALPHA  :  1.3544
    BETA   : -4.0016
    EPSILON:  0.14  
    PAF    : 11.7358
    ATTRSUM: 21.5   Page 534  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 5
--------------------

Totals after Iteration 5 I loop:

	MI.01.001:     627,851.97   @J=I:         117.16
	MW[1]    :     100,843.68
	MW[2]    :     630,100.47   @J=I:         123.46
	MW[3]    : 727,880,635.47   @J=I: 145,044,671.26

Variable Values at end of Iteration 5 I loop:

    ALPHA  :  1.3544
    BETA   : -4.0016
    EPSILON:  0.14  
    PAF    : 11.7159
    ATTRSUM: 21.5366

RMSE  MW=  1
------------
 1    796.67
 2     66.89
 3     28.23
 4     14.42
 5      5.84Page 535  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 5
--------------------

Totals after Iteration 5 I loop:

	MI.01.001:     627,851.97   @J=I:         117.16
	MW[1]    :     100,843.68
	MW[2]    :     630,100.47   @J=I:         123.46
	MW[3]    : 727,880,635.47   @J=I: 145,044,671.26
	MO.01.001:     100,843.68

Variable Values at end of Iteration 5 I loop:

    ALPHA  :  1.3544
    BETA   : -4.0016
    EPSILON:  0.14  
    PAF    : 11.7067
    ATTRSUM: 21.5534

RMSE  MW=  1
------------
 1    796.67
 2     66.89
 3     28.23
 4     14.42
 5      2.04Page 536  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

FREQUENCY (Iter=5) ** IEEI Travel Time Frequency **
  BASEMW=2 VALUEMW=1 RANGE=0,42,1
  MW[2]                   Accum
>=  -  < Obs    Sum   Pct  Pct
---------------------------------------------------
  0 -  1   1   322.50 0.3   0.3 |
  1 -  2   2   199.91 0.2   0.5 |
  2 -  3   8 1,693.47 1.7   2.2 |=
  3 -  4   8 2,078.53 2.1   4.3 |==
  4 -  5  15 1,554.50 1.5   5.8 |=
  5 -  6  21 2,591.56 2.6   8.4 |==
  6 -  7  25 2,025.20 2.0  10.4 |==
  7 -  8  35 2,246.20 2.2  12.6 |==
  8 -  9  47 2,428.31 2.4  15.0 |==
  9 - 10  55 2,677.12 2.7  17.7 |==
 10 - 11  66 2,397.38 2.4  20.0 |==
 11 - 12  71 2,894.95 2.9  22.9 |==
 12 - 13  91 4,054.99 4.0  26.9 |====
 13 - 14  98 2,325.36 2.3  29.2 |==
 14 - 15 102 3,393.61 3.4  32.6 |===
 15 - 16 136 5,985.50 5.9  38.5 |=====
 16 - 17 176 6,378.27 6.3  44.9 |======
 17 - 18 152 4,826.08 4.8  49.7 |====
 18 - 19 189 5,401.84 5.4  55.0 |=====
 19 - 20 210 5,997.11 5.9  61.0 |=====
 20 - 21 249 5,570.77 5.5  66.5 |=====
 21 - 22 221 7,180.38 7.1  73.6 |=======
 22 - 23 237 4,927.46 4.9  78.5 |====
 23 - 24 227 5,220.02 5.2  83.7 |=====
 24 - 25 180 3,740.79 3.7  87.4 |===
 25 - 26 139 2,647.54 2.6  90.0 |==
 26 - 27 133 3,483.98 3.5  93.5 |===
 27 - 28  93 2,022.55 2.0  95.5 |==
 28 - 29  65 1,563.57 1.6  97.0 |=
 29 - 30  63 1,252.98 1.2  98.3 |=
 30 - 31  50   901.64 0.9  99.1 |
 31 - 32  30   196.14 0.2  99.3 |
 32 - 33  29   369.61 0.4  99.7 |
 33 - 34  16   109.37 0.1  99.8 |
 34 - 35  17    65.71 0.1  99.9 |
 35 - 36   6     4.03 0.0  99.9 |
 36 - 37   5    53.77 0.1  99.9 |
 37 - 38  10    60.73 0.1 100.0 |
 38 - 39   2     0.25 0.0 100.0 |
 39 - 40  --       --  -- 100.0 |
 40 - 41  --       --  -- 100.0 |
 41 - 42  --       --  -- 100.0 |
 42+      --       --  -- 100.0 |
--------------------------------Page 537  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

FREQUENCY (Iter=5) ** IEEI Travel Time Frequency **
  BASEMW=2 VALUEMW=1 RANGE=0,42,1
  MW[2]                   Accum
>=  -  < Obs    Sum   Pct  Pct
---------------------------------------------------
Total Obs = 3,280
Total Sum = 100,843.68
Mean      = 17.31
@I=J      = 0

DISTRIBUTION ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################
Page 538  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:14 2016

FILEO MATO[4] = "C:\projects\Roanoke\Base\Output\IEEI_2012_NT.MAT",
 MO=34, NAME=IEEI_NT, DEC=D
FILEO MATO[3] = "C:\projects\Roanoke\Base\Output\IEEI_2012_PM.MAT",
 MO=33, NAME=IEEI_PM, DEC=D
FILEO MATO[2] = "C:\projects\Roanoke\Base\Output\IEEI_2012_MD.MAT",
 MO=32, NAME=IEEI_MD, DEC=D
FILEO MATO[1] = "C:\projects\Roanoke\Base\Output\IEEI_2012_AM.MAT",
 MO=31, NAME=IEEI_AM, DEC=D
FILEI MATI[1] = "C:\projects\Roanoke\Base\Output\IEEI_2012.MAT"
ZONES=267

;Define arrays of time of day factors
ARRAY IEFct=4
IEFct[1] = 0.03  ;AM IE Factor
IEFct[2] = 0.28   ;MD IE Factor
IEFct[3] = 0.08   ;PM IE Factor
IEFct[4] = 0.11   ;NT IE Factor

ARRAY EIFct=4
EIFct[1] = 0.16  ;AM EI Factor
EIFct[2] = 0.20   ;MD EI Factor
EIFct[3] = 0.03   ;PM EI Factor
EIFct[4] = 0.11   ;NT EI Factor

MW[1]=mi.1.1      ;IEEI Daily Trips
MW[2]=mi.1.1.T    ;IEEI Daily Trips

;  MW[11] through MW[14] are the working tables (four time periods) for IE trips
;  MW[21] through MW[24] are the working tables (four time periods) for EI trips
;  MW[31] through MW[34] are the final output tables (four time periods) for total IEEI trips.

LOOP TOD=1,4
  IETable = (10) + TOD
  MW[IETable] = MW[2] * IEFct[TOD]

  EITable = (20) + TOD
  MW[EITable] = MW[1] * EIFct[TOD]

  TODTable = (30) + TOD
  MW[TODTable] = MW[IETable] + MW[EITable]
ENDLOOP


MATRIX Stack Size = 1552 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\Output\IEEI_2012.MAT OpenedPage 539  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MAT PGM=DISTRIBUTION (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:13 2016 
ID=
PAR Zones=267 M=1
  TRIPS

M(792): ARRAY IEFCT requires 40 bytes.

M(792): ARRAY EIFCT requires 40 bytes.

Totals from Transpose:

	MI.01.001.T: 100,844

M(660): Transpose Disk Usage (bytes): Data=38,466, Index=1,068.Page 540  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  : 100,843.7
	MI.01.001.T: 100,843.7
	MW[1]      : 100,843.7
	MW[2]      : 100,843.7
	MW[11]     :   3,025.3
	MW[12]     :  28,236.2
	MW[13]     :   8,067.5
	MW[14]     :  11,092.8
	MW[21]     :  16,135  
	MW[22]     :  20,168.7
	MW[23]     :   3,025.3
	MW[24]     :  11,092.8
	MW[31]     :  19,160.3
	MW[32]     :  48,405  
	MW[33]     :  11,092.8
	MW[34]     :  22,185.6
	MO.04.001  :  22,185.6
	MO.03.001  :  11,092.8
	MO.02.001  :  48,405  
	MO.01.001  :  19,160.3

Variable Values at end of Iteration 1 I loop:

    TOD     :  5
    IETABLE : 14
    EITABLE : 24
    TODTABLE: 34

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 541  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:14 2016

FILEO MATO[4] = "C:\projects\Roanoke\Base\Output\EE_2012_NT.MAT",
MO=14, NAME=EE_NT, DEC=1*D
FILEO MATO[3] = "C:\projects\Roanoke\Base\Output\EE_2012_PM.MAT",
MO=13, NAME=EE_PM, DEC=1*D
FILEO MATO[2] = "C:\projects\Roanoke\Base\Output\EE_2012_MD.MAT",
MO=12, NAME=EE_MD, DEC=1*D
FILEO MATO[1] = "C:\projects\Roanoke\Base\Output\EE_2012_AM.MAT",
 MO=11, NAME=EE_AM, DEC=1*D
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\EE_2012.MAT"


MW[1]=mi.1.1     ;EE Daily Trips

ZONES=267

;Define arrays of time of day factors
ARRAY EEFct=4
EEFct[1] = 0.141 ;AM IE Factor
EEFct[2] = 0.458 ;MD IE Factor
EEFct[3] = 0.154 ;PM IE Factor
EEFct[4] = 0.247  ;NT IE Factor




;  MW[11] through MW[14] are the working tables (four time periods) for EE trips

LOOP TOD=1,4
  EETable = (10) + TOD
  MW[EETable] = MW[1] * EEFct[TOD]
ENDLOOP

MATRIX Stack Size = 1044 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\EE_2012.MAT Opened
MAT PGM=FRATAR (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:13 2016 
ID=
PAR Zones=267 M=1
  EE_TRIPS

M(792): ARRAY EEFCT requires 40 bytes.Page 542  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 41,786.7
	MW[1]    : 41,786.7
	MW[11]   :  5,891.9
	MW[12]   : 19,138.3
	MW[13]   :  6,435.1
	MW[14]   : 10,321.3
	MO.04.001: 10,321.3
	MO.03.001:  6,435.1
	MO.02.001: 19,138.3
	MO.01.001:  5,891.9

Variable Values at end of Iteration 1 I loop:

    TOD    :  5
    EETABLE: 14

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 543  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------
GENERATION (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:14 2016

FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\CVRATES.CSV"
FILEO PAO[1] = "C:\projects\Roanoke\Base\Output\CV_PA_2012.DBF",
FORM=10.3, DBF=T, LIST=Z, P[1], P[2], P[3], A[1], A[2], A[3]
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\se_2012.dbf"

ZONES=206

LOOKUP, LOOKUPI=1,
 NAME=CVRates,
    LOOKUP[1]=1, RESULT=2,
    LOOKUP[2]=1, RESULT=3,
    LOOKUP[3]=1, RESULT=4,
 INTERPOLATE=N, FAIL[1]=0, FAIL[2]=0, FAIL[3]=0, LIST=Y

PHASE=ILOOP

 P[1]= (IND*CVRates(1,1))+((RET + SG_RET)*CVRates(1,2))+(HTRET*CVRates(1,3))+(OFF*CVRates(1,4))+((SER+SG_AIR+SG_COL+SG_HOS)*CVRates(1,5))+(HH*CVRates(1,6))

 P[2]= (IND*CVRates(2,1))+((RET + SG_RET)*CVRates(2,2))+(HTRET*CVRates(2,3))+(OFF*CVRates(2,4))+((SER+SG_AIR+SG_COL+SG_HOS)*CVRates(2,5))+(HH*CVRates(2,6))
 P[3]= (IND*CVRates(3,1))+((RET + SG_RET)*CVRates(3,2))+(HTRET*CVRates(3,3))+(OFF*CVRates(3,4))+((SER+SG_AIR+SG_COL+SG_HOS)*CVRates(3,5))+(HH*CVRates(3,6))

 A[1]=P[1]
  A[2]=P[2]
  A[3]=P[3]

ENDPHASE

PHASE=ADJUST
  BALANCE NHB=1
ENDPHASE


GENERATION Stack Size = 1376 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\se_2012.dbf Opened: 205 data records  23 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)           


LOOKUP   CVRates:  FAIL=  --  --  --
         CVRates(1,1)  = 0.398
         CVRates(1,2)  = 0.051
         CVRates(1,3)  = 0.051
         CVRates(1,4)  = 0.051
         CVRates(1,5)  = 0.051
         CVRates(1,6)  = 0.166
         CVRates(2,1)  = 0.582Page 544  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------
         CVRates(2,2)  = 0.048
         CVRates(2,3)  = 0.048
         CVRates(2,4)  = 0.049
         CVRates(2,5)  = 0.02
         CVRates(2,6)  = 0.076
         CVRates(3,1)  = 0.132
         CVRates(3,2)  = 0.02
         CVRates(3,3)  = 0.02
         CVRates(3,4)  = 0.015
         CVRates(3,5)  = 0.015
         CVRates(3,6)  = 0.006


Total P/A  1  32,814  32,814
Total P/A  2  24,746  24,746
Total P/A  3   5,300   5,300

PHASE=ADJUST:

Total P/A  1  32,814  32,814
Total P/A  2  24,746  24,746
Total P/A  3   5,300   5,300

File C:\projects\Roanoke\Base\Output\CV_PA_2012.DBF opened

GENERATION ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 545  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
DISTRIBUTION (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:14 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\Output\CV_2012.MAT",
  MO=1-3, NAME=FourTire, SixTire, Combo, DEC=D
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Hwyskim.MAT"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Output\CV_PA_2012.DBF"


PAR maxiters=20 maxrmse=10

setpa  P[1]=ZI.1.P1, P[2]=ZI.1.P2, P[3]=ZI.1.P3,  ; Set P and A Fields 1-3 = 4-tire, 6-tire, and combo
   A[1]=ZI.1.A1, A[2]=ZI.1.A2, A[3]=ZI.1.A3

; Estmated Gamma Function parameters,  Define array of coefficients and poplate.
 ARRAY alpha=3
 ARRAY beta=3
 ARRAY epsilon=3

; Coefficients are set the the default NCDOT Small Area Travel Demand Model Procedures Manual
;     for all three CV types.  Further testing and calibration may be needed.
  alpha[1] = 4.6750
 beta[1] = 0.2916
 epsilon[1] = 0.1390

 alpha[2] = 4.6750
 beta[2] = 0.2916
 epsilon[2] = 0.1390

 alpha[3] = 4.6750
 beta[3] = 0.2916
 epsilon[3] = 2.4000

MW[10]=mi.1.1      ; total travel time

; First replace any 0 times with a very small travel time to avoid
;  failure of the exponentiation calculation.
JLOOP
  IF (MW[10]=0)
    MW[10]=0.0000001
    ENDIF
  ENDJLOOP

;calculate friction factor using the gamma function
LOOP CVType=1,3
  CVIDX=10+CVType
 MW[CVIDX] = alpha[CVType] * (MW[10]^beta[CVType]) * EXP(epsilon[CVType]*MW[10])
 ENDLOOP

;apply the results of gamma formulation
LOOP PURP= 1, 3
  CVIDX=10+PURP
 PAF=0
 MW[PURP] = A[PURP] * MW[CVIDX]
 ATTRSUM=ROWSUM(PURP)Page 546  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
 IF (ATTRSUM>0) PAF=P[PURP]/ATTRSUM
 MW[PURP]=PAF * MW[PURP]
ENDLOOP

; ========GENERATE FREQUENCY REPORTS BASED ON TIME============
FREQUENCY VALUEMW=1 BASEMW=10, RANGE=0-42,
TITLE='** CV 4-Tire Travel Time Frequency **'

FREQUENCY VALUEMW=2 BASEMW=10, RANGE=0-42,
TITLE='** SUT 6-Tire Travel Time Frequency **'

FREQUENCY VALUEMW=3 BASEMW=10, RANGE=0-42,
TITLE='** MUT Combo Travel Time Frequency **'


DISTRIBUTION Stack Size = 2236 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:13 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME

FILEI ZDATI=C:\projects\Roanoke\Base\Output\CV_PA_2012.DBF Opened: 206 data records  7 Fields:
Z(N)            P1(N)           P2(N)           P3(N)           A1(N)          
A2(N)           A3(N)          


M(792): ARRAY ALPHA requires 32 bytes.

M(792): ARRAY BETA requires 32 bytes.

M(792): ARRAY EPSILON requires 32 bytes.Page 547  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

Totals after Iteration 1 I loop:

	MI.01.001:                 627,851.97     @J=I:                     117.16  
	MW[1]    :                  32,814.354    @J=I:                      17.0179
	MW[2]    :                  24,745.767    @J=I:                      19.186 
	MW[3]    :                   5,299.9      @J=I:                       0     
	MW[10]   :                 627,851.9722   @J=I:                     117.16  
	MW[11]   :               5,285,839.2218   @J=I:                     816.8582
	MW[12]   :               5,285,839.2218   @J=I:                     816.8582
	MW[13]   :      1.0298955188567658e+045   @J=I:                  69,107.3962

Variable Values at end of Iteration 1 I loop:

    CVTYPE :                       4
    CVIDX  :                      13
    PURP   :                       4
    ATTRSUM: 3.4211321666280124e+039Page 548  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 2
--------------------

Totals after Iteration 2 I loop:

	MI.01.001:                 627,851.97     @J=I:                     117.16  
	MW[1]    :                  32,814.354    @J=I:                      24.273 
	MW[2]    :                  24,745.767    @J=I:                      26.3689
	MW[3]    :                   5,299.9      @J=I:                       0     
	MW[10]   :                 627,851.9722   @J=I:                     117.16  
	MW[11]   :               5,285,839.2218   @J=I:                     816.8582
	MW[12]   :               5,285,839.2218   @J=I:                     816.8582
	MW[13]   :      1.0298955188567658e+045   @J=I:                  69,107.3962

Variable Values at end of Iteration 2 I loop:

    CVTYPE :                       4
    CVIDX  :                      13
    PURP   :                       4
    ATTRSUM: 3.8856623999196595e+039Page 549  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 3
--------------------

Totals after Iteration 3 I loop:

	MI.01.001:                 627,851.97      @J=I:                     117.16   
	MW[1]    :                  32,814.354     @J=I:                      24.35834
	MW[2]    :                  24,745.767     @J=I:                      26.39082
	MW[3]    :                   5,299.9       @J=I:                       0.00001
	MW[10]   :                 627,851.97225   @J=I:                     117.16001
	MW[11]   :               5,285,839.22179   @J=I:                     816.85819
	MW[12]   :               5,285,839.22179   @J=I:                     816.85819
	MW[13]   :       1.0298955188567658e+045   @J=I:                  69,107.39618

Variable Values at end of Iteration 3 I loop:

    CVTYPE :                       4
    CVIDX  :                      13
    PURP   :                       4
    ATTRSUM: 6.6302103095072013e+039Page 550  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 4
--------------------

Totals after Iteration 4 I loop:

	MI.01.001:                 627,851.97      @J=I:                     117.16   
	MW[1]    :                  32,814.354     @J=I:                      24.36165
	MW[2]    :                  24,745.767     @J=I:                      26.38888
	MW[3]    :                   5,299.9       @J=I:                       0.00001
	MW[10]   :                 627,851.97225   @J=I:                     117.16001
	MW[11]   :               5,285,839.22179   @J=I:                     816.85819
	MW[12]   :               5,285,839.22179   @J=I:                     816.85819
	MW[13]   :       1.0298955188567658e+045   @J=I:                  69,107.39618

Variable Values at end of Iteration 4 I loop:

    CVTYPE :                       4
    CVIDX  :                      13
    PURP   :                       4
    ATTRSUM: 7.8041573133119264e+039Page 551  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 5
--------------------

Totals after Iteration 5 I loop:

	MI.01.001:                 627,851.97      @J=I:                     117.16   
	MW[1]    :                  32,814.354     @J=I:                      24.36195
	MW[2]    :                  24,745.767     @J=I:                      26.38869
	MW[3]    :                   5,299.9       @J=I:                       0.00001
	MW[10]   :                 627,851.97225   @J=I:                     117.16001
	MW[11]   :               5,285,839.22179   @J=I:                     816.85819
	MW[12]   :               5,285,839.22179   @J=I:                     816.85819
	MW[13]   :       1.0298955188567658e+045   @J=I:                  69,107.39618

Variable Values at end of Iteration 5 I loop:

    CVTYPE :                       4
    CVIDX  :                      13
    PURP   :                       4
    ATTRSUM: 7.6565691799033369e+039Page 552  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 6
--------------------

Totals after Iteration 6 I loop:

	MI.01.001:                 627,851.97      @J=I:                     117.16   
	MW[1]    :                  32,814.354     @J=I:                      24.36199
	MW[2]    :                  24,745.767     @J=I:                      26.38868
	MW[3]    :                   5,299.9       @J=I:                       0.00002
	MW[10]   :                 627,851.97225   @J=I:                     117.16001
	MW[11]   :               5,285,839.22179   @J=I:                     816.85819
	MW[12]   :               5,285,839.22179   @J=I:                     816.85819
	MW[13]   :       1.0298955188567658e+045   @J=I:                  69,107.39618

Variable Values at end of Iteration 6 I loop:

    CVTYPE :                       4
    CVIDX  :                      13
    PURP   :                       4
    ATTRSUM: 7.0608968281691153e+039

RMSE  MW=  1       2       3
----------------------------
 1    102.98   81.43  171.02
 2      2.12    1.83   30.26
 3      0.14    0.16   19.11
 4      0.00    0.00   14.03
 5      0.00    0.00   10.70
 6      0.00    0.00    8.66Page 553  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 6
--------------------

Totals after Iteration 6 I loop:

	MI.01.001:                 627,851.97      @J=I:                     117.16   
	MW[1]    :                  32,814.354     @J=I:                      24.36199
	MW[2]    :                  24,745.767     @J=I:                      26.38868
	MW[3]    :                   5,299.9       @J=I:                       0.00002
	MW[10]   :                 627,851.97225   @J=I:                     117.16001
	MW[11]   :               5,285,839.22179   @J=I:                     816.85819
	MW[12]   :               5,285,839.22179   @J=I:                     816.85819
	MW[13]   :       1.0298955188567658e+045   @J=I:                  69,107.39618
	MO.01.001:                  32,814.354  
	MO.01.002:                  24,748.6    
	MO.01.003:                   5,295.21   

Variable Values at end of Iteration 6 I loop:

    CVTYPE :                       4
    CVIDX  :                      13
    PURP   :                       4
    ATTRSUM: 6.4230923156479134e+039

RMSE  MW=  1       2       3
----------------------------
 1    102.98   81.43  171.02
 2      2.12    1.83   30.26
 3      0.14    0.16   19.11
 4      0.00    0.00   14.03
 5      0.00    0.00   10.70
 6      0.00    0.00    7.41Page 554  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

FREQUENCY (Iter=6) ** CV 4-Tire Travel Time Frequency **
  BASEMW=10 VALUEMW=1 RANGE=0,42,1
 MW[10]                     Accum
>=  -  <  Obs     Sum   Pct  Pct
--------------------------------------------------------
  0 -  1   561    73.97 0.2   0.2 |
  1 -  2   670   136.27 0.4   0.6 |
  2 -  3 1,097   321.32 1.0   1.6 |
  3 -  4 1,442   546.57 1.7   3.3 |=
  4 -  5 1,801   816.63 2.5   5.8 |==
  5 -  6 2,095 1,194.73 3.6   9.4 |===
  6 -  7 2,265 1,545.86 4.7  14.1 |====
  7 -  8 2,477 1,813.24 5.5  19.7 |=====
  8 -  9 2,608 2,095.30 6.4  26.0 |======
  9 - 10 2,706 2,526.00 7.7  33.7 |=======
 10 - 11 2,702 2,601.70 7.9  41.7 |=======
 11 - 12 2,739 2,697.79 8.2  49.9 |========
 12 - 13 2,598 2,534.14 7.7  57.6 |=======
 13 - 14 2,460 2,350.85 7.2  64.8 |=======
 14 - 15 2,180 2,251.46 6.9  71.6 |======
 15 - 16 2,048 1,854.78 5.7  77.3 |=====
 16 - 17 1,789 1,560.90 4.8  82.0 |====
 17 - 18 1,506 1,369.00 4.2  86.2 |====
 18 - 19 1,363 1,024.10 3.1  89.3 |===
 19 - 20 1,113   884.60 2.7  92.0 |==
 20 - 21   951   754.52 2.3  94.3 |==
 21 - 22   703   493.74 1.5  95.8 |=
 22 - 23   605   402.10 1.2  97.1 |=
 23 - 24   483   349.36 1.1  98.1 |=
 24 - 25   336   225.28 0.7  98.8 |
 25 - 26   205   121.59 0.4  99.2 |
 26 - 27   161    90.90 0.3  99.5 |
 27 - 28   114    69.64 0.2  99.7 |
 28 - 29    73    38.46 0.1  99.8 |
 29 - 30    57    20.98 0.1  99.9 |
 30 - 31    59    24.78 0.1  99.9 |
 31 - 32    22    11.19 0.0 100.0 |
 32 - 33    12     3.04 0.0 100.0 |
 33 - 34     5     1.95 0.0 100.0 |
 34 - 35    13     5.01 0.0 100.0 |
 35 - 36     5     2.15 0.0 100.0 |
 36 - 37     1     0.45 0.0 100.0 |
 37 - 38    --       --  -- 100.0 |
 38 - 39    --       --  -- 100.0 |
 39 - 40    --       --  -- 100.0 |
 40 - 41    --       --  -- 100.0 |
 41 - 42    --       --  -- 100.0 |
 42+        --       --  -- 100.0 |
----------------------------------Page 555  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

FREQUENCY (Iter=6) ** CV 4-Tire Travel Time Frequency **
  BASEMW=10 VALUEMW=1 RANGE=0,42,1
 MW[10]                     Accum
>=  -  <  Obs     Sum   Pct  Pct
--------------------------------------------------------
Total Obs = 42,025
Total Sum = 32,814.35
Mean      = 12.41
@I=J      = 24.36Page 556  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

FREQUENCY (Iter=6) ** SUT 6-Tire Travel Time Frequency **
  BASEMW=10 VALUEMW=2 RANGE=0,42,1
 MW[10]                     Accum
>=  -  <  Obs     Sum   Pct  Pct
---------------------------------------------------------
  0 -  1   561    66.54 0.3   0.3 |
  1 -  2   670   107.55 0.4   0.7 |
  2 -  3 1,097   235.89 1.0   1.7 |
  3 -  4 1,442   405.07 1.6   3.3 |=
  4 -  5 1,801   589.47 2.4   5.7 |==
  5 -  6 2,095   906.60 3.7   9.3 |===
  6 -  7 2,265 1,141.08 4.6  14.0 |====
  7 -  8 2,477 1,298.17 5.2  19.2 |=====
  8 -  9 2,608 1,536.35 6.2  25.4 |======
  9 - 10 2,706 2,046.73 8.3  33.7 |========
 10 - 11 2,702 2,056.94 8.3  42.0 |========
 11 - 12 2,739 2,143.44 8.7  50.7 |========
 12 - 13 2,598 1,939.48 7.8  58.5 |=======
 13 - 14 2,460 1,758.41 7.1  65.6 |=======
 14 - 15 2,180 1,721.60 7.0  72.6 |======
 15 - 16 2,048 1,374.13 5.6  78.1 |=====
 16 - 17 1,789 1,193.14 4.8  82.9 |====
 17 - 18 1,506 1,033.40 4.2  87.1 |====
 18 - 19 1,363   727.11 2.9  90.0 |==
 19 - 20 1,113   665.36 2.7  92.7 |==
 20 - 21   951   543.88 2.2  94.9 |==
 21 - 22   703   327.50 1.3  96.3 |=
 22 - 23   605   275.06 1.1  97.4 |=
 23 - 24   483   237.38 1.0  98.3 |
 24 - 25   336   158.61 0.6  99.0 |
 25 - 26   205    75.36 0.3  99.3 |
 26 - 27   161    63.36 0.3  99.5 |
 27 - 28   114    46.05 0.2  99.7 |
 28 - 29    73    24.39 0.1  99.8 |
 29 - 30    57    14.51 0.1  99.9 |
 30 - 31    59    17.34 0.1  99.9 |
 31 - 32    22     7.73 0.0 100.0 |
 32 - 33    12     1.81 0.0 100.0 |
 33 - 34     5     1.42 0.0 100.0 |
 34 - 35    13     3.00 0.0 100.0 |
 35 - 36     5     1.50 0.0 100.0 |
 36 - 37     1     0.40 0.0 100.0 |
 37 - 38    --       --  -- 100.0 |
 38 - 39    --       --  -- 100.0 |
 39 - 40    --       --  -- 100.0 |
 40 - 41    --       --  -- 100.0 |
 41 - 42    --       --  -- 100.0 |
 42+        --       --  -- 100.0 |
----------------------------------Page 557  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

FREQUENCY (Iter=6) ** SUT 6-Tire Travel Time Frequency **
  BASEMW=10 VALUEMW=2 RANGE=0,42,1
 MW[10]                     Accum
>=  -  <  Obs     Sum   Pct  Pct
---------------------------------------------------------
Total Obs = 42,025
Total Sum = 24,745.77
Mean      = 12.32
@I=J      = 26.39Page 558  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

FREQUENCY (Iter=6) ** MUT Combo Travel Time Frequency **
  BASEMW=10 VALUEMW=3 RANGE=0,42,1
 MW[10]                    Accum
>=  -  <  Obs    Sum   Pct  Pct
--------------------------------------------------------
  0 -  1   561   0.00  0.0   0.0 |
  1 -  2   670   0.00  0.0   0.0 |
  2 -  3 1,097   0.03  0.0   0.0 |
  3 -  4 1,442   0.44  0.0   0.0 |
  4 -  5 1,801   4.83  0.1   0.1 |
  5 -  6 2,095  32.38  0.6   0.7 |
  6 -  7 2,265 127.38  2.4   3.1 |==
  7 -  8 2,477 147.69  2.8   5.9 |==
  8 -  9 2,608 189.20  3.6   9.5 |===
  9 - 10 2,706 354.72  6.7  16.2 |======
 10 - 11 2,702 423.29  8.0  24.2 |=======
 11 - 12 2,739 496.50  9.4  33.5 |=========
 12 - 13 2,598 540.99 10.2  43.7 |==========
 13 - 14 2,460 532.33 10.0  53.8 |==========
 14 - 15 2,180 504.69  9.5  63.3 |=========
 15 - 16 2,048 415.91  7.8  71.1 |=======
 16 - 17 1,789 343.07  6.5  77.6 |======
 17 - 18 1,506 318.17  6.0  83.6 |======
 18 - 19 1,363 205.60  3.9  87.5 |===
 19 - 20 1,113 182.34  3.4  90.9 |===
 20 - 21   951 154.76  2.9  93.9 |==
 21 - 22   703  83.38  1.6  95.4 |=
 22 - 23   605  81.66  1.5  97.0 |=
 23 - 24   483  60.26  1.1  98.1 |=
 24 - 25   336  40.73  0.8  98.9 |
 25 - 26   205  17.64  0.3  99.2 |
 26 - 27   161  15.21  0.3  99.5 |
 27 - 28   114   9.41  0.2  99.7 |
 28 - 29    73   6.10  0.1  99.8 |
 29 - 30    57   3.69  0.1  99.9 |
 30 - 31    59   3.83  0.1  99.9 |
 31 - 32    22   2.01  0.0 100.0 |
 32 - 33    12   0.19  0.0 100.0 |
 33 - 34     5   0.41  0.0 100.0 |
 34 - 35    13   0.52  0.0 100.0 |
 35 - 36     5   0.37  0.0 100.0 |
 36 - 37     1   0.18  0.0 100.0 |
 37 - 38    --     --   -- 100.0 |
 38 - 39    --     --   -- 100.0 |
 39 - 40    --     --   -- 100.0 |
 40 - 41    --     --   -- 100.0 |
 41 - 42    --     --   -- 100.0 |
 42+        --     --   -- 100.0 |
---------------------------------Page 559  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

FREQUENCY (Iter=6) ** MUT Combo Travel Time Frequency **
  BASEMW=10 VALUEMW=3 RANGE=0,42,1
 MW[10]                    Accum
>=  -  <  Obs    Sum   Pct  Pct
--------------------------------------------------------
Total Obs = 42,025
Total Sum = 5,299.9
Mean      = 14.03
@I=J      = 0

DISTRIBUTION ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################
Page 560  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:15 2016

FILEO MATO[4] = "C:\projects\Roanoke\Base\Output\CV_2012_NT.MAT",
 MO=41-43, NAME=CV_NT, SUT_NT, MUT_NT, DEC=D
FILEO MATO[3] = "C:\projects\Roanoke\Base\Output\CV_2012_PM.MAT",
 MO=31-33, NAME=CV_PM, SUT_PM, MUT_PM, DEC=D
FILEO MATO[2] = "C:\projects\Roanoke\Base\Output\CV_2012_MD.MAT",
 MO=21-23, NAME=CV_MD, SUT_MD, MUT_MD, DEC=D
FILEO MATO[1] = "C:\projects\Roanoke\Base\Output\CV_2012_AM.MAT",
 MO=11-13, NAME=CV_AM, SUT_AM, MUT_AM, DEC=D
FILEI MATI[1] = "C:\projects\Roanoke\Base\Output\CV_2012.MAT"

ZONES=267

;Define array of time of day factors
;Note that time of day factors for CV trips are the same for PA as AP trips.
;  So rather than apply a PA TOD and an AP TOD and then recombining the table
;  by time period we can simply apply double the PA (or AP)TOD rate.

ARRAY TODFct=4
TODFct[1] = 0.0458 * 2  ;AM Factor
TODFct[2] = 0.1652 * 2  ;MD Factor
TODFct[3] = 0.1634 * 2  ;PM Factor
TODFct[4] = 0.1256 * 2  ;NT Factor

MW[1]=mi.1.1      ;CV  Daily Trips
MW[2]=mi.1.2      ;SUT Daily Trips
MW[3]=mi.1.3      ;MUT Daily Trips

LOOP TOD=1,4
  LOOP CVType=1,3
     TODTable = (10*TOD)+ CVType
    MW[TODTable] = MW[CVType] * TODFct[TOD]
  ENDLOOP
ENDLOOP

MATRIX Stack Size = 1426 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\Output\CV_2012.MAT Opened
MAT PGM=DISTRIBUTION (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:14 2016 
ID=
PAR Zones=267 M=3
  FourTire  SixTire  Combo

M(792): ARRAY TODFCT requires 40 bytes.Page 561  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 32,814.354     @J=I:     24.36199
	MI.01.002: 24,748.6       @J=I:     26.35   
	MI.01.003:  5,295.21   
	MW[1]    : 32,814.354     @J=I:     24.36199
	MW[2]    : 24,748.6       @J=I:     26.35   
	MW[3]    :  5,295.21   
	MW[11]   :  3,005.79483   @J=I:      2.23156
	MW[12]   :  2,266.97176   @J=I:      2.41366
	MW[13]   :    485.04124
	MW[21]   : 10,841.86256   @J=I:      8.0492 
	MW[22]   :  8,176.93744   @J=I:      8.70604
	MW[23]   :  1,749.53738
	MW[31]   : 10,723.73089   @J=I:      7.9615 
	MW[32]   :  8,087.84248   @J=I:      8.61118
	MW[33]   :  1,730.47463
	MW[41]   :  8,242.96572   @J=I:      6.11973
	MW[42]   :  6,216.84832   @J=I:      6.61912
	MW[43]   :  1,330.15675
	MO.04.001:  8,242.96572
	MO.04.002:  6,248.55   
	MO.04.003:  1,341.05   
	MO.03.001: 10,723.73089
	MO.03.002:  8,099.39   
	MO.03.003:  1,730.6    
	MO.02.001: 10,841.86256
	MO.02.002:  8,190.97   
	MO.02.003:  1,749.32   
	MO.01.001:  3,005.79483
	MO.01.002:  2,261.92   
	MO.01.003:    477.59   

Variable Values at end of Iteration 1 I loop:

    TOD     :  5
    CVTYPE  :  4
    TODTABLE: 43

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\CV_TLFD.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:15 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################
Page 573  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:16 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\pk_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\PK_FreeFlow_Skim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1332 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\PK_FreeFlow_Skim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Fri Mar 18 15:15:03 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 574  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,627,851.97   @J=I:     23,000,117.16
	MI.01.002: 22,402,469,247.37
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,837,469.97   @J=I:     23,000,795.16
	MW[1]    : 22,425,627,851.97   @J=I:     23,000,117.16
	MW[2]    : 22,402,469,247.37
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,837,469.97   @J=I:     23,000,795.16
	MW[11]   :        627,851.97   @J=I:            117.16
	MW[12]   :        469,247.37
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        773,269.97   @J=I:            785.16
	MO.01.001:        627,851.97
	MO.01.002:        469,247.37
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        773,269.97

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 575  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:16 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_FreeFlow_Skim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1332 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\OP_FreeFlow_Skim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Fri Mar 18 15:15:03 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 576  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,627,851.97   @J=I:     23,000,117.16
	MI.01.002: 22,402,469,247.37
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,837,469.97   @J=I:     23,000,795.16
	MW[1]    : 22,425,627,851.97   @J=I:     23,000,117.16
	MW[2]    : 22,402,469,247.37
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,837,469.97   @J=I:     23,000,795.16
	MW[11]   :        627,851.97   @J=I:            117.16
	MW[12]   :        469,247.37
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        773,269.97   @J=I:            785.16
	MO.01.001:        627,851.97
	MO.01.002:        469,247.37
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        773,269.97

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBW_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:16 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBO_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:17 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\NHB_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:18 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBSC_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:19 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\TDMAT00C.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:20 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\HBSC_distribution.PRN. 
DISTRIBUTION (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:20 2016
DISTRIBUTION ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_D2D_Flwos.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:21 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_noSchoolTrips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:21 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\PARAMS\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:21 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 636  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 637  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 638  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:16 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:16 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 639  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,672.3209   @J=I:         44.3025
	MI.02.DISTANCE:    469,247.37  
	MW[1]         :    -27,672.3209   @J=I:         44.3025
	MW[2]         :    461,821.41  
	MW[100]       :    232,058.6513   @J=I:      1,137.4742
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,072.166 
	MW[115]       :     -7,299.27  
	MW[116]       :              --
	MW[200]       :    117,677.504    @J=I:      1,892.8933
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 1,892.89328

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 640  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:21 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:21 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,530, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 641  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      1,892.9
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      1,892.9
	MW[1]      :    117,677.5   @J=I:      1,892.9
	MW[2]      :    117,677.5   @J=I:      1,892.9
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_1.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:21 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 642  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 643  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 644  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:16 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:16 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 645  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,672.3209   @J=I:         44.3025
	MI.02.DISTANCE:    469,247.37  
	MW[1]         :    -27,672.3209   @J=I:         44.3025
	MW[2]         :    461,821.41  
	MW[100]       :    239,110.1213   @J=I:      1,163.8842
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,072.166 
	MW[115]       :     -7,299.27  
	MW[116]       :      7,051.47     @J=I:         26.41  
	MW[200]       :    117,677.504    @J=I:      1,948.2521
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 1,948.25214

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 646  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:22 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:21 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,689, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 647  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      1,948.3
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      1,948.3
	MW[1]      :    117,677.5   @J=I:      1,948.3
	MW[2]      :    117,677.5   @J=I:      1,948.3
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_2.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:22 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 648  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 649  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 650  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:16 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:16 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 651  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,672.3209   @J=I:         44.3025
	MI.02.DISTANCE:    469,247.37  
	MW[1]         :    -27,672.3209   @J=I:         44.3025
	MW[2]         :    461,821.41  
	MW[100]       :    245,961.3413   @J=I:      1,189.5442
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,072.166 
	MW[115]       :     -7,299.27  
	MW[116]       :     13,902.69     @J=I:         52.07  
	MW[200]       :    117,677.504    @J=I:      1,983.5331
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 1,983.53312

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 652  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:22 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:22 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,796, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 653  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      1,983.5
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      1,983.5
	MW[1]      :    117,677.5   @J=I:      1,983.5
	MW[2]      :    117,677.5   @J=I:      1,983.5
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_3.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:22 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 654  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 655  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 656  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:16 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:16 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 657  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,672.3209   @J=I:         44.3025
	MI.02.DISTANCE:    469,247.37  
	MW[1]         :    -27,672.3209   @J=I:         44.3025
	MW[2]         :    461,821.41  
	MW[100]       :    252,703.0913   @J=I:      1,214.7942
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,072.166 
	MW[115]       :     -7,299.27  
	MW[116]       :     20,644.44     @J=I:         77.32  
	MW[200]       :    117,677.504    @J=I:      2,006.1866
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,006.18658

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 658  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:23 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:22 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,882, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 659  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,006.2
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,006.2
	MW[1]      :    117,677.5   @J=I:      2,006.2
	MW[2]      :    117,677.5   @J=I:      2,006.2
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_4.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:23 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 660  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 661  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 662  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:16 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:16 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 663  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,672.3209   @J=I:         44.3025
	MI.02.DISTANCE:    469,247.37  
	MW[1]         :    -27,672.3209   @J=I:         44.3025
	MW[2]         :    461,821.41  
	MW[100]       :    259,364.7413   @J=I:      1,239.7442
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,072.166 
	MW[115]       :     -7,299.27  
	MW[116]       :     27,306.09     @J=I:        102.27  
	MW[200]       :    117,677.504    @J=I:      2,020.3034
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,020.30337

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 664  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:23 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:23 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,935, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 665  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,020.3
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,020.3
	MW[1]      :    117,677.5   @J=I:      2,020.3
	MW[2]      :    117,677.5   @J=I:      2,020.3
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_5.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:23 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 666  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 667  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 668  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:16 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:16 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 669  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,672.3209   @J=I:         44.3025
	MI.02.DISTANCE:    469,247.37  
	MW[1]         :    -27,672.3209   @J=I:         44.3025
	MW[2]         :    461,821.41  
	MW[100]       :    266,218.6313   @J=I:      1,265.4142
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,072.166 
	MW[115]       :     -7,299.27  
	MW[116]       :     34,159.98     @J=I:        127.94  
	MW[200]       :    117,677.504    @J=I:      2,026.9697
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,026.9697 

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 670  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:24 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:23 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,970, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 671  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,027  
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,027  
	MW[1]      :    117,677.5   @J=I:      2,027  
	MW[2]      :    117,677.5   @J=I:      2,027  
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_6.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:24 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 672  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 673  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 674  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:16 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:16 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 675  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,672.3209   @J=I:         44.3025
	MI.02.DISTANCE:    469,247.37  
	MW[1]         :    -27,672.3209   @J=I:         44.3025
	MW[2]         :    461,821.41  
	MW[100]       :    272,997.7613   @J=I:      1,290.8042
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,072.166 
	MW[115]       :     -7,299.27  
	MW[116]       :     40,939.11     @J=I:        153.33  
	MW[200]       :    117,677.504    @J=I:      2,033.1406
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,033.14055

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 676  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:24 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:24 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,955, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 677  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,033.1
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,033.1
	MW[1]      :    117,677.5   @J=I:      2,033.1
	MW[2]      :    117,677.5   @J=I:      2,033.1
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_7.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:25 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 678  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 679  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 680  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:16 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:16 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 681  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,672.3209   @J=I:         44.3025
	MI.02.DISTANCE:    469,247.37  
	MW[1]         :    -27,672.3209   @J=I:         44.3025
	MW[2]         :    461,821.41  
	MW[100]       :    279,742.1813   @J=I:      1,316.0642
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,072.166 
	MW[115]       :     -7,299.27  
	MW[116]       :     47,683.53     @J=I:        178.59  
	MW[200]       :    117,677.504    @J=I:      2,035.1778
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,035.17783

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 682  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:25 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:25 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,981, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 683  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,035.2
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,035.2
	MW[1]      :    117,677.5   @J=I:      2,035.2
	MW[2]      :    117,677.5   @J=I:      2,035.2
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_8.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:25 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 684  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 685  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 686  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:16 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:16 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 687  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,672.3209   @J=I:         44.3025
	MI.02.DISTANCE:    469,247.37  
	MW[1]         :    -27,672.3209   @J=I:         44.3025
	MW[2]         :    461,821.41  
	MW[100]       :    286,451.8913   @J=I:      1,341.1942
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,072.166 
	MW[115]       :     -7,299.27  
	MW[116]       :     54,393.24     @J=I:        203.72  
	MW[200]       :    117,677.504    @J=I:      2,037.2049
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,037.20491

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 688  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:26 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:25 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,967, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 689  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,037.2
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,037.2
	MW[1]      :    117,677.5   @J=I:      2,037.2
	MW[2]      :    117,677.5   @J=I:      2,037.2
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_9.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:26 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 690  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 691  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 692  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:16 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:16 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 693  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,672.3209   @J=I:         44.3025
	MI.02.DISTANCE:    469,247.37  
	MW[1]         :    -27,672.3209   @J=I:         44.3025
	MW[2]         :    461,821.41  
	MW[100]       :    293,215.0013   @J=I:      1,366.5242
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,072.166 
	MW[115]       :     -7,299.27  
	MW[116]       :     61,156.35     @J=I:        229.05  
	MW[200]       :    117,677.504    @J=I:      2,037.2751
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,037.27513

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 694  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:26 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:26 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,007, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 695  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,037.3
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,037.3
	MW[1]      :    117,677.5   @J=I:      2,037.3
	MW[2]      :    117,677.5   @J=I:      2,037.3
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_10.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBO.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:26 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:27 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:27 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:27 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBSH.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:27 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:27 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:27 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:27 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_NHB.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:27 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:28 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:28 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:28 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_tlfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:28 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_ttfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:28 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_d2d_flows.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:28 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 740  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:28 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT",
 MO = 1, NAME = HBO_HBSH
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT"

MW[1] = MI.1.1 + MI.2.1


MATRIX Stack Size = 344 bytes.
................................................................................


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:27 2016 
ID=
PAR Zones=267 M=1
  HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:26 2016 
ID=
PAR Zones=267 M=1
  HBO

Totals after Iteration 1 I loop:

	MI.02.001: 136,095   @J=I:  11,963
	MI.01.001: 264,074   @J=I:  60,928
	MW[1]    : 400,170   @J=I:  72,890
	MO.01.001: 400,173

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################
Page 741  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:29 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 742  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2810 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:26 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:16 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 743  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 117,677.504    @J=I:   2,037.2751
	MI.01.001:  58,646.5096   @J=I:     182.5061
	MI.01.002:   5,645.8912   @J=I:      17.5698
	MI.01.003:   1,017.817 
	MI.01.004:           --
	MI.01.005:   5,978.7822   @J=I:      66.9241
	MI.01.006:  59,540.7791   @J=I:     182.5061
	MI.01.007:   5,731.9824   @J=I:      17.5698
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   6,016.2384   @J=I:      66.9241
	MW[1]    : 117,677.504    @J=I:   2,037.2751
	MW[2]    :  36,613.0894   @J=I:     694.5352
	MW[3]    :  81,064.4146   @J=I:   1,342.7399
	MW[11]   :  58,646.5096   @J=I:     182.5061
	MW[12]   :   5,645.8912   @J=I:      17.5698
	MW[13]   :   1,017.817 
	MW[14]   :           --
	MW[15]   :   5,978.7822   @J=I:      66.9241
	MW[16]   :  59,540.7791   @J=I:     182.5061
	MW[17]   :   5,731.9824   @J=I:      17.5698
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   6,016.2384   @J=I:      66.9241
	MW[21]   : 103,300.5704   @J=I:   1,383.0578
	MW[22]   :   9,944.7313   @J=I:     133.1468
	MW[23]   :   3,108.957 
	MW[24]   :           --
	MW[25]   :   1,323.2452   @J=I:     521.0705
	MO.01.001: 103,303.14  
	MO.01.002:   9,945.1   
	MO.01.003:   3,107.46  
	MO.01.005:   1,317.81  

Variable Values at end of Iteration 1 I loop:

    EDA: 103,300.6
    ESR:   9,944.7
    ELB:   3,109  
    ENM:   1,323.2
    TRN:   3,109  
    AUT: 113,245.3
    TOT: 117,677.5

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 744  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:29 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 745  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2814 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:28 2016 
ID=
PAR Zones=267 M=1
  HBO_HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:17 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 746  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 400,172.6      @J=I:  72,890.46  
	MI.01.001:  30,514.7185   @J=I:      83.9646
	MI.01.002:  31,532.1967   @J=I:      86.7643
	MI.01.003:     207.8523
	MI.01.004:           --
	MI.01.005:   9,034.2325   @J=I:      96.2712
	MI.01.006:  30,609.5845   @J=I:      83.9646
	MI.01.007:  31,630.2259   @J=I:      86.7643
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   9,049.1895   @J=I:      96.2712
	MW[1]    : 400,172.6      @J=I:  72,890.46  
	MW[2]    : 154,872.9604   @J=I:  25,113.422 
	MW[3]    : 245,299.6396   @J=I:  47,777.038 
	MW[11]   :  30,514.7185   @J=I:      83.9646
	MW[12]   :  31,532.1967   @J=I:      86.7643
	MW[13]   :     207.8523
	MW[14]   :           --
	MW[15]   :   9,034.2325   @J=I:      96.2712
	MW[16]   :  30,609.5845   @J=I:      83.9646
	MW[17]   :  31,630.2259   @J=I:      86.7643
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   9,049.1895   @J=I:      96.2712
	MW[21]   : 170,394.3686   @J=I:  22,846.1641
	MW[22]   : 176,075.9728   @J=I:  23,607.9432
	MW[23]   :   2,252.8014
	MW[24]   :           --
	MW[25]   :  51,449.4573   @J=I:  26,436.3526
	MO.01.001: 170,387.02  
	MO.01.002: 176,089.7   
	MO.01.003:   2,252.17  
	MO.01.005:  51,443.45  

Variable Values at end of Iteration 1 I loop:

    EDA: 170,394.4
    ESR: 176,076  
    ELB:   2,252.8
    ENM:  51,449.5
    TRN:   2,252.8
    AUT: 346,470.3
    TOT: 400,172.6

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 747  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:29 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 748  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2810 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:27 2016 
ID=
PAR Zones=267 M=1
  NHB

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:18 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 749  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 315,086.909    @J=I:  73,080.8531
	MI.01.001:  35,015.0558   @J=I:     118.444 
	MI.01.002:  32,745.9121   @J=I:     110.7682
	MI.01.003:      97.3576
	MI.01.004:           --
	MI.01.005:   3,430.6745   @J=I:      37.7878
	MI.01.006:  35,064.0097   @J=I:     118.444 
	MI.01.007:  32,791.6936   @J=I:     110.7682
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   3,433.2966   @J=I:      37.7878
	MW[1]    : 315,086.909    @J=I:  73,080.8531
	MW[2]    : 124,137.1393   @J=I:  27,541.0081
	MW[3]    : 190,949.7697   @J=I:  45,539.8451
	MW[11]   :  35,015.0558   @J=I:     118.444 
	MW[12]   :  32,745.9121   @J=I:     110.7682
	MW[13]   :      97.3576
	MW[14]   :           --
	MW[15]   :   3,430.6745   @J=I:      37.7878
	MW[16]   :  35,064.0097   @J=I:     118.444 
	MW[17]   :  32,791.6936   @J=I:     110.7682
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   3,433.2966   @J=I:      37.7878
	MW[21]   : 154,780.4152   @J=I:  32,355.5535
	MW[22]   : 144,749.9016   @J=I:  30,258.7584
	MW[23]   :     862.8534
	MW[24]   :           --
	MW[25]   :  14,693.7389   @J=I:  10,466.5413
	MO.01.001: 154,783.13  
	MO.01.002: 144,753.32  
	MO.01.003:     858.57  
	MO.01.005:  14,686.97  

Variable Values at end of Iteration 1 I loop:

    EDA: 154,780.415
    ESR: 144,749.902
    ELB:     862.853
    ENM:  14,693.739
    TRN:     862.853
    AUT: 299,530.317
    TOT: 315,086.909

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################
Page 750  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:30 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 751  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2828 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:21 2016 
ID=
PAR Zones=267 M=1
  HBSC

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:15:19 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 752  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001:  7,670.07     @J=I:    991.33  
	MI.01.001: 35,015.0558   @J=I:    118.444 
	MI.01.002: 32,745.9121   @J=I:    110.7682
	MI.01.003:     97.3576
	MI.01.004:          --
	MI.01.005:  3,430.6745   @J=I:     37.7878
	MI.01.006: 35,064.0097   @J=I:    118.444 
	MI.01.007: 32,791.6936   @J=I:    110.7682
	MI.01.008:          --
	MI.01.009:          --
	MI.01.010:  3,433.2966   @J=I:     37.7878
	MW[1]    :  7,670.07     @J=I:    991.33  
	MW[2]    :  2,608.5186   @J=I:    301.4566
	MW[3]    :  5,061.5514   @J=I:    689.8734
	MW[11]   : 35,015.0558   @J=I:    118.444 
	MW[12]   : 32,745.9121   @J=I:    110.7682
	MW[13]   :     97.3576
	MW[14]   :          --
	MW[15]   :  3,430.6745   @J=I:     37.7878
	MW[16]   : 35,064.0097   @J=I:    118.444 
	MW[17]   : 32,791.6936   @J=I:    110.7682
	MW[18]   :          --
	MW[19]   :          --
	MW[20]   :  3,433.2966   @J=I:     37.7878
	MW[21]   :  3,768.3071   @J=I:    439.744 
	MW[22]   :  3,524.1027   @J=I:    411.2465
	MW[23]   :     22.0508
	MW[24]   :          --
	MW[25]   :    355.6094   @J=I:    140.3395
	MO.01.001:  3,776.81  
	MO.01.002:  3,516.2   
	MO.01.003:     20.94  
	MO.01.005:    354.57  

Variable Values at end of Iteration 1 I loop:

    EDA: 3,768.3071
    ESR: 3,524.1027
    ELB:    22.0508
    ENM:   355.6094
    TRN:    22.0508
    AUT: 7,292.4099
    TOT: 7,670.07  

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_AM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:30 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_MD.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:30 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_PM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:31 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_NT.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:31 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\MC_Transit_Trips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:31 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:31 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\AM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:15:32 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:37
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:16:09 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\MD.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:16:10 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:20
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:16:30 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:16:30 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:19
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:16:49 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\NT.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:16:49 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:03
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Merge_Hwy_Assignments.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Fri Mar 18 15:16:52 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Hwy_eval.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Fri Mar 18 15:16:52 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PBHWY00B.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:16:53 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\PBHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:16:53 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\Output\PK_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\PK_HWYSKIM_1.MAT
M(100): COPY C:\projects\Roanoke\Base\Output\OP_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\OP_HWYSKIM_1.MATPage 858  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:16:53 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\pk_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\PK_CNG_HwySkim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1330 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\PK_CNG_HwySkim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Fri Mar 18 15:16:53 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 859  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,686,445.3   @J=I:     23,000,120.8
	MI.01.002: 22,402,477,576.8
	MI.01.003:         90,513     @J=I:            339  
	MI.01.004:        119,105     @J=I:            339  
	MI.01.005: 22,425,896,063.3   @J=I:     23,000,798.8
	MW[1]    : 22,425,686,445.3   @J=I:     23,000,120.8
	MW[2]    : 22,402,477,576.8
	MW[3]    :         90,513     @J=I:            339  
	MW[4]    :        119,105     @J=I:            339  
	MW[5]    : 22,425,896,063.3   @J=I:     23,000,798.8
	MW[11]   :        686,445.3   @J=I:            120.8
	MW[12]   :        477,576.8
	MW[13]   :         90,513     @J=I:            339  
	MW[14]   :        119,105     @J=I:            339  
	MW[15]   :        831,863.3   @J=I:            788.8
	MO.01.001:        686,445.3
	MO.01.002:        477,576.8
	MO.01.003:         90,513  
	MO.01.004:        119,105  
	MO.01.005:        831,863.3

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################
Page 860  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:16:54 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_CNG_HwySkim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1330 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\OP_CNG_HwySkim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Fri Mar 18 15:16:53 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 861  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,675,038.92   @J=I:     23,000,119.65
	MI.01.002: 22,402,469,443.34
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,884,656.92   @J=I:     23,000,797.65
	MW[1]    : 22,425,675,038.92   @J=I:     23,000,119.65
	MW[2]    : 22,402,469,443.34
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,884,656.92   @J=I:     23,000,797.65
	MW[11]   :        675,038.92   @J=I:            119.65
	MW[12]   :        469,443.34
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        820,456.92   @J=I:            787.65
	MO.01.001:        675,038.92
	MO.01.002:        469,443.34
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        820,456.92

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBW_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:16:54 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBO_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:16:55 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\NHB_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:16:56 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBSC_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:16:57 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\TDMAT00C.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:16:58 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\HBSC_distribution.PRN. 
DISTRIBUTION (v.08/05/2014 [6.1.1])  Fri Mar 18 15:16:58 2016
DISTRIBUTION ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_D2D_Flwos.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:16:59 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_noSchoolTrips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:16:59 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\PARAMS\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:16:59 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 925  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 926  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 927  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:16:54 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:16:53 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 928  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,294.7316   @J=I:         44.2351
	MI.02.DISTANCE:    477,576.78  
	MW[1]         :    -29,294.7316   @J=I:         44.2351
	MW[2]         :    469,893.14  
	MW[100]       :    230,059.1681   @J=I:      1,137.4353
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,704.9214
	MW[115]       :     -7,313.07  
	MW[116]       :              --
	MW[200]       :    117,677.504    @J=I:      1,941.5632
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 1,941.56324

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 929  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:16:59 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:16:59 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,456, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 930  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      1,941.6
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      1,941.6
	MW[1]      :    117,677.5   @J=I:      1,941.6
	MW[2]      :    117,677.5   @J=I:      1,941.6
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_1.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:16:59 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 931  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 932  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 933  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:16:54 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:16:53 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 934  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,294.7316   @J=I:         44.2351
	MI.02.DISTANCE:    477,576.78  
	MW[1]         :    -29,294.7316   @J=I:         44.2351
	MW[2]         :    469,893.14  
	MW[100]       :    237,292.1981   @J=I:      1,164.5253
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,704.9214
	MW[115]       :     -7,313.07  
	MW[116]       :      7,233.03     @J=I:         27.09  
	MW[200]       :    117,677.504    @J=I:      1,996.4649
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 1,996.46494

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 935  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:00 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:16:59 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,680, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 936  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      1,996.5
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      1,996.5
	MW[1]      :    117,677.5   @J=I:      1,996.5
	MW[2]      :    117,677.5   @J=I:      1,996.5
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_2.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:00 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 937  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 938  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 939  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:16:54 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:16:53 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 940  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,294.7316   @J=I:         44.2351
	MI.02.DISTANCE:    477,576.78  
	MW[1]         :    -29,294.7316   @J=I:         44.2351
	MW[2]         :    469,893.14  
	MW[100]       :    244,143.4181   @J=I:      1,190.1853
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,704.9214
	MW[115]       :     -7,313.07  
	MW[116]       :     14,084.25     @J=I:         52.75  
	MW[200]       :    117,677.504    @J=I:      2,033.1352
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,033.13521

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 941  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:00 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:17:00 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,773, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 942  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,033.1
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,033.1
	MW[1]      :    117,677.5   @J=I:      2,033.1
	MW[2]      :    117,677.5   @J=I:      2,033.1
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_3.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:00 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 943  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 944  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 945  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:16:54 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:16:53 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 946  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,294.7316   @J=I:         44.2351
	MI.02.DISTANCE:    477,576.78  
	MW[1]         :    -29,294.7316   @J=I:         44.2351
	MW[2]         :    469,893.14  
	MW[100]       :    250,877.1581   @J=I:      1,215.4053
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,704.9214
	MW[115]       :     -7,313.07  
	MW[116]       :     20,817.99     @J=I:         77.97  
	MW[200]       :    117,677.504    @J=I:      2,056.6895
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,056.68948

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 947  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:01 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:17:00 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,875, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 948  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,056.7
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,056.7
	MW[1]      :    117,677.5   @J=I:      2,056.7
	MW[2]      :    117,677.5   @J=I:      2,056.7
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_4.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:01 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 949  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 950  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 951  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:16:54 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:16:53 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 952  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,294.7316   @J=I:         44.2351
	MI.02.DISTANCE:    477,576.78  
	MW[1]         :    -29,294.7316   @J=I:         44.2351
	MW[2]         :    469,893.14  
	MW[100]       :    257,693.6681   @J=I:      1,240.9353
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,704.9214
	MW[115]       :     -7,313.07  
	MW[116]       :     27,634.5      @J=I:        103.5   
	MW[200]       :    117,677.504    @J=I:      2,070.592 
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,070.59195

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 953  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:01 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:17:01 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,896, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 954  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,070.6
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,070.6
	MW[1]      :    117,677.5   @J=I:      2,070.6
	MW[2]      :    117,677.5   @J=I:      2,070.6
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_5.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:01 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 955  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 956  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 957  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:16:54 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:16:53 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 958  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,294.7316   @J=I:         44.2351
	MI.02.DISTANCE:    477,576.78  
	MW[1]         :    -29,294.7316   @J=I:         44.2351
	MW[2]         :    469,893.14  
	MW[100]       :    264,531.5381   @J=I:      1,266.5453
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,704.9214
	MW[115]       :     -7,313.07  
	MW[116]       :     34,472.37     @J=I:        129.11  
	MW[200]       :    117,677.504    @J=I:      2,078.523 
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,078.523  

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 959  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:02 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:17:01 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,926, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 960  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,078.5
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,078.5
	MW[1]      :    117,677.5   @J=I:      2,078.5
	MW[2]      :    117,677.5   @J=I:      2,078.5
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_6.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:02 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 961  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 962  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 963  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:16:54 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:16:53 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 964  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,294.7316   @J=I:         44.2351
	MI.02.DISTANCE:    477,576.78  
	MW[1]         :    -29,294.7316   @J=I:         44.2351
	MW[2]         :    469,893.14  
	MW[100]       :    271,297.3181   @J=I:      1,291.8853
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,704.9214
	MW[115]       :     -7,313.07  
	MW[116]       :     41,238.15     @J=I:        154.45  
	MW[200]       :    117,677.504    @J=I:      2,084.546 
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,084.54598

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 965  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:02 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:17:02 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,939, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 966  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,084.5
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,084.5
	MW[1]      :    117,677.5   @J=I:      2,084.5
	MW[2]      :    117,677.5   @J=I:      2,084.5
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_7.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:02 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 967  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 968  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 969  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:16:54 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:16:53 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 970  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,294.7316   @J=I:         44.2351
	MI.02.DISTANCE:    477,576.78  
	MW[1]         :    -29,294.7316   @J=I:         44.2351
	MW[2]         :    469,893.14  
	MW[100]       :    277,991.0081   @J=I:      1,316.9553
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,704.9214
	MW[115]       :     -7,313.07  
	MW[116]       :     47,931.84     @J=I:        179.52  
	MW[200]       :    117,677.504    @J=I:      2,087.2634
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,087.2634 

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 971  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:03 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:17:02 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,961, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 972  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,087.3
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,087.3
	MW[1]      :    117,677.5   @J=I:      2,087.3
	MW[2]      :    117,677.5   @J=I:      2,087.3
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_8.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:03 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 973  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 974  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 975  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:16:54 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:16:53 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 976  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,294.7316   @J=I:         44.2351
	MI.02.DISTANCE:    477,576.78  
	MW[1]         :    -29,294.7316   @J=I:         44.2351
	MW[2]         :    469,893.14  
	MW[100]       :    284,732.7581   @J=I:      1,342.2053
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,704.9214
	MW[115]       :     -7,313.07  
	MW[116]       :     54,673.59     @J=I:        204.77  
	MW[200]       :    117,677.504    @J=I:      2,089.7693
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,089.76931

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 977  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:03 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:17:03 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,965, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 978  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,089.8
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,089.8
	MW[1]      :    117,677.5   @J=I:      2,089.8
	MW[2]      :    117,677.5   @J=I:      2,089.8
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_9.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:03 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 979  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 980  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 981  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:16:54 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:16:53 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 982  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,294.7316   @J=I:         44.2351
	MI.02.DISTANCE:    477,576.78  
	MW[1]         :    -29,294.7316   @J=I:         44.2351
	MW[2]         :    469,893.14  
	MW[100]       :    291,458.4881   @J=I:      1,367.3953
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,704.9214
	MW[115]       :     -7,313.07  
	MW[116]       :     61,399.32     @J=I:        229.96  
	MW[200]       :    117,677.504    @J=I:      2,090.3222
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,090.32215

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 983  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:04 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:17:03 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,977, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 984  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,090.3
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,090.3
	MW[1]      :    117,677.5   @J=I:      2,090.3
	MW[2]      :    117,677.5   @J=I:      2,090.3
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_10.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBO.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:04 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:04 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:04 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:05 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBSH.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:05 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:05 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:05 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:05 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_NHB.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:05 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:06 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:06 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:06 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_tlfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:06 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_ttfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:06 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_d2d_flows.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:06 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 29  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:06 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT",
 MO = 1, NAME = HBO_HBSH
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT"

MW[1] = MI.1.1 + MI.2.1


MATRIX Stack Size = 344 bytes.
................................................................................


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:17:05 2016 
ID=
PAR Zones=267 M=1
  HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:17:04 2016 
ID=
PAR Zones=267 M=1
  HBO

Totals after Iteration 1 I loop:

	MI.02.001: 136,095   @J=I:  11,960
	MI.01.001: 264,074   @J=I:  60,916
	MW[1]    : 400,170   @J=I:  72,876
	MO.01.001: 400,173

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 30  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:06 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 31  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------

MATRIX Stack Size = 2810 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:17:03 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:16:54 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 32  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 117,677.504    @J=I:   2,090.3222
	MI.01.001:  58,626.7255   @J=I:     182.4902
	MI.01.002:   5,643.9866   @J=I:      17.5683
	MI.01.003:   1,036.6397
	MI.01.004:           --
	MI.01.005:   5,981.6482   @J=I:      66.9415
	MI.01.006:  59,537.7062   @J=I:     182.4902
	MI.01.007:   5,731.6866   @J=I:      17.5683
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   6,019.6072   @J=I:      66.9415
	MW[1]    : 117,677.504    @J=I:   2,090.3222
	MW[2]    :  36,728.8442   @J=I:     712.9312
	MW[3]    :  80,948.6598   @J=I:   1,377.391 
	MW[11]   :  58,626.7255   @J=I:     182.4902
	MW[12]   :   5,643.9866   @J=I:      17.5683
	MW[13]   :   1,036.6397
	MW[14]   :           --
	MW[15]   :   5,981.6482   @J=I:      66.9415
	MW[16]   :  59,537.7062   @J=I:     182.4902
	MW[17]   :   5,731.6866   @J=I:      17.5683
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   6,019.6072   @J=I:      66.9415
	MW[21]   : 103,180.4458   @J=I:   1,419.077 
	MW[22]   :   9,933.167    @J=I:     136.6143
	MW[23]   :   3,192.867 
	MW[24]   :           --
	MW[25]   :   1,371.0242   @J=I:     534.6308
	MO.01.001: 103,182.42  
	MO.01.002:   9,931.83  
	MO.01.003:   3,191.41  
	MO.01.005:   1,365.57  

Variable Values at end of Iteration 1 I loop:

    EDA: 103,180.4
    ESR:   9,933.2
    ELB:   3,192.9
    ENM:   1,371  
    TRN:   3,192.9
    AUT: 113,113.6
    TOT: 117,677.5

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################
Page 33  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:07 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 34  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------

MATRIX Stack Size = 2814 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:17:06 2016 
ID=
PAR Zones=267 M=1
  HBO_HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:16:55 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 35  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 400,173.12     @J=I:  72,876.54  
	MI.01.001:  30,510.611    @J=I:      83.9603
	MI.01.002:  31,527.9523   @J=I:      86.7599
	MI.01.003:     209.7239
	MI.01.004:           --
	MI.01.005:   9,040.7128   @J=I:      96.2798
	MI.01.006:  30,606.3394   @J=I:      83.9603
	MI.01.007:  31,626.8725   @J=I:      86.7599
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   9,055.7881   @J=I:      96.2798
	MW[1]    : 400,173.12     @J=I:  72,876.54  
	MW[2]    : 154,771.1706   @J=I:  25,140.7886
	MW[3]    : 245,401.9494   @J=I:  47,735.7514
	MW[11]   :  30,510.611    @J=I:      83.9603
	MW[12]   :  31,527.9523   @J=I:      86.7599
	MW[13]   :     209.7239
	MW[14]   :           --
	MW[15]   :   9,040.7128   @J=I:      96.2798
	MW[16]   :  30,606.3394   @J=I:      83.9603
	MW[17]   :  31,626.8725   @J=I:      86.7599
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   9,055.7881   @J=I:      96.2798
	MW[21]   : 170,298.8936   @J=I:  22,840.8832
	MW[22]   : 175,977.3143   @J=I:  23,602.4862
	MW[23]   :   2,263.7719
	MW[24]   :           --
	MW[25]   :  51,633.1402   @J=I:  26,433.1707
	MO.01.001: 170,292.35  
	MO.01.002: 175,990.59  
	MO.01.003:   2,262.76  
	MO.01.005:  51,627.36  

Variable Values at end of Iteration 1 I loop:

    EDA: 170,298.9
    ESR: 175,977.3
    ELB:   2,263.8
    ENM:  51,633.1
    TRN:   2,263.8
    AUT: 346,276.2
    TOT: 400,173.1

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 36  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:07 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 37  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------

MATRIX Stack Size = 2810 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:17:05 2016 
ID=
PAR Zones=267 M=1
  NHB

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:16:56 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 38  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 315,086.909    @J=I:  73,284.2068
	MI.01.001:  35,013.7197   @J=I:     118.4408
	MI.01.002:  32,744.6626   @J=I:     110.7653
	MI.01.003:      98.3825
	MI.01.004:           --
	MI.01.005:   3,432.2352   @J=I:      37.7939
	MI.01.006:  35,063.1921   @J=I:     118.4408
	MI.01.007:  32,790.929    @J=I:     110.7653
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   3,434.8788   @J=I:      37.7939
	MW[1]    : 315,086.909    @J=I:  73,284.2068
	MW[2]    : 124,124.5261   @J=I:  27,639.1003
	MW[3]    : 190,962.3829   @J=I:  45,645.1065
	MW[11]   :  35,013.7197   @J=I:     118.4408
	MW[12]   :  32,744.6626   @J=I:     110.7653
	MW[13]   :      98.3825
	MW[14]   :           --
	MW[15]   :   3,432.2352   @J=I:      37.7939
	MW[16]   :  35,063.1921   @J=I:     118.4408
	MW[17]   :  32,790.929    @J=I:     110.7653
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   3,434.8788   @J=I:      37.7939
	MW[21]   : 154,739.2411   @J=I:  32,445.3004
	MW[22]   : 144,711.3958   @J=I:  30,342.6893
	MW[23]   :     869.8729
	MW[24]   :           --
	MW[25]   :  14,766.3992   @J=I:  10,496.2172
	MO.01.001: 154,741.83  
	MO.01.002: 144,714.93  
	MO.01.003:     865.16  
	MO.01.005:  14,759.65  

Variable Values at end of Iteration 1 I loop:

    EDA: 154,739.241
    ESR: 144,711.396
    ELB:     869.873
    ENM:  14,766.399
    TRN:     869.873
    AUT: 299,450.637
    TOT: 315,086.909

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 39  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:07 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 40  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------

MATRIX Stack Size = 2828 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:16:59 2016 
ID=
PAR Zones=267 M=1
  HBSC

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:16:57 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 41  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------

Totals after Iteration 1 I loop:

	MI.02.001:  7,669.87     @J=I:  1,023.35  
	MI.01.001: 35,013.7197   @J=I:    118.4408
	MI.01.002: 32,744.6626   @J=I:    110.7653
	MI.01.003:     98.3825
	MI.01.004:          --
	MI.01.005:  3,432.2352   @J=I:     37.7939
	MI.01.006: 35,063.1921   @J=I:    118.4408
	MI.01.007: 32,790.929    @J=I:    110.7653
	MI.01.008:          --
	MI.01.009:          --
	MI.01.010:  3,434.8788   @J=I:     37.7939
	MW[1]    :  7,669.87     @J=I:  1,023.35  
	MW[2]    :  2,631.2113   @J=I:    328.1901
	MW[3]    :  5,038.6587   @J=I:    695.1599
	MW[11]   : 35,013.7197   @J=I:    118.4408
	MW[12]   : 32,744.6626   @J=I:    110.7653
	MW[13]   :     98.3825
	MW[14]   :          --
	MW[15]   :  3,432.2352   @J=I:     37.7939
	MW[16]   : 35,063.1921   @J=I:    118.4408
	MW[17]   : 32,790.929    @J=I:    110.7653
	MW[18]   :          --
	MW[19]   :          --
	MW[20]   :  3,434.8788   @J=I:     37.7939
	MW[21]   :  3,761.6572   @J=I:    453.8656
	MW[22]   :  3,517.8838   @J=I:    424.453 
	MW[23]   :     22.7227
	MW[24]   :          --
	MW[25]   :    367.6064   @J=I:    145.0314
	MO.01.001:  3,769.71  
	MO.01.002:  3,510.53  
	MO.01.003:     21.7   
	MO.01.005:    366.53  

Variable Values at end of Iteration 1 I loop:

    EDA: 3,761.6572
    ESR: 3,517.8838
    ELB:    22.7227
    ENM:   367.6064
    TRN:    22.7227
    AUT: 7,279.541 
    TOT: 7,669.87  

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_AM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:08 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_MD.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:08 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_PM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:08 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_NT.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:08 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\MC_Transit_Trips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:09 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:09 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\AM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:09 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:31
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:40 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\MD.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:17:40 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:20
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:00 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:01 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:20
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:21 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\NT.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:21 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:04
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Merge_Hwy_Assignments.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:25 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Hwy_eval.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:25 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PBHWY00B.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:25 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\PBHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:25 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################

M(100): COPY C:\projects\Roanoke\Base\Output\PK_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\PK_HWYSKIM_2.MAT
M(100): COPY C:\projects\Roanoke\Base\Output\OP_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\OP_HWYSKIM_2.MATPage 144  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:26 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\pk_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\PK_CNG_HwySkim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1330 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\PK_CNG_HwySkim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Fri Mar 18 15:18:25 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 145  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,685,057.07   @J=I:     23,000,120.72
	MI.01.002: 22,402,477,312.91
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,894,675.07   @J=I:     23,000,798.72
	MW[1]    : 22,425,685,057.07   @J=I:     23,000,120.72
	MW[2]    : 22,402,477,312.91
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,894,675.07   @J=I:     23,000,798.72
	MW[11]   :        685,057.07   @J=I:            120.72
	MW[12]   :        477,312.91
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        830,475.07   @J=I:            788.72
	MO.01.001:        685,057.07
	MO.01.002:        477,312.91
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        830,475.07

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 146  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:26 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_CNG_HwySkim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1330 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\OP_CNG_HwySkim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Fri Mar 18 15:18:25 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 147  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,674,349.78   @J=I:     23,000,119.61
	MI.01.002: 22,402,469,265.05
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,883,967.78   @J=I:     23,000,797.61
	MW[1]    : 22,425,674,349.78   @J=I:     23,000,119.61
	MW[2]    : 22,402,469,265.05
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,883,967.78   @J=I:     23,000,797.61
	MW[11]   :        674,349.78   @J=I:            119.61
	MW[12]   :        469,265.05
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        819,767.78   @J=I:            787.61
	MO.01.001:        674,349.78
	MO.01.002:        469,265.05
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        819,767.78

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBW_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:26 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBO_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:27 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\NHB_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:28 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBSC_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:29 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\TDMAT00C.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:30 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\HBSC_distribution.PRN. 
DISTRIBUTION (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:30 2016
DISTRIBUTION ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_D2D_Flwos.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:31 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_noSchoolTrips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:31 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\PARAMS\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:31 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 211  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 212  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 213  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:26 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:26 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 214  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,255.001    @J=I:         44.2366
	MI.02.DISTANCE:    477,312.91  
	MW[1]         :    -29,255.001    @J=I:         44.2366
	MW[2]         :    469,656.26  
	MW[100]       :    230,118.0135   @J=I:      1,137.4362
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,687.2942
	MW[115]       :     -7,307.31  
	MW[116]       :              --
	MW[200]       :    117,677.504    @J=I:      1,939.7461
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 1,939.74606

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 215  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:32 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:31 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,457, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 216  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      1,939.7
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      1,939.7
	MW[1]      :    117,677.5   @J=I:      1,939.7
	MW[2]      :    117,677.5   @J=I:      1,939.7
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_1.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:32 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 217  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 218  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 219  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:26 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:26 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 220  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,255.001    @J=I:         44.2366
	MI.02.DISTANCE:    477,312.91  
	MW[1]         :    -29,255.001    @J=I:         44.2366
	MW[2]         :    469,656.26  
	MW[100]       :    237,353.7135   @J=I:      1,164.5362
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,687.2942
	MW[115]       :     -7,307.31  
	MW[116]       :      7,235.7      @J=I:         27.1   
	MW[200]       :    117,677.504    @J=I:      1,993.8378
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 1,993.83779

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 221  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:32 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:32 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,664, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 222  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      1,993.8
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      1,993.8
	MW[1]      :    117,677.5   @J=I:      1,993.8
	MW[2]      :    117,677.5   @J=I:      1,993.8
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_2.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:32 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 223  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 224  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 225  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:26 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:26 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 226  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,255.001    @J=I:         44.2366
	MI.02.DISTANCE:    477,312.91  
	MW[1]         :    -29,255.001    @J=I:         44.2366
	MW[2]         :    469,656.26  
	MW[100]       :    244,215.6135   @J=I:      1,190.2362
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,687.2942
	MW[115]       :     -7,307.31  
	MW[116]       :     14,097.6      @J=I:         52.8   
	MW[200]       :    117,677.504    @J=I:      2,031.1332
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,031.1332 

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 227  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:33 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:32 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,775, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 228  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,031.1
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,031.1
	MW[1]      :    117,677.5   @J=I:      2,031.1
	MW[2]      :    117,677.5   @J=I:      2,031.1
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_3.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:33 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 229  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 230  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 231  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:26 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:26 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 232  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,255.001    @J=I:         44.2366
	MI.02.DISTANCE:    477,312.91  
	MW[1]         :    -29,255.001    @J=I:         44.2366
	MW[2]         :    469,656.26  
	MW[100]       :    250,946.6835   @J=I:      1,215.4462
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,687.2942
	MW[115]       :     -7,307.31  
	MW[116]       :     20,828.67     @J=I:         78.01  
	MW[200]       :    117,677.504    @J=I:      2,054.7964
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,054.7964 

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 233  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:34 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:33 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,860, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 234  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,054.8
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,054.8
	MW[1]      :    117,677.5   @J=I:      2,054.8
	MW[2]      :    117,677.5   @J=I:      2,054.8
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_4.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:34 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 235  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 236  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 237  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:26 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:26 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 238  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,255.001    @J=I:         44.2366
	MI.02.DISTANCE:    477,312.91  
	MW[1]         :    -29,255.001    @J=I:         44.2366
	MW[2]         :    469,656.26  
	MW[100]       :    257,749.8435   @J=I:      1,240.9262
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,687.2942
	MW[115]       :     -7,307.31  
	MW[116]       :     27,631.83     @J=I:        103.49  
	MW[200]       :    117,677.504    @J=I:      2,068.2502
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,068.25021

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 239  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:34 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:34 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,886, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 240  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,068.3
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,068.3
	MW[1]      :    117,677.5   @J=I:      2,068.3
	MW[2]      :    117,677.5   @J=I:      2,068.3
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_5.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:34 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 241  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 242  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 243  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:26 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:26 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 244  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,255.001    @J=I:         44.2366
	MI.02.DISTANCE:    477,312.91  
	MW[1]         :    -29,255.001    @J=I:         44.2366
	MW[2]         :    469,656.26  
	MW[100]       :    264,595.7235   @J=I:      1,266.5662
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,687.2942
	MW[115]       :     -7,307.31  
	MW[116]       :     34,477.71     @J=I:        129.13  
	MW[200]       :    117,677.504    @J=I:      2,076.2163
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,076.21632

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 245  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:35 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:34 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,922, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 246  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,076.2
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,076.2
	MW[1]      :    117,677.5   @J=I:      2,076.2
	MW[2]      :    117,677.5   @J=I:      2,076.2
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_6.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:35 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 247  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 248  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 249  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:26 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:26 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 250  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,255.001    @J=I:         44.2366
	MI.02.DISTANCE:    477,312.91  
	MW[1]         :    -29,255.001    @J=I:         44.2366
	MW[2]         :    469,656.26  
	MW[100]       :    271,369.5135   @J=I:      1,291.9362
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,687.2942
	MW[115]       :     -7,307.31  
	MW[116]       :     41,251.5      @J=I:        154.5   
	MW[200]       :    117,677.504    @J=I:      2,081.78  
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,081.78001

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 251  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:35 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:35 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,926, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 252  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,081.8
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,081.8
	MW[1]      :    117,677.5   @J=I:      2,081.8
	MW[2]      :    117,677.5   @J=I:      2,081.8
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_7.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:36 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 253  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 254  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 255  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:26 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:26 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 256  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,255.001    @J=I:         44.2366
	MI.02.DISTANCE:    477,312.91  
	MW[1]         :    -29,255.001    @J=I:         44.2366
	MW[2]         :    469,656.26  
	MW[100]       :    278,089.9035   @J=I:      1,317.1062
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,687.2942
	MW[115]       :     -7,307.31  
	MW[116]       :     47,971.89     @J=I:        179.67  
	MW[200]       :    117,677.504    @J=I:      2,085.8538
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,085.85384

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 257  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:36 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:36 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,977, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 258  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,085.9
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,085.9
	MW[1]      :    117,677.5   @J=I:      2,085.9
	MW[2]      :    117,677.5   @J=I:      2,085.9
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_8.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:36 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 259  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 260  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 261  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:26 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:26 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 262  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,255.001    @J=I:         44.2366
	MI.02.DISTANCE:    477,312.91  
	MW[1]         :    -29,255.001    @J=I:         44.2366
	MW[2]         :    469,656.26  
	MW[100]       :    284,836.9935   @J=I:      1,342.3762
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,687.2942
	MW[115]       :     -7,307.31  
	MW[116]       :     54,718.98     @J=I:        204.94  
	MW[200]       :    117,677.504    @J=I:      2,086.7661
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,086.76607

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 263  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:37 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:36 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,970, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 264  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,086.8
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,086.8
	MW[1]      :    117,677.5   @J=I:      2,086.8
	MW[2]      :    117,677.5   @J=I:      2,086.8
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_9.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:37 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 265  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 266  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 267  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:26 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:26 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 268  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,255.001    @J=I:         44.2366
	MI.02.DISTANCE:    477,312.91  
	MW[1]         :    -29,255.001    @J=I:         44.2366
	MW[2]         :    469,656.26  
	MW[100]       :    291,589.4235   @J=I:      1,367.6662
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,687.2942
	MW[115]       :     -7,307.31  
	MW[116]       :     61,471.41     @J=I:        230.23  
	MW[200]       :    117,677.504    @J=I:      2,087.8849
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,087.88486

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 269  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:37 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:37 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,985, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 270  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,087.9
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,087.9
	MW[1]      :    117,677.5   @J=I:      2,087.9
	MW[2]      :    117,677.5   @J=I:      2,087.9
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_10.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBO.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:37 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:38 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:38 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:38 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBSH.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:38 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:39 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:39 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:39 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_NHB.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:39 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:39 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:40 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:40 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_tlfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:40 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_ttfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:40 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_d2d_flows.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:40 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 315  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:40 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT",
 MO = 1, NAME = HBO_HBSH
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT"

MW[1] = MI.1.1 + MI.2.1


MATRIX Stack Size = 344 bytes.
................................................................................


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:38 2016 
ID=
PAR Zones=267 M=1
  HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:37 2016 
ID=
PAR Zones=267 M=1
  HBO

Totals after Iteration 1 I loop:

	MI.02.001: 136,095   @J=I:  11,964
	MI.01.001: 264,074   @J=I:  60,919
	MW[1]    : 400,170   @J=I:  72,883
	MO.01.001: 400,172

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 316  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:40 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 317  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2810 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:37 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:26 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 318  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 117,677.504    @J=I:   2,087.8849
	MI.01.001:  58,627.3304   @J=I:     182.4905
	MI.01.002:   5,644.0448   @J=I:      17.5683
	MI.01.003:   1,036.022 
	MI.01.004:           --
	MI.01.005:   5,981.6028   @J=I:      66.9411
	MI.01.006:  59,537.7512   @J=I:     182.4905
	MI.01.007:   5,731.6909   @J=I:      17.5683
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   6,019.5579   @J=I:      66.9411
	MW[1]    : 117,677.504    @J=I:   2,087.8849
	MW[2]    :  36,737.1765   @J=I:     712.4033
	MW[3]    :  80,940.3275   @J=I:   1,375.4816
	MW[11]   :  58,627.3304   @J=I:     182.4905
	MW[12]   :   5,644.0448   @J=I:      17.5683
	MW[13]   :   1,036.022 
	MW[14]   :           --
	MW[15]   :   5,981.6028   @J=I:      66.9411
	MW[16]   :  59,537.7512   @J=I:     182.4905
	MW[17]   :   5,731.6909   @J=I:      17.5683
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   6,019.5579   @J=I:      66.9411
	MW[21]   : 103,182.7346   @J=I:   1,417.368 
	MW[22]   :   9,933.3873   @J=I:     136.4498
	MW[23]   :   3,192.1781
	MW[24]   :           --
	MW[25]   :   1,369.204    @J=I:     534.0671
	MO.01.001: 103,185.54  
	MO.01.002:   9,932.46  
	MO.01.003:   3,190.5   
	MO.01.005:   1,363.8   

Variable Values at end of Iteration 1 I loop:

    EDA: 103,182.7
    ESR:   9,933.4
    ELB:   3,192.2
    ENM:   1,369.2
    TRN:   3,192.2
    AUT: 113,116.1
    TOT: 117,677.5

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 319  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:40 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 320  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2814 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:40 2016 
ID=
PAR Zones=267 M=1
  HBO_HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:27 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 321  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 400,172.37     @J=I:  72,882.89  
	MI.01.001:  30,510.6272   @J=I:      83.9604
	MI.01.002:  31,527.969    @J=I:      86.76  
	MI.01.003:     209.6108
	MI.01.004:           --
	MI.01.005:   9,040.793    @J=I:      96.2797
	MI.01.006:  30,606.2983   @J=I:      83.9604
	MI.01.007:  31,626.8301   @J=I:      86.76  
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   9,055.8716   @J=I:      96.2797
	MW[1]    : 400,172.37     @J=I:  72,882.89  
	MW[2]    : 154,720.074    @J=I:  25,134.9396
	MW[3]    : 245,452.296    @J=I:  47,747.9504
	MW[11]   :  30,510.6272   @J=I:      83.9604
	MW[12]   :  31,527.969    @J=I:      86.76  
	MW[13]   :     209.6108
	MW[14]   :           --
	MW[15]   :   9,040.793    @J=I:      96.2797
	MW[16]   :  30,606.2983   @J=I:      83.9604
	MW[17]   :  31,626.8301   @J=I:      86.76  
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   9,055.8716   @J=I:      96.2797
	MW[21]   : 170,300.6869   @J=I:  22,842.9573
	MW[22]   : 175,979.1674   @J=I:  23,604.6294
	MW[23]   :   2,262.8104
	MW[24]   :           --
	MW[25]   :  51,629.7053   @J=I:  26,435.3033
	MO.01.001: 170,293.88  
	MO.01.002: 175,992.41  
	MO.01.003:   2,261.7   
	MO.01.005:  51,623.67  

Variable Values at end of Iteration 1 I loop:

    EDA: 170,300.7
    ESR: 175,979.2
    ELB:   2,262.8
    ENM:  51,629.7
    TRN:   2,262.8
    AUT: 346,279.9
    TOT: 400,172.4

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################
Page 322  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:41 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 323  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2810 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:39 2016 
ID=
PAR Zones=267 M=1
  NHB

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:28 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 324  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 315,086.909    @J=I:  73,280.8982
	MI.01.001:  35,013.749    @J=I:     118.4408
	MI.01.002:  32,744.69     @J=I:     110.7653
	MI.01.003:      98.328 
	MI.01.004:           --
	MI.01.005:   3,432.2329   @J=I:      37.7938
	MI.01.006:  35,063.1933   @J=I:     118.4408
	MI.01.007:  32,790.9301   @J=I:     110.7653
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   3,434.8765   @J=I:      37.7938
	MW[1]    : 315,086.909    @J=I:  73,280.8982
	MW[2]    : 124,091.0791   @J=I:  27,632.2328
	MW[3]    : 190,995.8299   @J=I:  45,648.6655
	MW[11]   :  35,013.749    @J=I:     118.4408
	MW[12]   :  32,744.69     @J=I:     110.7653
	MW[13]   :      98.328 
	MW[14]   :           --
	MW[15]   :   3,432.2329   @J=I:      37.7938
	MW[16]   :  35,063.1933   @J=I:     118.4408
	MW[17]   :  32,790.9301   @J=I:     110.7653
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   3,434.8765   @J=I:      37.7938
	MW[21]   : 154,740.421    @J=I:  32,443.8702
	MW[22]   : 144,712.4991   @J=I:  30,341.3517
	MW[23]   :     869.4864
	MW[24]   :           --
	MW[25]   :  14,764.5025   @J=I:  10,495.6763
	MO.01.001: 154,743.23  
	MO.01.002: 144,716.17  
	MO.01.003:     864.83  
	MO.01.005:  14,757.69  

Variable Values at end of Iteration 1 I loop:

    EDA: 154,740.421
    ESR: 144,712.499
    ELB:     869.486
    ENM:  14,764.503
    TRN:     869.486
    AUT: 299,452.92 
    TOT: 315,086.909

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 325  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:41 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 326  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2828 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:31 2016 
ID=
PAR Zones=267 M=1
  HBSC

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:18:29 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 327  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001:  7,669.51     @J=I:  1,022.54  
	MI.01.001: 35,013.749    @J=I:    118.4408
	MI.01.002: 32,744.69     @J=I:    110.7653
	MI.01.003:     98.328 
	MI.01.004:          --
	MI.01.005:  3,432.2329   @J=I:     37.7938
	MI.01.006: 35,063.1933   @J=I:    118.4408
	MI.01.007: 32,790.9301   @J=I:    110.7653
	MI.01.008:          --
	MI.01.009:          --
	MI.01.010:  3,434.8765   @J=I:     37.7938
	MW[1]    :  7,669.51     @J=I:  1,022.54  
	MW[2]    :  2,630.9412   @J=I:    327.4269
	MW[3]    :  5,038.5688   @J=I:    695.1131
	MW[11]   : 35,013.749    @J=I:    118.4408
	MW[12]   : 32,744.69     @J=I:    110.7653
	MW[13]   :     98.328 
	MW[14]   :          --
	MW[15]   :  3,432.2329   @J=I:     37.7938
	MW[16]   : 35,063.1933   @J=I:    118.4408
	MW[17]   : 32,790.9301   @J=I:    110.7653
	MW[18]   :          --
	MW[19]   :          --
	MW[20]   :  3,434.8765   @J=I:     37.7938
	MW[21]   :  3,761.6542   @J=I:    453.5079
	MW[22]   :  3,517.881    @J=I:    424.1184
	MW[23]   :     22.7091
	MW[24]   :          --
	MW[25]   :    367.2657   @J=I:    144.9137
	MO.01.001:  3,769.84  
	MO.01.002:  3,510.2   
	MO.01.003:     21.69  
	MO.01.005:    366.22  

Variable Values at end of Iteration 1 I loop:

    EDA: 3,761.6542
    ESR: 3,517.881 
    ELB:    22.7091
    ENM:   367.2657
    TRN:    22.7091
    AUT: 7,279.5352
    TOT: 7,669.51  

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_AM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:41 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_MD.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:42 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_PM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:42 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_NT.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:43 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\MC_Transit_Trips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:43 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:43 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\AM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:18:43 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:30
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:19:13 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\MD.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:19:13 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:19
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:19:32 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:19:32 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:17
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:19:49 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\NT.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:19:49 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:03
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Merge_Hwy_Assignments.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Fri Mar 18 15:19:52 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Hwy_eval.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Fri Mar 18 15:19:53 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PBHWY00B.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:19:53 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\PBHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:19:53 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\Output\PK_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\PK_HWYSKIM_3.MAT
M(100): COPY C:\projects\Roanoke\Base\Output\OP_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\OP_HWYSKIM_3.MATPage 426  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:19:54 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\pk_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\PK_CNG_HwySkim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1330 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\PK_CNG_HwySkim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Fri Mar 18 15:19:53 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 427  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,685,116.56   @J=I:     23,000,120.75
	MI.01.002: 22,402,477,360.07
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,894,734.56   @J=I:     23,000,798.75
	MW[1]    : 22,425,685,116.56   @J=I:     23,000,120.75
	MW[2]    : 22,402,477,360.07
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,894,734.56   @J=I:     23,000,798.75
	MW[11]   :        685,116.56   @J=I:            120.75
	MW[12]   :        477,360.07
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        830,534.56   @J=I:            788.75
	MO.01.001:        685,116.56
	MO.01.002:        477,360.07
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        830,534.56

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 428  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:19:54 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_CNG_HwySkim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1330 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\OP_CNG_HwySkim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Fri Mar 18 15:19:53 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 429  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,674,411.86   @J=I:     23,000,119.62
	MI.01.002: 22,402,469,284.8 
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,884,029.86   @J=I:     23,000,797.62
	MW[1]    : 22,425,674,411.86   @J=I:     23,000,119.62
	MW[2]    : 22,402,469,284.8 
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,884,029.86   @J=I:     23,000,797.62
	MW[11]   :        674,411.86   @J=I:            119.62
	MW[12]   :        469,284.8 
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        819,829.86   @J=I:            787.62
	MO.01.001:        674,411.86
	MO.01.002:        469,284.8 
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        819,829.86

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBW_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:19:54 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBO_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:19:55 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\NHB_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:19:56 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBSC_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:19:57 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\TDMAT00C.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:19:58 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\HBSC_distribution.PRN. 
DISTRIBUTION (v.08/05/2014 [6.1.1])  Fri Mar 18 15:19:58 2016
DISTRIBUTION ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_D2D_Flwos.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:19:59 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_noSchoolTrips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:19:59 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\PARAMS\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:19:59 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 493  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 494  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 495  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:19:54 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:19:54 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 496  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,257.5489   @J=I:         44.236 
	MI.02.DISTANCE:    477,360.07  
	MW[1]         :    -29,257.5489   @J=I:         44.236 
	MW[2]         :    469,703.95  
	MW[100]       :    230,110.4538   @J=I:      1,137.4359
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,692.0819
	MW[115]       :     -7,306.57  
	MW[116]       :              --
	MW[200]       :    117,677.504    @J=I:      1,940.6106
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 1,940.61061

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 497  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:19:59 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:19:59 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,462, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 498  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      1,940.6
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      1,940.6
	MW[1]      :    117,677.5   @J=I:      1,940.6
	MW[2]      :    117,677.5   @J=I:      1,940.6
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_1.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:19:59 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 499  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 500  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 501  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:19:54 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:19:54 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 502  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,257.5489   @J=I:         44.236 
	MI.02.DISTANCE:    477,360.07  
	MW[1]         :    -29,257.5489   @J=I:         44.236 
	MW[2]         :    469,703.95  
	MW[100]       :    237,346.1538   @J=I:      1,164.5359
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,692.0819
	MW[115]       :     -7,306.57  
	MW[116]       :      7,235.7      @J=I:         27.1   
	MW[200]       :    117,677.504    @J=I:      1,994.3819
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 1,994.38187

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 503  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:00 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:19:59 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,674, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 504  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      1,994.4
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      1,994.4
	MW[1]      :    117,677.5   @J=I:      1,994.4
	MW[2]      :    117,677.5   @J=I:      1,994.4
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_2.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:00 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 505  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 506  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 507  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:19:54 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:19:54 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 508  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,257.5489   @J=I:         44.236 
	MI.02.DISTANCE:    477,360.07  
	MW[1]         :    -29,257.5489   @J=I:         44.236 
	MW[2]         :    469,703.95  
	MW[100]       :    244,189.3638   @J=I:      1,190.1659
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,692.0819
	MW[115]       :     -7,306.57  
	MW[116]       :     14,078.91     @J=I:         52.73  
	MW[200]       :    117,677.504    @J=I:      2,031.777 
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,031.77698

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 509  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:00 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:20:00 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,791, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 510  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,031.8
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,031.8
	MW[1]      :    117,677.5   @J=I:      2,031.8
	MW[2]      :    117,677.5   @J=I:      2,031.8
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_3.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:00 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 511  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 512  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 513  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:19:54 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:19:54 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 514  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,257.5489   @J=I:         44.236 
	MI.02.DISTANCE:    477,360.07  
	MW[1]         :    -29,257.5489   @J=I:         44.236 
	MW[2]         :    469,703.95  
	MW[100]       :    250,915.0938   @J=I:      1,215.3559
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,692.0819
	MW[115]       :     -7,306.57  
	MW[116]       :     20,804.64     @J=I:         77.92  
	MW[200]       :    117,677.504    @J=I:      2,055.1728
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,055.17278

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 515  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:01 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:20:00 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,868, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 516  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,055.2
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,055.2
	MW[1]      :    117,677.5   @J=I:      2,055.2
	MW[2]      :    117,677.5   @J=I:      2,055.2
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_4.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:01 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 517  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 518  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 519  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:19:54 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:19:54 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 520  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,257.5489   @J=I:         44.236 
	MI.02.DISTANCE:    477,360.07  
	MW[1]         :    -29,257.5489   @J=I:         44.236 
	MW[2]         :    469,703.95  
	MW[100]       :    257,734.2738   @J=I:      1,240.8959
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,692.0819
	MW[115]       :     -7,306.57  
	MW[116]       :     27,623.82     @J=I:        103.46  
	MW[200]       :    117,677.504    @J=I:      2,068.739 
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,068.73898

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 521  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:01 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:20:01 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,898, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 522  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,068.7
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,068.7
	MW[1]      :    117,677.5   @J=I:      2,068.7
	MW[2]      :    117,677.5   @J=I:      2,068.7
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_5.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:01 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 523  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 524  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 525  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:19:54 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:19:54 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 526  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,257.5489   @J=I:         44.236 
	MI.02.DISTANCE:    477,360.07  
	MW[1]         :    -29,257.5489   @J=I:         44.236 
	MW[2]         :    469,703.95  
	MW[100]       :    264,588.1638   @J=I:      1,266.5659
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,692.0819
	MW[115]       :     -7,306.57  
	MW[116]       :     34,477.71     @J=I:        129.13  
	MW[200]       :    117,677.504    @J=I:      2,077.0614
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,077.06142

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 527  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:02 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:20:01 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,942, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 528  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,077.1
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,077.1
	MW[1]      :    117,677.5   @J=I:      2,077.1
	MW[2]      :    117,677.5   @J=I:      2,077.1
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_6.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:02 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 529  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 530  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 531  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:19:54 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:19:54 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 532  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,257.5489   @J=I:         44.236 
	MI.02.DISTANCE:    477,360.07  
	MW[1]         :    -29,257.5489   @J=I:         44.236 
	MW[2]         :    469,703.95  
	MW[100]       :    271,375.3038   @J=I:      1,291.9859
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,692.0819
	MW[115]       :     -7,306.57  
	MW[116]       :     41,264.85     @J=I:        154.55  
	MW[200]       :    117,677.504    @J=I:      2,082.229 
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,082.22897

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 533  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:02 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:20:02 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,947, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 534  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,082.2
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,082.2
	MW[1]      :    117,677.5   @J=I:      2,082.2
	MW[2]      :    117,677.5   @J=I:      2,082.2
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_7.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:02 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 535  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 536  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 537  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:19:54 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:19:54 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 538  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,257.5489   @J=I:         44.236 
	MI.02.DISTANCE:    477,360.07  
	MW[1]         :    -29,257.5489   @J=I:         44.236 
	MW[2]         :    469,703.95  
	MW[100]       :    278,111.7138   @J=I:      1,317.2159
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,692.0819
	MW[115]       :     -7,306.57  
	MW[116]       :     48,001.26     @J=I:        179.78  
	MW[200]       :    117,677.504    @J=I:      2,086.4906
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,086.49062

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 539  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:03 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:20:02 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,978, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 540  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,086.5
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,086.5
	MW[1]      :    117,677.5   @J=I:      2,086.5
	MW[2]      :    117,677.5   @J=I:      2,086.5
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_8.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:03 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 541  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 542  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 543  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:19:54 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:19:54 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 544  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,257.5489   @J=I:         44.236 
	MI.02.DISTANCE:    477,360.07  
	MW[1]         :    -29,257.5489   @J=I:         44.236 
	MW[2]         :    469,703.95  
	MW[100]       :    284,848.1238   @J=I:      1,342.4459
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,692.0819
	MW[115]       :     -7,306.57  
	MW[116]       :     54,737.67     @J=I:        205.01  
	MW[200]       :    117,677.504    @J=I:      2,087.3428
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,087.3428 

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 545  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:03 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:20:03 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,997, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 546  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,087.3
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,087.3
	MW[1]      :    117,677.5   @J=I:      2,087.3
	MW[2]      :    117,677.5   @J=I:      2,087.3
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_9.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:03 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 547  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 548  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 549  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:19:54 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:19:54 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 550  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,257.5489   @J=I:         44.236 
	MI.02.DISTANCE:    477,360.07  
	MW[1]         :    -29,257.5489   @J=I:         44.236 
	MW[2]         :    469,703.95  
	MW[100]       :    291,600.5538   @J=I:      1,367.7359
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,692.0819
	MW[115]       :     -7,306.57  
	MW[116]       :     61,490.1      @J=I:        230.3   
	MW[200]       :    117,677.504    @J=I:      2,088.7592
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,088.75923

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 551  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:04 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:20:03 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,988, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 552  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,088.8
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,088.8
	MW[1]      :    117,677.5   @J=I:      2,088.8
	MW[2]      :    117,677.5   @J=I:      2,088.8
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_10.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBO.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:04 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:04 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:04 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:05 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBSH.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:05 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:05 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:05 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:05 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_NHB.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:05 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:06 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:06 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:06 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_tlfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:06 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_ttfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:06 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_d2d_flows.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:06 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 597  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:06 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT",
 MO = 1, NAME = HBO_HBSH
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT"

MW[1] = MI.1.1 + MI.2.1


MATRIX Stack Size = 344 bytes.
................................................................................


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:20:05 2016 
ID=
PAR Zones=267 M=1
  HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:20:04 2016 
ID=
PAR Zones=267 M=1
  HBO

Totals after Iteration 1 I loop:

	MI.02.001: 136,095   @J=I:  11,961
	MI.01.001: 264,074   @J=I:  60,914
	MW[1]    : 400,170   @J=I:  72,875
	MO.01.001: 400,173

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 598  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:06 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 599  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2810 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:20:03 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:19:54 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 600  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 117,677.504    @J=I:   2,088.7592
	MI.01.001:  58,627.3704   @J=I:     182.4904
	MI.01.002:   5,644.0487   @J=I:      17.5683
	MI.01.003:   1,036.0388
	MI.01.004:           --
	MI.01.005:   5,981.542    @J=I:      66.9413
	MI.01.006:  59,537.8111   @J=I:     182.4904
	MI.01.007:   5,731.6967   @J=I:      17.5683
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   6,019.4922   @J=I:      66.9413
	MW[1]    : 117,677.504    @J=I:   2,088.7592
	MW[2]    :  36,745.4221   @J=I:     713.1528
	MW[3]    :  80,932.0819   @J=I:   1,375.6064
	MW[11]   :  58,627.3704   @J=I:     182.4904
	MW[12]   :   5,644.0487   @J=I:      17.5683
	MW[13]   :   1,036.0388
	MW[14]   :           --
	MW[15]   :   5,981.542    @J=I:      66.9413
	MW[16]   :  59,537.8111   @J=I:     182.4904
	MW[17]   :   5,731.6967   @J=I:      17.5683
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   6,019.4922   @J=I:      66.9413
	MW[21]   : 103,182.1644   @J=I:   1,417.9365
	MW[22]   :   9,933.3324   @J=I:     136.5045
	MW[23]   :   3,193.0842
	MW[24]   :           --
	MW[25]   :   1,368.9229   @J=I:     534.3182
	MO.01.001: 103,185.27  
	MO.01.002:   9,932.25  
	MO.01.003:   3,191.46  
	MO.01.005:   1,363.57  

Variable Values at end of Iteration 1 I loop:

    EDA: 103,182.2
    ESR:   9,933.3
    ELB:   3,193.1
    ENM:   1,368.9
    TRN:   3,193.1
    AUT: 113,115.5
    TOT: 117,677.5

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################
Page 601  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:07 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 602  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2814 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:20:06 2016 
ID=
PAR Zones=267 M=1
  HBO_HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:19:55 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 603  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 400,173.21     @J=I:  72,875.47  
	MI.01.001:  30,510.5151   @J=I:      83.9604
	MI.01.002:  31,527.8532   @J=I:      86.7599
	MI.01.003:     209.6493
	MI.01.004:           --
	MI.01.005:   9,040.9824   @J=I:      96.2797
	MI.01.006:  30,606.2025   @J=I:      83.9604
	MI.01.007:  31,626.7311   @J=I:      86.7599
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   9,056.0663   @J=I:      96.2797
	MW[1]    : 400,173.21     @J=I:  72,875.47  
	MW[2]    : 154,715.3881   @J=I:  25,134.8998
	MW[3]    : 245,457.8219   @J=I:  47,740.5702
	MW[11]   :  30,510.5151   @J=I:      83.9604
	MW[12]   :  31,527.8532   @J=I:      86.7599
	MW[13]   :     209.6493
	MW[14]   :           --
	MW[15]   :   9,040.9824   @J=I:      96.2797
	MW[16]   :  30,606.2025   @J=I:      83.9604
	MW[17]   :  31,626.7311   @J=I:      86.7599
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   9,056.0663   @J=I:      96.2797
	MW[21]   : 170,301.7497   @J=I:  22,840.5877
	MW[22]   : 175,980.2656   @J=I:  23,602.1808
	MW[23]   :   2,263.0958
	MW[24]   :           --
	MW[25]   :  51,628.0989   @J=I:  26,432.7014
	MO.01.001: 170,294.53  
	MO.01.002: 175,994.71  
	MO.01.003:   2,262.09  
	MO.01.005:  51,622.17  

Variable Values at end of Iteration 1 I loop:

    EDA: 170,301.7
    ESR: 175,980.3
    ELB:   2,263.1
    ENM:  51,628.1
    TRN:   2,263.1
    AUT: 346,282  
    TOT: 400,173.2

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 604  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:07 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 605  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2810 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:20:05 2016 
ID=
PAR Zones=267 M=1
  NHB

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:19:56 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 606  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 315,086.909    @J=I:  73,274.8596
	MI.01.001:  35,013.7174   @J=I:     118.4408
	MI.01.002:  32,744.6605   @J=I:     110.7653
	MI.01.003:      98.3491
	MI.01.004:           --
	MI.01.005:   3,432.273    @J=I:      37.7939
	MI.01.006:  35,063.1723   @J=I:     118.4408
	MI.01.007:  32,790.9105   @J=I:     110.7653
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   3,434.9172   @J=I:      37.7939
	MW[1]    : 315,086.909    @J=I:  73,274.8596
	MW[2]    : 124,088.1226   @J=I:  27,632.9475
	MW[3]    : 190,998.7864   @J=I:  45,641.912 
	MW[11]   :  35,013.7174   @J=I:     118.4408
	MW[12]   :  32,744.6605   @J=I:     110.7653
	MW[13]   :      98.3491
	MW[14]   :           --
	MW[15]   :   3,432.273    @J=I:      37.7939
	MW[16]   :  35,063.1723   @J=I:     118.4408
	MW[17]   :  32,790.9105   @J=I:     110.7653
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   3,434.9172   @J=I:      37.7939
	MW[21]   : 154,740.6275   @J=I:  32,441.1654
	MW[22]   : 144,712.6923   @J=I:  30,338.8223
	MW[23]   :     869.6064
	MW[24]   :           --
	MW[25]   :  14,763.9828   @J=I:  10,494.8719
	MO.01.001: 154,743.01  
	MO.01.002: 144,716.01  
	MO.01.003:     864.89  
	MO.01.005:  14,757.35  

Variable Values at end of Iteration 1 I loop:

    EDA: 154,740.628
    ESR: 144,712.692
    ELB:     869.606
    ENM:  14,763.983
    TRN:     869.606
    AUT: 299,453.32 
    TOT: 315,086.909

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 607  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:07 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 608  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2828 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:19:59 2016 
ID=
PAR Zones=267 M=1
  HBSC

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:19:57 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 609  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001:  7,669.68     @J=I:  1,022.89  
	MI.01.001: 35,013.7174   @J=I:    118.4408
	MI.01.002: 32,744.6605   @J=I:    110.7653
	MI.01.003:     98.3491
	MI.01.004:          --
	MI.01.005:  3,432.273    @J=I:     37.7939
	MI.01.006: 35,063.1723   @J=I:    118.4408
	MI.01.007: 32,790.9105   @J=I:    110.7653
	MI.01.008:          --
	MI.01.009:          --
	MI.01.010:  3,434.9172   @J=I:     37.7939
	MW[1]    :  7,669.68     @J=I:  1,022.89  
	MW[2]    :  2,630.8652   @J=I:    327.6935
	MW[3]    :  5,038.8148   @J=I:    695.1965
	MW[11]   : 35,013.7174   @J=I:    118.4408
	MW[12]   : 32,744.6605   @J=I:    110.7653
	MW[13]   :     98.3491
	MW[14]   :          --
	MW[15]   :  3,432.273    @J=I:     37.7939
	MW[16]   : 35,063.1723   @J=I:    118.4408
	MW[17]   : 32,790.9105   @J=I:    110.7653
	MW[18]   :          --
	MW[19]   :          --
	MW[20]   :  3,434.9172   @J=I:     37.7939
	MW[21]   :  3,761.669    @J=I:    453.6639
	MW[22]   :  3,517.8948   @J=I:    424.2643
	MW[23]   :     22.7026
	MW[24]   :          --
	MW[25]   :    367.4135   @J=I:    144.9618
	MO.01.001:  3,769.89  
	MO.01.002:  3,510.31  
	MO.01.003:     21.67  
	MO.01.005:    366.36  

Variable Values at end of Iteration 1 I loop:

    EDA: 3,761.669 
    ESR: 3,517.8948
    ELB:    22.7026
    ENM:   367.4135
    TRN:    22.7026
    AUT: 7,279.5639
    TOT: 7,669.68  

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_AM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:08 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_MD.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:08 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_PM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:08 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_NT.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:09 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\MC_Transit_Trips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:09 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:09 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\AM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:09 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:26
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:35 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\MD.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:36 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:18
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:54 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:20:55 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:16
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:11 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\NT.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:11 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:04
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Merge_Hwy_Assignments.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:15 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Hwy_eval.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:15 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PBHWY00B.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:15 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\PBHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:15 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################

M(100): COPY C:\projects\Roanoke\Base\Output\PK_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\PK_HWYSKIM_4.MAT
M(100): COPY C:\projects\Roanoke\Base\Output\OP_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\OP_HWYSKIM_4.MATPage 706  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:16 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\pk_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\PK_CNG_HwySkim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1330 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\PK_CNG_HwySkim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Fri Mar 18 15:21:15 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 707  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,685,106.08   @J=I:     23,000,120.74
	MI.01.002: 22,402,477,213.52
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,894,724.08   @J=I:     23,000,798.74
	MW[1]    : 22,425,685,106.08   @J=I:     23,000,120.74
	MW[2]    : 22,402,477,213.52
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,894,724.08   @J=I:     23,000,798.74
	MW[11]   :        685,106.08   @J=I:            120.74
	MW[12]   :        477,213.52
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        830,524.08   @J=I:            788.74
	MO.01.001:        685,106.08
	MO.01.002:        477,213.52
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        830,524.08

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 708  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:16 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_CNG_HwySkim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1330 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\OP_CNG_HwySkim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Fri Mar 18 15:21:15 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 709  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,674,403.6    @J=I:     23,000,119.62
	MI.01.002: 22,402,469,329.96
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,884,021.6    @J=I:     23,000,797.62
	MW[1]    : 22,425,674,403.6    @J=I:     23,000,119.62
	MW[2]    : 22,402,469,329.96
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,884,021.6    @J=I:     23,000,797.62
	MW[11]   :        674,403.6    @J=I:            119.62
	MW[12]   :        469,329.96
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        819,821.6    @J=I:            787.62
	MO.01.001:        674,403.6 
	MO.01.002:        469,329.96
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        819,821.6 

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBW_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:16 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBO_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:17 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\NHB_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:18 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBSC_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:19 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\TDMAT00C.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:20 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\HBSC_distribution.PRN. 
DISTRIBUTION (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:20 2016
DISTRIBUTION ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_D2D_Flwos.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:21 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_noSchoolTrips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:21 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\PARAMS\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:21 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 773  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 774  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 775  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:16 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:16 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 776  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,254.0811   @J=I:         44.2362
	MI.02.DISTANCE:    477,213.52  
	MW[1]         :    -29,254.0811   @J=I:         44.2362
	MW[2]         :    469,558.04  
	MW[100]       :    230,125.4049   @J=I:      1,137.436 
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,672.9723
	MW[115]       :     -7,314.92  
	MW[116]       :              --
	MW[200]       :    117,677.504    @J=I:      1,939.3757
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 1,939.37574

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 777  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:22 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:21 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,459, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 778  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      1,939.4
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      1,939.4
	MW[1]      :    117,677.5   @J=I:      1,939.4
	MW[2]      :    117,677.5   @J=I:      1,939.4
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_1.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:22 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 779  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 780  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 781  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:16 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:16 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 782  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,254.0811   @J=I:         44.2362
	MI.02.DISTANCE:    477,213.52  
	MW[1]         :    -29,254.0811   @J=I:         44.2362
	MW[2]         :    469,558.04  
	MW[100]       :    237,363.7749   @J=I:      1,164.546 
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,672.9723
	MW[115]       :     -7,314.92  
	MW[116]       :      7,238.37     @J=I:         27.11  
	MW[200]       :    117,677.504    @J=I:      1,993.6912
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 1,993.69122

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 783  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:22 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:22 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,654, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 784  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      1,993.7
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      1,993.7
	MW[1]      :    117,677.5   @J=I:      1,993.7
	MW[2]      :    117,677.5   @J=I:      1,993.7
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_2.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:22 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 785  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 786  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 787  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:16 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:16 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 788  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,254.0811   @J=I:         44.2362
	MI.02.DISTANCE:    477,213.52  
	MW[1]         :    -29,254.0811   @J=I:         44.2362
	MW[2]         :    469,558.04  
	MW[100]       :    244,220.3349   @J=I:      1,190.226 
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,672.9723
	MW[115]       :     -7,314.92  
	MW[116]       :     14,094.93     @J=I:         52.79  
	MW[200]       :    117,677.504    @J=I:      2,030.5487
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,030.54872

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 789  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:23 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:22 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,776, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 790  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,030.5
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,030.5
	MW[1]      :    117,677.5   @J=I:      2,030.5
	MW[2]      :    117,677.5   @J=I:      2,030.5
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_3.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:23 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 791  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 792  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 793  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:16 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:16 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 794  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,254.0811   @J=I:         44.2362
	MI.02.DISTANCE:    477,213.52  
	MW[1]         :    -29,254.0811   @J=I:         44.2362
	MW[2]         :    469,558.04  
	MW[100]       :    250,956.7449   @J=I:      1,215.456 
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,672.9723
	MW[115]       :     -7,314.92  
	MW[116]       :     20,831.34     @J=I:         78.02  
	MW[200]       :    117,677.504    @J=I:      2,054.0174
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,054.01743

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 795  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:23 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:23 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,849, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 796  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,054  
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,054  
	MW[1]      :    117,677.5   @J=I:      2,054  
	MW[2]      :    117,677.5   @J=I:      2,054  
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_4.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:23 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 797  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 798  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 799  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:16 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:16 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 800  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,254.0811   @J=I:         44.2362
	MI.02.DISTANCE:    477,213.52  
	MW[1]         :    -29,254.0811   @J=I:         44.2362
	MW[2]         :    469,558.04  
	MW[100]       :    257,773.2549   @J=I:      1,240.986 
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,672.9723
	MW[115]       :     -7,314.92  
	MW[116]       :     27,647.85     @J=I:        103.55  
	MW[200]       :    117,677.504    @J=I:      2,067.7899
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,067.78993

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 801  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:24 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:23 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,886, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 802  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,067.8
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,067.8
	MW[1]      :    117,677.5   @J=I:      2,067.8
	MW[2]      :    117,677.5   @J=I:      2,067.8
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_5.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:24 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 803  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 804  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 805  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:16 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:16 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 806  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,254.0811   @J=I:         44.2362
	MI.02.DISTANCE:    477,213.52  
	MW[1]         :    -29,254.0811   @J=I:         44.2362
	MW[2]         :    469,558.04  
	MW[100]       :    264,624.4749   @J=I:      1,266.646 
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,672.9723
	MW[115]       :     -7,314.92  
	MW[116]       :     34,499.07     @J=I:        129.21  
	MW[200]       :    117,677.504    @J=I:      2,076.5121
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,076.51211

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 807  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:24 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:24 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,912, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 808  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,076.5
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,076.5
	MW[1]      :    117,677.5   @J=I:      2,076.5
	MW[2]      :    117,677.5   @J=I:      2,076.5
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_6.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:24 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 809  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 810  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 811  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:16 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:16 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 812  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,254.0811   @J=I:         44.2362
	MI.02.DISTANCE:    477,213.52  
	MW[1]         :    -29,254.0811   @J=I:         44.2362
	MW[2]         :    469,558.04  
	MW[100]       :    271,400.9349   @J=I:      1,292.026 
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,672.9723
	MW[115]       :     -7,314.92  
	MW[116]       :     41,275.53     @J=I:        154.59  
	MW[200]       :    117,677.504    @J=I:      2,082.0684
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,082.0684 

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 813  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:25 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:24 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,953, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 814  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,082.1
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,082.1
	MW[1]      :    117,677.5   @J=I:      2,082.1
	MW[2]      :    117,677.5   @J=I:      2,082.1
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_7.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:25 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 815  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 816  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 817  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:16 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:16 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 818  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,254.0811   @J=I:         44.2362
	MI.02.DISTANCE:    477,213.52  
	MW[1]         :    -29,254.0811   @J=I:         44.2362
	MW[2]         :    469,558.04  
	MW[100]       :    278,140.0149   @J=I:      1,317.266 
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,672.9723
	MW[115]       :     -7,314.92  
	MW[116]       :     48,014.61     @J=I:        179.83  
	MW[200]       :    117,677.504    @J=I:      2,085.9576
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,085.9576 

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 819  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:25 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:25 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,991, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 820  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,086  
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,086  
	MW[1]      :    117,677.5   @J=I:      2,086  
	MW[2]      :    117,677.5   @J=I:      2,086  
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_8.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:25 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 821  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 822  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 823  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:16 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:16 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 824  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,254.0811   @J=I:         44.2362
	MI.02.DISTANCE:    477,213.52  
	MW[1]         :    -29,254.0811   @J=I:         44.2362
	MW[2]         :    469,558.04  
	MW[100]       :    284,881.7649   @J=I:      1,342.516 
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,672.9723
	MW[115]       :     -7,314.92  
	MW[116]       :     54,756.36     @J=I:        205.08  
	MW[200]       :    117,677.504    @J=I:      2,086.3835
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,086.38353

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 825  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:26 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:25 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,985, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 826  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,086.4
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,086.4
	MW[1]      :    117,677.5   @J=I:      2,086.4
	MW[2]      :    117,677.5   @J=I:      2,086.4
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_9.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:26 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 827  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 828  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 829  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:16 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:16 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 830  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -29,254.0811   @J=I:         44.2362
	MI.02.DISTANCE:    477,213.52  
	MW[1]         :    -29,254.0811   @J=I:         44.2362
	MW[2]         :    469,558.04  
	MW[100]       :    291,618.1749   @J=I:      1,367.746 
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,672.9723
	MW[115]       :     -7,314.92  
	MW[116]       :     61,492.77     @J=I:        230.31  
	MW[200]       :    117,677.504    @J=I:      2,088.1355
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,088.13551

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 831  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:26 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:26 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,995, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 832  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,088.1
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,088.1
	MW[1]      :    117,677.5   @J=I:      2,088.1
	MW[2]      :    117,677.5   @J=I:      2,088.1
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_10.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBO.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:26 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:27 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:27 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:27 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBSH.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:27 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:27 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:27 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:28 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_NHB.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:28 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:28 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:28 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:28 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_tlfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:28 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_ttfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:28 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_d2d_flows.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:28 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 877  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:28 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT",
 MO = 1, NAME = HBO_HBSH
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT"

MW[1] = MI.1.1 + MI.2.1


MATRIX Stack Size = 344 bytes.
................................................................................


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:27 2016 
ID=
PAR Zones=267 M=1
  HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:26 2016 
ID=
PAR Zones=267 M=1
  HBO

Totals after Iteration 1 I loop:

	MI.02.001: 136,095   @J=I:  11,962
	MI.01.001: 264,074   @J=I:  60,921
	MW[1]    : 400,170   @J=I:  72,883
	MO.01.001: 400,174

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################
Page 878  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:29 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 879  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2810 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:26 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:16 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 880  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 117,677.504    @J=I:   2,088.1355
	MI.01.001:  58,627.3434   @J=I:     182.4905
	MI.01.002:   5,644.0461   @J=I:      17.5683
	MI.01.003:   1,035.9358
	MI.01.004:           --
	MI.01.005:   5,981.6747   @J=I:      66.9412
	MI.01.006:  59,537.6802   @J=I:     182.4905
	MI.01.007:   5,731.6841   @J=I:      17.5683
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   6,019.6358   @J=I:      66.9412
	MW[1]    : 117,677.504    @J=I:   2,088.1355
	MW[2]    :  36,743.9331   @J=I:     712.9442
	MW[3]    :  80,933.5709   @J=I:   1,375.1913
	MW[11]   :  58,627.3434   @J=I:     182.4905
	MW[12]   :   5,644.0461   @J=I:      17.5683
	MW[13]   :   1,035.9358
	MW[14]   :           --
	MW[15]   :   5,981.6747   @J=I:      66.9412
	MW[16]   :  59,537.6802   @J=I:     182.4905
	MW[17]   :   5,731.6841   @J=I:      17.5683
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   6,019.6358   @J=I:      66.9412
	MW[21]   : 103,181.3287   @J=I:   1,417.4928
	MW[22]   :   9,933.252    @J=I:     136.4618
	MW[23]   :   3,193.3378
	MW[24]   :           --
	MW[25]   :   1,369.5855   @J=I:     534.1809
	MO.01.001: 103,184.1   
	MO.01.002:   9,932.26  
	MO.01.003:   3,191.63  
	MO.01.005:   1,364.09  

Variable Values at end of Iteration 1 I loop:

    EDA: 103,181.3
    ESR:   9,933.3
    ELB:   3,193.3
    ENM:   1,369.6
    TRN:   3,193.3
    AUT: 113,114.6
    TOT: 117,677.5

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 881  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:29 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 882  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2814 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:28 2016 
ID=
PAR Zones=267 M=1
  HBO_HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:17 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 883  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 400,173.55     @J=I:  72,882.79  
	MI.01.001:  30,510.5408   @J=I:      83.9604
	MI.01.002:  31,527.8797   @J=I:      86.7599
	MI.01.003:     209.639 
	MI.01.004:           --
	MI.01.005:   9,040.9405   @J=I:      96.2797
	MI.01.006:  30,606.2236   @J=I:      83.9604
	MI.01.007:  31,626.7529   @J=I:      86.7599
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   9,056.0235   @J=I:      96.2797
	MW[1]    : 400,173.55     @J=I:  72,882.79  
	MW[2]    : 154,726.0761   @J=I:  25,138.637 
	MW[3]    : 245,447.4739   @J=I:  47,744.153 
	MW[11]   :  30,510.5408   @J=I:      83.9604
	MW[12]   :  31,527.8797   @J=I:      86.7599
	MW[13]   :     209.639 
	MW[14]   :           --
	MW[15]   :   9,040.9405   @J=I:      96.2797
	MW[16]   :  30,606.2236   @J=I:      83.9604
	MW[17]   :  31,626.7529   @J=I:      86.7599
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   9,056.0235   @J=I:      96.2797
	MW[21]   : 170,299.5486   @J=I:  22,842.903 
	MW[22]   : 175,977.9911   @J=I:  23,604.5733
	MW[23]   :   2,263.2206
	MW[24]   :           --
	MW[25]   :  51,632.7897   @J=I:  26,435.3137
	MO.01.001: 170,292.52  
	MO.01.002: 175,991.82  
	MO.01.003:   2,262.31  
	MO.01.005:  51,626.74  

Variable Values at end of Iteration 1 I loop:

    EDA: 170,299.5
    ESR: 175,978  
    ELB:   2,263.2
    ENM:  51,632.8
    TRN:   2,263.2
    AUT: 346,277.5
    TOT: 400,173.6

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 884  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:29 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 885  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2810 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:28 2016 
ID=
PAR Zones=267 M=1
  NHB

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:18 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 886  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 315,086.909    @J=I:  73,281.6108
	MI.01.001:  35,013.7237   @J=I:     118.4408
	MI.01.002:  32,744.6664   @J=I:     110.7653
	MI.01.003:      98.3432
	MI.01.004:           --
	MI.01.005:   3,432.2667   @J=I:      37.7939
	MI.01.006:  35,063.1756   @J=I:     118.4408
	MI.01.007:  32,790.9136   @J=I:     110.7653
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   3,434.9108   @J=I:      37.7939
	MW[1]    : 315,086.909    @J=I:  73,281.6108
	MW[2]    : 124,094.488    @J=I:  27,636.2748
	MW[3]    : 190,992.421    @J=I:  45,645.3359
	MW[11]   :  35,013.7237   @J=I:     118.4408
	MW[12]   :  32,744.6664   @J=I:     110.7653
	MW[13]   :      98.3432
	MW[14]   :           --
	MW[15]   :   3,432.2667   @J=I:      37.7939
	MW[16]   :  35,063.1756   @J=I:     118.4408
	MW[17]   :  32,790.9136   @J=I:     110.7653
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   3,434.9108   @J=I:      37.7939
	MW[21]   : 154,739.7118   @J=I:  32,444.1754
	MW[22]   : 144,711.8359   @J=I:  30,341.6371
	MW[23]   :     869.6588
	MW[24]   :           --
	MW[25]   :  14,765.7025   @J=I:  10,495.7983
	MO.01.001: 154,742.08  
	MO.01.002: 144,714.87  
	MO.01.003:     864.99  
	MO.01.005:  14,759.1   

Variable Values at end of Iteration 1 I loop:

    EDA: 154,739.712
    ESR: 144,711.836
    ELB:     869.659
    ENM:  14,765.702
    TRN:     869.659
    AUT: 299,451.548
    TOT: 315,086.909

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################
Page 887  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:30 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 888  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2828 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent_2012.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:21 2016 
ID=
PAR Zones=267 M=1
  HBSC

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 18 15:21:19 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 889  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001:  7,669.7      @J=I:  1,022.85  
	MI.01.001: 35,013.7237   @J=I:    118.4408
	MI.01.002: 32,744.6664   @J=I:    110.7653
	MI.01.003:     98.3432
	MI.01.004:          --
	MI.01.005:  3,432.2667   @J=I:     37.7939
	MI.01.006: 35,063.1756   @J=I:    118.4408
	MI.01.007: 32,790.9136   @J=I:    110.7653
	MI.01.008:          --
	MI.01.009:          --
	MI.01.010:  3,434.9108   @J=I:     37.7939
	MW[1]    :  7,669.7      @J=I:  1,022.85  
	MW[2]    :  2,630.9133   @J=I:    327.6664
	MW[3]    :  5,038.7867   @J=I:    695.1836
	MW[11]   : 35,013.7237   @J=I:    118.4408
	MW[12]   : 32,744.6664   @J=I:    110.7653
	MW[13]   :     98.3432
	MW[14]   :          --
	MW[15]   :  3,432.2667   @J=I:     37.7939
	MW[16]   : 35,063.1756   @J=I:    118.4408
	MW[17]   : 32,790.9136   @J=I:    110.7653
	MW[18]   :          --
	MW[19]   :          --
	MW[20]   :  3,434.9108   @J=I:     37.7939
	MW[21]   :  3,761.6776   @J=I:    453.6461
	MW[22]   :  3,517.9028   @J=I:    424.2476
	MW[23]   :     22.7037
	MW[24]   :          --
	MW[25]   :    367.4159   @J=I:    144.9563
	MO.01.001:  3,769.95  
	MO.01.002:  3,510.42  
	MO.01.003:     21.68  
	MO.01.005:    366.32  

Variable Values at end of Iteration 1 I loop:

    EDA: 3,761.6776
    ESR: 3,517.9028
    ELB:    22.7037
    ENM:   367.4159
    TRN:    22.7037
    AUT: 7,279.5804
    TOT: 7,669.7   

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_AM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:30 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_MD.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:30 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_PM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:31 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_NT.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:31 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\MC_Transit_Trips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:31 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:31 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\AM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:21:32 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:29
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:22:02 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\MD.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:22:02 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:18
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:22:20 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:22:21 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:20
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:22:41 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\NT.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:22:41 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:03
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Merge_Hwy_Assignments.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Fri Mar 18 15:22:44 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Hwy_eval.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Fri Mar 18 15:22:45 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PBHWY00B.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:22:45 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\PBHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Fri Mar 18 15:22:45 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################

M(100): COPY C:\projects\Roanoke\Base\Output\PK_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\PK_HWYSKIM_5.MAT
M(100): COPY C:\projects\Roanoke\Base\Output\OP_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\OP_HWYSKIM_5.MAT

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\Trn_Assignment_PK.PRN. 
PUBLIC TRANSPORT (v.08/05/2014 [6.1.1])  Fri Mar 18 15:22:46 2016
PUBLIC TRANSPORT ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\Trn_Assignment_OP.PRN. 
PUBLIC TRANSPORT (v.08/05/2014 [6.1.1])  Fri Mar 18 15:22:46 2016
PUBLIC TRANSPORT ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################


--------------------------------------------------------------------------------

SYS "COPY "C:\projects\Roanoke\CUBE\*.PRN" "C:\projects\Roanoke\Base\OUTPUT\LOGS\*.PRN""
C:\projects\Roanoke\CUBE\ASHWY00A.PRN
C:\projects\Roanoke\CUBE\CVMAT00B.PRN
C:\projects\Roanoke\CUBE\PBHWY00A.PRN
C:\projects\Roanoke\CUBE\Roanoke Area MPO Model_0000.PRN
        4 file(s) copied.

SYS ReturnCode = 0

--------------------------------------------------------------------------------

--------------------------------------------------------------------------------

SYS "DEL "C:\projects\Roanoke\CUBE\*.PRN""
C:\projects\Roanoke\CUBE\Roanoke Area MPO Model_0000.PRN

SYS ReturnCode = 0

--------------------------------------------------------------------------------

VOYAGER  ReturnCode = 1  Elapsed Time = 00:08:25