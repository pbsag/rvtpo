Page 1  (VOYAGER PILOT) 
Parsons Brinckerhoff
------------------------
PILOT (v.08/05/2014 [6.1.1]) Sun Mar 27 18:50:20 2016

Args: C:\Users\SARVEP~1\AppData\Local\Temp\Cit5E46.tmp -SC:\PROJECTS\ROANOKE\CUBE\ -RC:\projects\Roanoke\Cube\Roanoke Area MPO Model_0000.PRN -PH:58 -PW:80 -I -P"Roan"
Input:   C:\Users\SARVEP~1\AppData\Local\Temp\Cit5E46.tmp

SYS=(del C:\projects\Roanoke\CUBE\*.prn)
SYS=(del C:\projects\Roanoke\CUBE\*.bak)
SYS=(del C:\projects\Roanoke\CUBE\*.0??)
SYS=(del C:\projects\Roanoke\CUBE\trc*.s)
SYS=(IF NOT EXIST "C:\projects\Roanoke\Base\Output" MKDIR "C:\projects\Roanoke\Base\Output")
SYS=(IF NOT EXIST "C:\projects\Roanoke\Base\OUTPUT" MKDIR "C:\projects\Roanoke\Base\OUTPUT")
SYS=(IF NOT EXIST "C:\projects\Roanoke\Base\OUTPUT\LOGS" MKDIR "C:\projects\Roanoke\Base\OUTPUT\LOGS")
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\scenario.properties"
 print list = 'About the scenario'    printo = 1
 print list = '-----------------------------------'             printo = 1
 print list = 'SCENARIO_FULLNAME  = ', 'Base'    printo = 1
 print list = 'SCENARIO_SHORTNAME = ', 'Base'   printo = 1
 print list = 'SCENARIO_CODE      = ', '0000'        printo = 1
 print list = 'SCENARIO_DIR       = ', 'C:\projects\Roanoke\Base'         printo = 1
 print list = 'CATALOG_DIR        = ', 'C:\projects\Roanoke'          printo = 1
 print list = 'Alternative        = ', 'A'          printo = 1
 print list = 'Description        = ', 'Year 2012 Calibration Scenario'          printo = 1
 print list = 'Year               = ', '2012'                 printo = 1
 print list = '\n \nModel settings'    printo = 1
 print list = '-----------------------------------'             printo = 1
 print list = 'Total-Zones        = ', '267'          printo = 1
 print list = 'ZONESA             = ', '264'               printo = 1
 print list = 'Internal-Zones     = ', '206'       printo = 1
 print list = 'MAXWLKACCLNKS      = ', '5'        printo = 1
 print list = 'NODEMIN            = ', '1000'              printo = 1
 print list = 'Radius             = ', '1.5'               printo = 1
 print list = 'AVGWLKSPD          = ', '2.5'            printo = 1
 print list = 'UNIT               = ', '2'                 printo = 1
 print list = 'WALKACC            = ', '0.6'              printo = 1
 print list = '\n \nDebug and select link settings'             printo = 1
 print list = '-----------------------------------'             printo = 1
 print list = 'DebugDC            = ', '1'              printo = 1
 print list = 'FromNode           = ', '179'             printo = 1
 print list = 'ToNode             = ', '200'               printo = 1
 print list = 'SelOrigin          = ', '1'            printo = 1
 print list = 'SelDest            = ', '159'              printo = 1
 print list = 'SelectLink         = ', 'L=4561-4556'           printo = 1
RUN PGM=NETWORK,2931 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\AT_1.PRN" MSG='OUTPUT LINK AND ZONE DATA'
RUN PGM=MATRIX,4417 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\AT_2.PRN" MSG='FIND THE CLOSEST ZONE TO EACH LINK'
RUN PGM=NETWORK,5708 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\AT_3.PRN" MSG='INSERT LINK DATA TO NETWORK'
RUN PGM=NETWORK,6927 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\AT_4.PRN" MSG='ADD LAND USE DATA TO ZONES'
RUN PGM=NETWORK,8069 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\AT-5.PRN" MSG='DETERMINE AREA TYPE FROM LAND USE DENSITY AND PROXIMITY'
RUN PGM=NETWORK,11503 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\AT_6.PRN" MSG='INSERT LINK AREA TYPE ON THE NETWORK'
RUN PGM=MATRIX,12784 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\AT_7.PRN" MSG='OUTPUT AREA TYPE AS DBF FOR LATER USE'
Rexe = 'C:\projects\Roanoke\R\R-3.2.2\bin\Rscript.exe'
Rscript = 'C:\projects\Roanoke\R\calculate_capacities.R'
link_file = 'C:\projects\Roanoke\Base\Output\link_atype2012A.DBF'
output_file = 'C:\projects\Roanoke\Base\Output\link_capacities2012A.DBF'
PRINT LIST= Rexe ' ' Rscript ' ' link_file ' ' output_file,Page 2  (VOYAGER PILOT) 
Parsons Brinckerhoff
------------------------
 FILE = "C:\projects\Roanoke\CUBE\LINK_CALC.BAT"
SYS=(C:\projects\Roanoke\CUBE\LINK_CALC.BAT)
RUN PGM=NETWORK,14979 MSG='Attach capacity and FFS to network'
RUN PGM=HIGHWAY,17552 PRNFILE="C:\projects\Roanoke\Base\Output\Logs\FreeFlowSpeeds.PRN" MSG='Build Initial Skims'
SYS=(COPY C:\projects\Roanoke\Base\Output\IMPED11.MAT C:\projects\Roanoke\Base\OUTPUT\PK_FreeFlow_Skim.MAT)
SYS=(COPY C:\projects\Roanoke\Base\Output\IMPED11.MAT C:\projects\Roanoke\Base\OUTPUT\OP_FreeFlow_Skim.MAT)
Rexe = 'C:\projects\Roanoke\R\R-3.2.2\bin\Rscript.exe'
Rscript = 'C:\projects\Roanoke\R\classification.R'
input_se_file = 'C:\projects\Roanoke\Base\Input\se.dbf'
lookup_dir = 'C:\projects\Roanoke\Params\classification'
output_file = 'C:\projects\Roanoke\Base\Output\se_classified_2012A.dbf'
PRINT LIST= Rexe ' ' Rscript ' ' input_se_file ' ' lookup_dir ' ' output_file,
 FILE = "C:\projects\Roanoke\CUBE\CLASSIFICATION.BAT"
SYS=(C:\projects\Roanoke\CUBE\CLASSIFICATION.BAT)
RUN PGM=GENERATION,21000 MSG='Household Trip Production'
RUN PGM=NETWORK,28109 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\TransitSpeeds.PRN" MSG='Transit Speeds'
RUN PGM='PUBLIC TRANSPORT',31753 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\BuildWalkAccessConenctors.PRN" MSG='Build Walk Access Connectors'
RUN PGM=MATRIX,34048 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\WalkAccess_ByMode.PRN" MSG='Subdivide Connectors into Separate Files by Mode'
RUN PGM='PUBLIC TRANSPORT',36049 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\Trn_PK_Skims.PRN" MSG='PK-Walk Access Paths / Skims'
RUN PGM='PUBLIC TRANSPORT',39900 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\Trn_OP_Skims.PRN" MSG='OP-Walk Access Paths / Skims'
RUN PGM=FRATAR,43682 MSG='Future year EE Table'
RUN PGM=MATRIX,44547
RUN PGM=MATRIX,45250 MSG='Process Highway Skims'
RUN PGM=GENERATION,46358 MSG='IEEI_TripGen'
RUN PGM=MATRIX,47758 MSG='NR-NHB Model'
RUN PGM=DISTRIBUTION,48406 MSG='IEEI_TripDist'
RUN PGM=MATRIX,49713
RUN PGM=MATRIX,51325 MSG='EE TOD'
RUN PGM=GENERATION,52493 MSG='CV_TripGen'
RUN PGM=DISTRIBUTION,53834
RUN PGM=MATRIX,55955
RUN PGM=MATRIX,57406 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\CV_TLFD.PRN" MSG='Trip Length Frequency'
LOOP FeedBack_ITER = 1, 5, 1
IF (FeedBack_ITER=1)
FB_ITER = 1
pk_hwy_skim = 'PK_FreeFlow_Skim.MAT'
OP_hwy_skim = 'OP_FreeFlow_Skim.MAT'
ELSE
pk_hwy_skim = 'PK_CNG_HwySkim.MAT'
OP_hwy_skim = 'OP_CNG_HwySkim.MAT'
ENDIF
RUN PGM=MATRIX,60881 MSG='Process Highway Skims'
RUN PGM=MATRIX,61947 MSG='Process Highway Skims'
  LOOP PURPOSE = 1, 4, 1
IF (PURPOSE=1) ; HBW Purpose
PURP='HBW'
PURPNO=3
PRK='LONGPARK'
hwySkim = 'pk_Hwyskim.MAT'
busSkim = 'pk_TSKIMBus.MAT'
premSkim = 'PK_TSKIMPrem.MAT'
ELSEIF (PURPOSE=2) ; HBO Purpose
PURP='HBO'
PURPNO=4Page 3  (VOYAGER PILOT) 
Parsons Brinckerhoff
------------------------
PRK='LONGPARK'
hwySkim = 'op_Hwyskim.MAT'
busSkim = 'op_TSKIMBus.MAT'
premSkim = 'op_TSKIMPrem.MAT'
ELSEIF (PURPOSE=3) ; NHB Purpose
PURP='NHB'
PURPNO=5
PRK='LONGPARK'
hwySkim = 'op_Hwyskim.MAT'
busSkim = 'op_TSKIMBus.MAT'
premSkim = 'op_TSKIMPrem.MAT'
ELSEIF (PURPOSE=4) ; HBSC Purpose
PURP='HBSC'
PURPNO=5
PRK='LONGPARK'
hwySkim = 'op_Hwyskim.MAT'
busSkim = 'op_TSKIMBus.MAT'
premSkim = 'op_TSKIMPrem.MAT'
ENDIF
RUN PGM=MATRIX,63897 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\@PURP@_logsum.PRN" MSG='Mode Choice Logsums and Probabilities'
  ENDLOOP
RUN PGM=MATRIX,76323 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\TDMAT00C.PRN" MSG='HBSC FF'
RUN PGM=DISTRIBUTION,77040 PRNFILE="C:\projects\Roanoke\Base\Output\Logs\HBSC_distribution.PRN" MSG='Gravity Model - HBSC'
RUN PGM=MATRIX,78485 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_D2D_Flwos.PRN" MSG='HBSC District - to - District Flows'
RUN PGM=MATRIX,79116 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_noSchoolTrips.PRN" MSG='HBSC - no sch bus trips'
SYS=(COPY C:\projects\Roanoke\PARAMS\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf)
  LOOP Iteration = 1, 10, 1
RUN PGM=MATRIX,79798 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN" MSG='HBW Apply Destination Choice Model'
RUN PGM=MATRIX,88734 MSG='Shadow Price'
SYS=(COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_@ITERATION@.dbf)
  ENDLOOP
  LOOP PURPOSE = 2, 4, 1
IF (PURPOSE=1) ; HBW PK
PURP='HBW'
MCLS_MAT = 'HBW'
PERIOD='PK'
PURPNO=1
MARKETS=1
isHBW=' '
noHBW=';'
isNHB=';'
noNHB=' '
PRINT LIST="Trip Distribution Loop Number = 1 of 4 HBW", printo=0
ELSEIF (PURPOSE=2) ; HBO
PURP='HBO'
MCLS_MAT = 'HBO'
PERIOD='PK'
PURPNO=2
MARKETS=1
isHBW=';'
noHBW=' '
isNHB=';'
noNHB=' '
PRINT LIST="Trip Distribution Loop Number = 2 of 4 HBO ", printo=0Page 4  (VOYAGER PILOT) 
Parsons Brinckerhoff
------------------------
ELSEIF (PURPOSE=3) ; HBSH
PURP='HBSH'
MCLS_MAT = 'HBO'
PERIOD='PK'
PURPNO=3
MARKETS=1
isHBW=';'
noHBW=' '
isNHB=';'
noNHB=' '
PRINT LIST="Trip Distribution Loop Number = 3 of 4 HBSH", printo=0
ELSEIF (PURPOSE=4) ; NHBW
PURP='NHB'
MCLS_MAT = 'NHB'
PERIOD='PK'
PURPNO=4
MARKETS=1
isHBW=';'
noHBW=' '
isNHB=' '
noNHB=';'
PRINT LIST="Trip Distribution Loop Number = 4 of 4 NHB ", printo=0
ENDIF
RUN PGM=MATRIX,90673 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_@PURP@.PRN" MSG='Apply Destination Choice Model'
RUN PGM=MATRIX,99517 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN" MSG='Non-Work Trip Length Frequency'
RUN PGM=MATRIX,100991 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN" MSG='Non-Work Trip Time Frequency'
RUN PGM=MATRIX,102433 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN" MSG='District - to - District Flows'
  ENDLOOP
RUN PGM=MATRIX,103058 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\work_tlfd_msg.PRN" MSG='Work Trip Length Frequency'
RUN PGM=MATRIX,104519 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\work_ttfd_msg.PRN" MSG='Work Trip Time Frequency'
RUN PGM=MATRIX,105947 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\work_d2d_flows.PRN" MSG='HBW District - to - District Flows'
RUN PGM=MATRIX,106603 MSG='HBO + HBSH'
  LOOP PURPOSE = 1, 4, 1
IF (PURPOSE=1) ; HBW Purpose
PURP='HBW'
PURPNAME = 'HBW'
PURPNO=3
PRK='LONGPARK'
ELSEIF (PURPOSE=2) ; HBO Purpose
PURP='HBO'
PURPNAME = 'HBO_HBSH'
PURPNO=4
PRK='LONGPARK'
ELSEIF (PURPOSE=3) ; NHB Purpose
PURP='NHB'
PURPNAME='NHB'
PURPNO=5
PRK='LONGPARK'
ELSEIF (PURPOSE=4) ; SCH Purpose
PURP='HBSC'
PURPNAME='HBSC'
PURPNO=6
PRK='LONGPARK'
ENDIFPage 5  (VOYAGER PILOT) 
Parsons Brinckerhoff
------------------------
RUN PGM=MATRIX,107710
  ENDLOOP
  LOOP PER = 1, 4, 1
IF (PER=1) ; AM
PERIOD_COL=3
PERIOD_NAME = 'AM'
ELSEIF (PER=2) ; MD
PERIOD_COL=4
PERIOD_NAME = 'MD'
ELSEIF (PER=3) ; PM
PERIOD_COL=6
PERIOD_NAME = 'PM'
ELSEIF (PER=4) ; NT
PERIOD_COL=5
PERIOD_NAME = 'NT'
ENDIF
RUN PGM=MATRIX,110900 PRNFILE="C:\projects\Roanoke\Base\Output\Logs\TOD_Model_@PERIOD_NAME@.PRN" MSG='Convert PA Trips to OD Trips'
  ENDLOOP
RUN PGM=MATRIX,113084 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\MC_Transit_Trips.PRN" MSG='Transit Trips'
  LOOP PER = 1, 4, 1
IF (PER=1) ; AM
PERIOD_COL=3
PERIOD_NAME = 'AM'
ELSEIF (PER=2) ; MD
PERIOD_COL=4
PERIOD_NAME = 'MD'
ELSEIF (PER=3) ; PM
PERIOD_COL=5
PERIOD_NAME = 'PM'
ELSEIF (PER=4) ; NT
PERIOD_COL=6
PERIOD_NAME = 'NT'
ENDIF
RUN PGM=HIGHWAY,114476 PRNFILE="C:\projects\ROANOKE\CUBE\ASHWY00A.PRN" MSG='Preload External Trips'
RUN PGM=HIGHWAY,117038 PRNFILE="C:\projects\Roanoke\Base\Output\Logs\@PERIOD_NAME@.PRN" MSG='Load Final Trips onto Network'
  ENDLOOP
RUN PGM=NETWORK,120597 PRNFILE="C:\projects\Roanoke\Base\Output\Merge_Hwy_Assignments.PRN"
RUN PGM=NETWORK,124584 PRNFILE="C:\projects\Roanoke\Base\Output\Hwy_eval.PRN"
RUN PGM=HIGHWAY,145009 PRNFILE="C:\projects\Roanoke\Base\Output\Logs\PBHWY00B.PRN" MSG='Build PK congested skims'
RUN PGM=HIGHWAY,146837 PRNFILE="C:\projects\ROANOKE\CUBE\PBHWY00A.PRN" MSG='Build OP congested skims'
SYS=(COPY C:\projects\Roanoke\Base\Output\PK_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\PK_HWYSKIM_@Feedback_ITER@.MAT)
SYS=(COPY C:\projects\Roanoke\Base\Output\OP_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\OP_HWYSKIM_@Feedback_ITER@.MAT)
ENDLOOP
RUN PGM='PUBLIC TRANSPORT',149288 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\Trn_Assignment_PK.PRN" MSG='Transit Assignment'
RUN PGM='PUBLIC TRANSPORT',150421 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\Trn_Assignment_OP.PRN" MSG='Transit Assignment'
SYS=(COPY "C:\projects\Roanoke\CUBE\*.PRN" "C:\projects\Roanoke\Base\OUTPUT\LOGS\*.PRN")
SYS=(DEL "C:\projects\Roanoke\CUBE\*.PRN")

PILOT Stack Size = 18228 bytes.
................................................................................


--------------------------------------------------------------------------------Page 6  (VOYAGER PILOT) 
Parsons Brinckerhoff
------------------------

SYS "del C:\projects\Roanoke\CUBE\*.prn"
C:\projects\Roanoke\CUBE\Roanoke Area MPO Model_0000.PRN

SYS ReturnCode = 0

--------------------------------------------------------------------------------

--------------------------------------------------------------------------------

SYS "del C:\projects\Roanoke\CUBE\*.bak"

SYS ReturnCode = 0

--------------------------------------------------------------------------------

--------------------------------------------------------------------------------

SYS "del C:\projects\Roanoke\CUBE\*.0??"

SYS ReturnCode = 0

--------------------------------------------------------------------------------

--------------------------------------------------------------------------------

SYS "del C:\projects\Roanoke\CUBE\trc*.s"

SYS ReturnCode = 0

--------------------------------------------------------------------------------

--------------------------------------------------------------------------------

SYS "IF NOT EXIST "C:\projects\Roanoke\Base\Output" MKDIR "C:\projects\Roanoke\Base\Output""

SYS ReturnCode = 0

--------------------------------------------------------------------------------

--------------------------------------------------------------------------------

SYS "IF NOT EXIST "C:\projects\Roanoke\Base\OUTPUT" MKDIR "C:\projects\Roanoke\Base\OUTPUT""
Page 7  (VOYAGER PILOT) 
Parsons Brinckerhoff
------------------------
SYS ReturnCode = 0

--------------------------------------------------------------------------------

--------------------------------------------------------------------------------

SYS "IF NOT EXIST "C:\projects\Roanoke\Base\OUTPUT\LOGS" MKDIR "C:\projects\Roanoke\Base\OUTPUT\LOGS""

SYS ReturnCode = 0

--------------------------------------------------------------------------------

M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\AT_1.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:21 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\AT_2.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:21 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\AT_3.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:22 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\AT_4.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:23 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\AT-5.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:23 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\AT_6.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:23 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\AT_7.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:23 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


--------------------------------------------------------------------------------

SYS "C:\projects\Roanoke\CUBE\LINK_CALC.BAT"

C:\PROJECTS\ROANOKE\CUBE>C:\projects\Roanoke\R\R-3.2.2\bin\Rscript.exe C:\projects\Roanoke\R\calculate_capacities.R C:\projects\Roanoke\Base\Output\link_atype2012A.DBF C:\projects\Roanoke\Base\Output\link_capacities2012A.DBF 

SYS ReturnCode = 1 ???

--------------------------------------------------------------------------------Page 24  (VOYAGER NETWORK) 
Parsons Brinckerhoff
---------------------------
NETWORK (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:23 2016

FILEO NETO = "C:\projects\Roanoke\Base\Output\RVTPOBase2012A.NET"
FILEI LINKI[2] = "C:\projects\Roanoke\Base\Output\link_capacities2012A.DBF"
FILEI LINKI[1] = "C:\projects\Roanoke\Base\Output\ATYPE NETWORK2012A.NET"

PROCESS  PHASE=INPUT
;Use this phase to modify data as it is read, such as recoding node numbers.


ENDPROCESS


PROCESS  PHASE=NODEMERGE
; Use this phase to make computations and selections of any data on the NODEI files.


ENDPROCESS


PROCESS  PHASE=LINKMERGE
; Use this phase to make computations and selections of any data on the LINKI files.
CAPE_AM = LI.2.CAPE * 2.79 ; 2.5  ; AM Capacity
CAPE_MD = LI.2.CAPE * 4.40 ; 5.5  ; MD Capacity
CAPE_PM = LI.2.CAPE * 3.18 ; 2.5  ; PM Capacity
CAPE_NT = LI.2.CAPE * 5.63 ; 4.5  ; NT Capacity
POST_SPEED = LI.1.POST_SPD



; Arterials
IF (LI.1.FACTYPE > 2 & LI.1.FACTYPE < 5 & LI.1.POST_SPD > 25 )
     FFSPEED = LI.1.POST_SPD - 5
ENDIF

; Local and collector
IF (LI.1.FACTYPE > 6 & LI.1.FACTYPE < 9 & LI.1.POST_SPD <> 0)
     FFSPEED = LI.1.POST_SPD + 5
ENDIF



ENDPROCESS


PROCESS  PHASE=SUMMARY
; Use this phase for combining and reporting of working variables.


ENDPROCESS


NETWORK Stack Size = 1302 bytes.Page 25  (VOYAGER NETWORK) 
Parsons Brinckerhoff
---------------------------
................................................................................




C:\projects\Roanoke\Base\Output\ATYPE NETWORK2012A.NET   (VOYAGER):

NET PGM=NETWORK (v.08/05/2014 [6.1.1]) DATE=Sun Mar 27 18:50:23 2016
ID= 
PAR Zones=267 Nodes=5716 Links=9078 NodeRecs=4643 
NVR 25    N    Z    DISTRICT    COUNTY    ACRES    POP    HH    WORK    VEH
    EMP    EMP_NOSG    SCHOOL    IND    RET    HTRET    OFF    SER    SG_RET
    SG_HOS    SG_AIR    SG_COL    SG_NAME=053    ID    X    Y
LVR 25    A    B    ID    LENGTH    DIR    DISTANCE    FACTYPE    LANES
    MEDIAN=001    TERRAIN    POST_SPD    RTE_NAME=029    AAWDT    TMS_ID=020
    SCREENLN    TUNNEL=001    BRIDGE=001    TRK_PHB=001    PED_PHB=001
    TRAFF_PHB=001    TOLL    DESIGNCONST    ZN    DIST_XY    ATYPE


C:\projects\Roanoke\Base\Output\link_capacities2012A.DBF (DBF):
A          B          FFSPEED    CAPD       CAPE       


Begin PROCESS PHASE INPUT
     9078 records read from LINKI[2]: C:\projects\Roanoke\Base\Output\link_capacities2012A.DBF
End   PROCESS PHASE INPUT


Begin PROCESS PHASE NODEMERGE
       4,643 records merged from NODEI[1]: C:\projects\Roanoke\Base\Output\ATYPE NETWORK2012A.NET
       4,643 data base records.Page 26  (VOYAGER NETWORK) 
Parsons Brinckerhoff
---------------------------

Variable  Obs<>0          Total        Ave        Min        Max        RMS  
--------  ------          -----        ---        ---        ---        ---  
N          4,643             --         --       1      5,716            --
Z            205      21,125        103.05       1        206        118.87
DISTRICT     205       1,333          6.5        1         12          7.41
COUNTY       205  10,556,836     51,496.76  51,019     51,775     51,497.75
ACRES        205     158,960.21     775.42      64.05   6,223.82   1,249.34
POP          201     257,292      1,280.06      22      5,661      1,585.46
HH           201     113,015        562.26      10      2,588        709.83
WORK         201     126,846        631.07      12      2,929        805.93
VEH          201     199,984        994.95      15      3,998      1,260.71
EMP          205     131,629        642.09       1      3,976        959.49
EMP_NOSG     205     124,206        605.88       1      3,441        883.78
SCHOOL        50      35,388        707.76      50      2,581        883.56
IND          181      21,155        116.88       1      1,937        254.16
RET          181      21,169        116.96       1        878        186.72
HTRET        146      10,568         72.38       1        401        112.9 
OFF          192      23,117        120.4        1      1,635        259.29
SER          204      48,197        236.26       1      1,450        377.54
SG_RET         2       2,711      1,355.5      308      2,403      1,713.08
SG_HOS         3       3,059      1,019.67     455      1,419      1,099.21
SG_AIR         1         535        535        535        535        535   
SG_COL         3       1,118        372.67     322        450        376.78
SG_NAME        9                            (Hollins )  (Virginia)
ID           204      20,910        102.5        1        204        118.21
X          4,643    -371,270.36     -79.96     -80.28     -79.78      79.96
Y          4,643     173,146.2       37.29      37.13      37.5       37.29

_Variables with values:

_ZONES              267      

End   PROCESS PHASE NODEMERGE


Begin PROCESS PHASE LINKMERGE
       9,078 records merged from NETI[1]: C:\projects\Roanoke\Base\Output\ATYPE NETWORK2012A.NET
       9,078 records merged from NETI[2]: L2.124104
       9,078 data base records.Page 27  (VOYAGER NETWORK) 
Parsons Brinckerhoff
---------------------------

Variable     Obs<>0           Total        Ave       Min         Max        RMS  
--------     ------           -----        ---       ---         ---        ---  
A             9,078              --         --      1       5,716            --
B             9,078              --         --      1       5,716            --
FFSPEED       9,078      324,777         35.78     20          74         37.48
CAPD          9,078   22,509,973      2,479.62    600     100,000      6,850.16
CAPE          9,078   23,401,853      2,577.86    700     100,000      6,880.53
ID            9,076   41,164,549      4,535.54      1       9,067      5,236.63
LENGTH        9,076        1,217.19       0.13      0.01        3.27       0.23
DISTANCE      8,327        1,003.9        0.12      0.01        3.49       0.22
FACTYPE       9,078       53,103          5.85      1          12          6.27
LANES         8,328       11,183          1.34      1           3          1.44
TERRAIN       9,078        9,078          1         1           1          1   
POST_SPD      8,328      277,540         33.33      5          70         35.16
RTE_NAME      7,344                             (        )  (Kermit/T)
AAWDT           505    4,022,329      7,965.01    109      43,583     10,860.89
TMS_ID        9,072                             (        )  (  686146)
SCREENLN        118          308          2.61      1           4          2.91
TUNNEL        8,322                             (N       )  (Y       )
BRIDGE        8,322                             (N       )  (N       )
TRK_PHB       8,322                             (N       )  (Y       )
PED_PHB       8,322                             (N       )  (Y       )
TRAFF_PHB     8,322                             (Y       )  (Y       )
DESIGNCONST   1,493        1,493          1         1           1          1   
ZN            9,078      904,427         99.63      1         267        118.34
ATYPE         9,078       35,033          3.86      2           5          3.95
CAPE_AM       9,078   65,291,169.87   7,192.24  1,953     279,000     19,196.67
CAPE_MD       9,078  102,968,153.2   11,342.6   3,080     440,000     30,274.32
CAPE_PM       9,078   74,417,892.54   8,197.61  2,226     318,000     21,880.08
CAPE_NT       9,078  131,752,432.39  14,513.38  3,941     563,000     38,737.37
POST_SPEED    8,328      277,540         33.33      5          70         35.16

      Obs = 0:  DIR  MEDIAN  TOLL  DIST_XY

_Variables with values:

_ZONES              267      

End   PROCESS PHASE LINKMERGE

M(664): Unconnected Zones:  196<->  207-249<->  255-256<->


Begin PROCESS PHASE SUMMARY

_Variables with values:

_ZONES              267      

End   PROCESS PHASE SUMMARYPage 28  (VOYAGER NETWORK) 
Parsons Brinckerhoff
---------------------------

FILEO NETO=C:\projects\Roanoke\Base\Output\RVTPOBase2012A.NET

NET PGM=NETWORK (v.08/05/2014 [6.1.1]) DATE=Sun Mar 27 18:50:23 2016
ID= 
PAR Zones=267 Nodes=5716 Links=9078 NodeRecs=4643 
NVR 25    N    Z    DISTRICT    COUNTY    ACRES    POP    HH    WORK    VEH
    EMP    EMP_NOSG    SCHOOL    IND    RET    HTRET    OFF    SER    SG_RET
    SG_HOS    SG_AIR    SG_COL    SG_NAME=053    ID    X    Y
LVR 33    A    B    FFSPEED    CAPD    CAPE    ID    LENGTH    DIR
    DISTANCE    FACTYPE    LANES    MEDIAN=001    TERRAIN    POST_SPD
    RTE_NAME=029    AAWDT    TMS_ID=020    SCREENLN    TUNNEL=001    BRIDGE=001
    TRK_PHB=001    PED_PHB=001    TRAFF_PHB=001    TOLL    DESIGNCONST    ZN
    DIST_XY    ATYPE    CAPE_AM    CAPE_MD    CAPE_PM    CAPE_NT    POST_SPEED


NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\FreeFlowSpeeds.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:23 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################

M(100): COPY C:\projects\Roanoke\Base\Output\IMPED11.MAT C:\projects\Roanoke\Base\OUTPUT\PK_FreeFlow_Skim.MAT
M(100): COPY C:\projects\Roanoke\Base\Output\IMPED11.MAT C:\projects\Roanoke\Base\OUTPUT\OP_FreeFlow_Skim.MAT

--------------------------------------------------------------------------------

SYS "C:\projects\Roanoke\CUBE\CLASSIFICATION.BAT"

C:\PROJECTS\ROANOKE\CUBE>C:\projects\Roanoke\R\R-3.2.2\bin\Rscript.exe C:\projects\Roanoke\R\classification.R C:\projects\Roanoke\Base\Input\se.dbf C:\projects\Roanoke\Params\classification C:\projects\Roanoke\Base\Output\se_classified_2012A.dbf 

SYS ReturnCode = 1 ???

--------------------------------------------------------------------------------Page 31  (VOYAGER GENERATION) 
Parsons Brinckerhoff
------------------------------
GENERATION (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:24 2016

FILEO PRINTO[1] = "C:\projects\Roanoke\Base\Output\hbw.csv"
FILEI LOOKUPI[6] = "C:\projects\Roanoke\PARAMS\TRIP_PROD\NHBO.DBF"
FILEI LOOKUPI[5] = "C:\projects\Roanoke\PARAMS\TRIP_PROD\HBSHOP.DBF"
FILEI LOOKUPI[4] = "C:\projects\Roanoke\PARAMS\TRIP_PROD\HBSCHOOL.DBF"
FILEI LOOKUPI[3] = "C:\projects\Roanoke\PARAMS\TRIP_PROD\HBO.DBF"
FILEI LOOKUPI[2] = "C:\projects\Roanoke\PARAMS\TRIP_PROD\NHBW.DBF"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\TRIP_PROD\HBW.DBF"
FILEO PAO[1] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF",
  FORM=10.3, LIST = Z, P[1], P[2], P[3], P[4], P[5], P[6], DBF=T,
  NAMES = TAZ, HBWP, NHBWP, HBOP, HBSCP, HBSHP, NHBOP
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Output\se_classified_2012A.dbf"

ZONES = 267

LOOKUP LOOKUPI=1, NAME=hbw_lu,
  LOOKUP[1]=index, RESULT=vehicle0,
  LOOKUP[2]=index, RESULT=vehicle1,
  LOOKUP[3]=index, RESULT=vehicle2,
  LOOKUP[4]=index, RESULT=vehicle3,
  FAIL[3]=0

LOOKUP LOOKUPI=2, NAME=nhbw_lu,
  LOOKUP[1]=index, RESULT=vehicle0,
  LOOKUP[2]=index, RESULT=vehicle1,
  LOOKUP[3]=index, RESULT=vehicle2,
  LOOKUP[4]=index, RESULT=vehicle3,
  FAIL[3]=0

LOOKUP LOOKUPI=3, NAME=hbo_lu,
  LOOKUP[1]=index, RESULT=vehicle0,
  LOOKUP[2]=index, RESULT=vehicle1,
  LOOKUP[3]=index, RESULT=vehicle2,
  LOOKUP[4]=index, RESULT=vehicle3,
  FAIL[3]=0

LOOKUP LOOKUPI=4, NAME=hbschool_lu,
  LOOKUP[1]=index, RESULT=vehicle0,
  LOOKUP[2]=index, RESULT=vehicle1,
  LOOKUP[3]=index, RESULT=vehicle2,
  LOOKUP[4]=index, RESULT=vehicle3,
  FAIL[3]=0

LOOKUP LOOKUPI=5, NAME=hbshop_lu,
  LOOKUP[1]=index, RESULT=vehicle0,
  LOOKUP[2]=index, RESULT=vehicle1,
  LOOKUP[3]=index, RESULT=vehicle2,
  LOOKUP[4]=index, RESULT=vehicle3,
  FAIL[3]=0

LOOKUP LOOKUPI=6, NAME=nhbo_lu,
  LOOKUP[1]=index, RESULT=vehicle0,
  LOOKUP[2]=index, RESULT=vehicle1,Page 32  (VOYAGER GENERATION) 
Parsons Brinckerhoff
------------------------------
  LOOKUP[3]=index, RESULT=vehicle2,
  LOOKUP[4]=index, RESULT=vehicle3,
  FAIL[3]=0


PROCESS PHASE=ILOOP
; This phase performs a zonal loop (I=1,Zones).  This phase is used to compute productions (P[#]=) and
; attractions (A[#]=) by zone.  Up to 20 P's and 20 A's can be computed in a single run.


  ;# Home-based work productions
  P[1] = 0 +
    zi.1.w0v0 * hbw_lu(1, 1) + zi.1.w0v1 * hbw_lu(2, 1) + zi.1.w0v2 * hbw_lu(3, 1) + zi.1.w0v3 * hbw_lu(4, 1) +
    zi.1.w1v0 * hbw_lu(1, 2) + zi.1.w1v1 * hbw_lu(2, 2) + zi.1.w1v2 * hbw_lu(3, 2) + zi.1.w1v3 * hbw_lu(4, 2) +
    zi.1.w2v0 * hbw_lu(1, 3) + zi.1.w2v1 * hbw_lu(2, 3) + zi.1.w2v2 * hbw_lu(3, 3) + zi.1.w2v3 * hbw_lu(4, 3) +
    zi.1.w3v0 * hbw_lu(1, 4) + zi.1.w3v1 * hbw_lu(2, 4) + zi.1.w3v2 * hbw_lu(3, 4) + zi.1.w3v3 * hbw_lu(4, 4)

  ;# Non home-based work productions
  P[2] = 0 +
    zi.1.w0v0 * nhbw_lu(1, 1) + zi.1.w0v1 * nhbw_lu(2, 1) + zi.1.w0v2 * nhbw_lu(3, 1) + zi.1.w0v3 * nhbw_lu(4, 1) +
    zi.1.w1v0 * nhbw_lu(1, 2) + zi.1.w1v1 * nhbw_lu(2, 2) + zi.1.w1v2 * nhbw_lu(3, 2) + zi.1.w1v3 * nhbw_lu(4, 2) +
    zi.1.w2v0 * nhbw_lu(1, 3) + zi.1.w2v1 * nhbw_lu(2, 3) + zi.1.w2v2 * nhbw_lu(3, 3) + zi.1.w2v3 * nhbw_lu(4, 3) +
    zi.1.w3v0 * nhbw_lu(1, 4) + zi.1.w3v1 * nhbw_lu(2, 4) + zi.1.w3v2 * nhbw_lu(3, 4) + zi.1.w3v3 * nhbw_lu(4, 4)

  ;# Home-based other productions
  P[3] =
    zi.1.p1v0 * hbo_lu(1, 1) + zi.1.p1v1 * hbo_lu(2, 1) + zi.1.p1v2 * hbo_lu(3, 1) + zi.1.p1v3 * hbo_lu(4, 1) +
    zi.1.p2v0 * hbo_lu(1, 2) + zi.1.p2v1 * hbo_lu(2, 2) + zi.1.p2v2 * hbo_lu(3, 2) + zi.1.p2v3 * hbo_lu(4, 2) +
    zi.1.p3v0 * hbo_lu(1, 3) + zi.1.p3v1 * hbo_lu(2, 3) + zi.1.p3v2 * hbo_lu(3, 3) + zi.1.p3v3 * hbo_lu(4, 3) +
    zi.1.p4v0 * hbo_lu(1, 4) + zi.1.p4v1 * hbo_lu(2, 4) + zi.1.p4v2 * hbo_lu(3, 4) + zi.1.p4v3 * hbo_lu(4, 4)


  ;# Home-based school productions
  P[4] = 0 +
    zi.1.p1v0 * hbschool_lu(1, 1) + zi.1.p1v1 * hbschool_lu(2, 1) + zi.1.p1v2 * hbschool_lu(3, 1) + zi.1.p1v3 * hbschool_lu(4, 1) +
    zi.1.p2v0 * hbschool_lu(1, 2) + zi.1.p2v1 * hbschool_lu(2, 2) + zi.1.p2v2 * hbschool_lu(3, 2) + zi.1.p2v3 * hbschool_lu(4, 2) +
    zi.1.p3v0 * hbschool_lu(1, 3) + zi.1.p3v1 * hbschool_lu(2, 3) + zi.1.p3v2 * hbschool_lu(3, 3) + zi.1.p3v3 * hbschool_lu(4, 3) +
    zi.1.p4v0 * hbschool_lu(1, 4) + zi.1.p4v1 * hbschool_lu(2, 4) + zi.1.p4v2 * hbschool_lu(3, 4) + zi.1.p4v3 * hbschool_lu(4, 4)


  ;# Home-based shop productions
  P[5] = 0 +
    zi.1.p1v0 * hbshop_lu(1, 1) + zi.1.p1v1 * hbshop_lu(2, 1) + zi.1.p1v2 * hbshop_lu(3, 1) + zi.1.p1v3 * hbshop_lu(4, 1) +
    zi.1.p2v0 * hbshop_lu(1, 2) + zi.1.p2v1 * hbshop_lu(2, 2) + zi.1.p2v2 * hbshop_lu(3, 2) + zi.1.p2v3 * hbshop_lu(4, 2) +
    zi.1.p3v0 * hbshop_lu(1, 3) + zi.1.p3v1 * hbshop_lu(2, 3) + zi.1.p3v2 * hbshop_lu(3, 3) + zi.1.p3v3 * hbshop_lu(4, 3) +
    zi.1.p4v0 * hbshop_lu(1, 4) + zi.1.p4v1 * hbshop_lu(2, 4) + zi.1.p4v2 * hbshop_lu(3, 4) + zi.1.p4v3 * hbshop_lu(4, 4)

  ;# non-Home-based other productions
  P[6] = 0 +
    zi.1.p1v0 * nhbo_lu(1, 1) + zi.1.p1v1 * nhbo_lu(2, 1) + zi.1.p1v2 * nhbo_lu(3, 1) + zi.1.p1v3 * nhbo_lu(4, 1) +
    zi.1.p2v0 * nhbo_lu(1, 2) + zi.1.p2v1 * nhbo_lu(2, 2) + zi.1.p2v2 * nhbo_lu(3, 2) + zi.1.p2v3 * nhbo_lu(4, 2) +
    zi.1.p3v0 * nhbo_lu(1, 3) + zi.1.p3v1 * nhbo_lu(2, 3) + zi.1.p3v2 * nhbo_lu(3, 3) + zi.1.p3v3 * nhbo_lu(4, 3) +
    zi.1.p4v0 * nhbo_lu(1, 4) + zi.1.p4v1 * nhbo_lu(2, 4) + zi.1.p4v2 * nhbo_lu(3, 4) + zi.1.p4v3 * nhbo_lu(4, 4)
Page 33  (VOYAGER GENERATION) 
Parsons Brinckerhoff
------------------------------
  p1v0 = zi.1.p1v0 * nhbo_lu(1, 1)
  p1v1 = zi.1.p1v1 * nhbo_lu(2, 1)
  p1v2 = zi.1.p1v2 * nhbo_lu(3, 1)
  p1v3 = zi.1.p1v3 * nhbo_lu(4, 1)
  p2v0 = zi.1.p2v0 * nhbo_lu(1, 2)
  p2v1 = zi.1.p2v1 * nhbo_lu(2, 2)
  p2v2 = zi.1.p2v2 * nhbo_lu(3, 2)
  p2v3 = zi.1.p2v3 * nhbo_lu(4, 2)
  p3v0 = zi.1.p3v0 * nhbo_lu(1, 3)
  p3v1 = zi.1.p3v1 * nhbo_lu(2, 3)
  p3v2 = zi.1.p3v2 * nhbo_lu(3, 3)
  p3v3 = zi.1.p3v3 * nhbo_lu(4, 3)
  p4v0 = zi.1.p4v0 * nhbo_lu(1, 4)
  p4v1 = zi.1.p4v1 * nhbo_lu(2, 4)
  p4v2 = zi.1.p4v2 * nhbo_lu(3, 4)
  p4v3 = zi.1.p4v3 * nhbo_lu(4, 4)
  all =
    p1v0 + p1v1 + p1v2 + p1v3 +
    p2v0 + p2v1 + p2v2 + p2v3 +
    p3v0 + p3v1 + p3v2 + p3v3 +
    p4v0 + p4v1 + p4v2 + p4v3


PRINT FORM = 10.10, CSV = T, LIST = Z, P[6], p1v0, p1v1, p1v2, p1v3, p2v0,
  p2v1, p2v2, p2v3, p3v0, p3v1, p3v2, p3v3, p4v0, p4v1, p4v2, p4v3, all,
  PRINTO = 1


ENDPROCESS


PROCESS PHASE=ADJUST



ENDPROCESS


GENERATION Stack Size = 6922 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Output\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        Page 34  (VOYAGER GENERATION) 
Parsons Brinckerhoff
------------------------------

LOOKUP #1: hbw_lu C:\projects\Roanoke\PARAMS\TRIP_PROD\HBW.DBF:
index       N5      workers     C8      vehicle0    N19.15  vehicle1    N19.15 
vehicle2    N19.15  vehicle3    N19.15 

LOOKUP #2: nhbw_lu C:\projects\Roanoke\PARAMS\TRIP_PROD\NHBW.DBF:
index       N5      workers     C8      vehicle0    N19.15  vehicle1    N19.15 
vehicle2    N19.15  vehicle3    N19.15 

LOOKUP #3: hbo_lu C:\projects\Roanoke\PARAMS\TRIP_PROD\HBO.DBF:
index       N5      size        C8      vehicle0    N19.15  vehicle1    N19.15 
vehicle2    N19.15  vehicle3    N19.15 

LOOKUP #4: hbschool_lu C:\projects\Roanoke\PARAMS\TRIP_PROD\HBSCHOOL.DBF:
index       N5      size        C8      vehicle0    N19.15  vehicle1    N19.15 
vehicle2    N19.15  vehicle3    N19.15 

LOOKUP #5: hbshop_lu C:\projects\Roanoke\PARAMS\TRIP_PROD\HBSHOP.DBF:
index       N5      size        C8      vehicle0    N19.15  vehicle1    N19.15 
vehicle2    N19.15  vehicle3    N19.15 

LOOKUP #6: nhbo_lu C:\projects\Roanoke\PARAMS\TRIP_PROD\NHBO.DBF:
index       N5      size        C8      vehicle0    N19.15  vehicle1    N19.15 
vehicle2    N19.15  vehicle3    N19.15 


Total P/A  1  117,678       --
Total P/A  2   62,525       --
Total P/A  3  264,074       --
Total P/A  4   45,117       --
Total P/A  5  136,095       --
Total P/A  6  222,309       --

PHASE=ADJUST:

Total P/A  1  117,678       --
Total P/A  2   62,525       --
Total P/A  3  264,074       --
Total P/A  4   45,117       --
Total P/A  5  136,095       --
Total P/A  6  222,309       --

File C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF opened

GENERATION ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\TransitSpeeds.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:24 2016
NETWORK  ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\BuildWalkAccessConenctors.PRN. 
PUBLIC TRANSPORT (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:25 2016
PUBLIC TRANSPORT ReturnCode = 1  Elapsed Time = 00:00:02
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\WalkAccess_ByMode.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:27 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\Trn_PK_Skims.PRN. 
PUBLIC TRANSPORT (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:28 2016
PUBLIC TRANSPORT ReturnCode = 1  Elapsed Time = 00:00:02
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\Trn_OP_Skims.PRN. 
PUBLIC TRANSPORT (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:30 2016
PUBLIC TRANSPORT ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 510  (VOYAGER FRATAR) 
Parsons Brinckerhoff
---------------------------
FRATAR (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:31 2016

FILEI MATI[1] = "C:\projects\Roanoke\Base\INPUT\EE_seed.MAT"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\Base\INPUT\EXTERNALTRIPS.DBF"
FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\EE_2012.MAT",
 MO=1,NAME = EE_TRIPS, DEC=1*D

PARAMETERS MAXRMSE=0.0001 MAXITERS=25
; USE A LOOKUP FILE TO find appropriate factors (1.0 is assumed unless expressly provided)
LOOKUP LOOKUPI=1, LIST=Y,
  NAME=GROWTHF,
  LOOKUP[1]=ZONE,RESULT=AADT_FAC,
  LOOKUP[2]=ZONE,RESULT=AADT_FAC,
  FAIL[1]=1,FAIL[2]=1,FAIL[3]=1

SETPA PGF[1]=GROWTHF(1,I) AGF[1]=GROWTHF(2,I) MW[1]=MI.1.1


FRATAR Stack Size = 602 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\INPUT\EE_seed.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 11 11:08:13 2016 
ID=Model Run
PAR Zones=267 M=1
  EE_Trips
LOOKUP #1: GROWTHF C:\projects\Roanoke\Base\INPUT\EXTERNALTRIPS.DBF:
ZONE        N6      EXTTOTAL    N15.2   EE          N8.2    IEEI        N8.2   
AADT_FAC    N8.2   


LOOKUP   GROWTHF:  FAIL=  1  1  1
         GROWTHF(1,250)  = 1
         GROWTHF(1,251)  = 1
         GROWTHF(1,252)  = 1
         GROWTHF(1,253)  = 1
         GROWTHF(1,254)  = 1
         GROWTHF(1,257)  = 1
         GROWTHF(1,258)  = 1
         GROWTHF(1,259)  = 1
         GROWTHF(1,260)  = 1
         GROWTHF(1,261)  = 1
         GROWTHF(1,262)  = 1
         GROWTHF(1,263)  = 1
         GROWTHF(1,264)  = 1
         GROWTHF(1,265)  = 1
         GROWTHF(1,266)  = 1
         GROWTHF(1,267)  = 1
         GROWTHF(2,250)  = 1
         GROWTHF(2,251)  = 1
         GROWTHF(2,252)  = 1
         GROWTHF(2,253)  = 1
         GROWTHF(2,254)  = 1Page 511  (VOYAGER FRATAR) 
Parsons Brinckerhoff
---------------------------
         GROWTHF(2,257)  = 1
         GROWTHF(2,258)  = 1
         GROWTHF(2,259)  = 1
         GROWTHF(2,260)  = 1
         GROWTHF(2,261)  = 1
         GROWTHF(2,262)  = 1
         GROWTHF(2,263)  = 1
         GROWTHF(2,264)  = 1
         GROWTHF(2,265)  = 1
         GROWTHF(2,266)  = 1
         GROWTHF(2,267)  = 1


W(678): SETPA CONTROL[1]= specified 0 times.

FRATAR:

     MW[1]  =  41,787           Input Total
     P/A[1] =  41,787   41,787  Total
     MW[1]  =  41,787           Final Target

RMSE  MW= 1
-----------
 1     0.00

Totals after Iteration 1 I loop:

	MI.01.001: 41,787
	MW[1]    : 41,787
	MO.01.001: 41,787

FRATAR   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 512  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:31 2016

FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\EXTERNALTRIPS.DBF",
fields=ZONE,AADT,EE_Total,IEEI
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\EXTERNALTRIPS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\EE_2012.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t

IF ( I >= 250)
  RO.PROD1=ROWSUM(1)
  RO.ATTR1=ROWSUM(2)
  RO.ZONE=I
  RO.EE_Total = RO.PROD1 + RO.ATTR1
  RO.AADT = ZI.1.EXTTOTAL * ZI.1.AADT_FAC
  RO.IEEI = RO.AADT - RO.EE_Total

WRITE RECO=1
ENDIF


MATRIX Stack Size = 846 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\EXTERNALTRIPS.DBF Opened: 16 data records  5 Fields:
ZONE(N)         EXTTOTAL(N)     EE(N)           IEEI(N)         AADT_FAC(N)    


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\EE_2012.MAT Opened
MAT PGM=FRATAR (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:31 2016 
ID=
PAR Zones=267 M=1
  EE_TRIPS

W(754): Following RO.vars not in any RECO:
   PROD1        ATTR1      

Totals from Transpose:

	MI.01.001.T: 41,787

M(660): Transpose Disk Usage (bytes): Data=4,233, Index=1,068.Page 513  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  : 41,787
	MI.01.001.T: 41,787
	MW[1]      : 41,787
	MW[2]      : 41,787

M(751): 18 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\EXTERNALTRIPS.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 514  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:31 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\Output\IMPED11.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1318 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\Output\IMPED11.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Sun Mar 27 18:50:23 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 515  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,624,321.47   @J=I:     23,000,114.87
	MI.01.002: 22,402,468,534.04
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,833,939.47   @J=I:     23,000,792.87
	MW[1]    : 22,425,624,321.47   @J=I:     23,000,114.87
	MW[2]    : 22,402,468,534.04
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,833,939.47   @J=I:     23,000,792.87
	MW[11]   :        624,321.47   @J=I:            114.87
	MW[12]   :        468,534.04
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        769,739.47   @J=I:            782.87
	MO.01.001:        624,321.47
	MO.01.002:        468,534.04
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        769,739.47

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################
Page 516  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------
GENERATION (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:32 2016

FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\EXTERNALTRIPS.DBF"
FILEO PAO[1] = "C:\projects\Roanoke\Base\Output\IEEI_PA_2012.DBF",
FORM=10.3, DBF=T, LIST=Z, P[1], A[1]
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\se.dbf"

ZONES=267

PHASE=ILOOP
  CoeffHH     = 0.423546369 * 2
  CoeffIND    = 0.235065256 * 2
  CoeffSER    = 0.158333776 * 2
  CoeffOFFHTR = 0.148286574 * 2
  CoeffRET    = 0.208675310 * 2
  CoeffSG     = 0.225389103 * 2
       ; adjustent factor reflects change required to make estimated trip generation rates match observed trips

GrwthRate=1.0        ; for future year models, replace this 1.0 with the assumed growth rate

  IF (I<=206)
    TOTALSG = ZI.1.SG_RET + ZI.1.SG_HOS + ZI.1.SG_AIR + ZI.1.SG_COL
    OFFHTRET = ZI.1.OFF + ZI.1.HTRET
    A[1]=(ZI.1.HH * CoeffHH) + (ZI.1.IND * CoeffIND) + (ZI.1.RET * CoeffRET) +
       (OFFHTRET * CoeffOFFHTR) + (ZI.1.SER * CoeffSER) + (TOTALSG * CoeffSG)
    P[1]= 0
  ELSE
    A[1]=0
    P[1]= ZI.2.IEEI
  ENDIF
  ENDPHASE

PHASE=ADJUST
  BALANCE A2P=1

REPORT A=Y P=Y
ENDPHASE



GENERATION Stack Size = 1438 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\EXTERNALTRIPS.DBF Opened: 18 data records  4 Fields:
ZONE(N)         AADT(N)         EE_TOTAL(N)     IEEI(N)        


FILEI ZDATI=C:\projects\Roanoke\Base\Input\se.dbf Opened: 205 data records  23 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)           Page 517  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------


Variable Values at end of Iteration 1 I loop:

    COEFFHH    :  0.84709
    COEFFIND   :  0.47013
    COEFFSER   :  0.31667
    COEFFOFFHTR:  0.29657
    COEFFRET   :  0.41735
    COEFFSG    :  0.45078
    GRWTHRATE  :  1      
    OFFHTRET   : 15      

Total P/A  1  100,844  143,113

PHASE=ADJUST:Page 518  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT P
Zone           0          1
---------------------------
   0  100,843.68 100,843.68
   1          --         --
   2          --         --
   3          --         --
   4          --         --
   5          --         --
   6          --         --
   7          --         --
   8          --         --
   9          --         --
  10          --         --
  11          --         --
  12          --         --
  13          --         --
  14          --         --
  15          --         --
  16          --         --
  17          --         --
  18          --         --
  19          --         --
  20          --         --
  21          --         --
  22          --         --
  23          --         --
  24          --         --
  25          --         --
  26          --         --
  27          --         --
  28          --         --
  29          --         --
  30          --         --
  31          --         --
  32          --         --
  33          --         --
  34          --         --
  35          --         --
  36          --         --
  37          --         --
  38          --         --
  39          --         --
  40          --         --
  41          --         --
  42          --         --
  43          --         --
  44          --         --
  45          --         --
  46          --         --
  47          --         --
  48          --         --Page 519  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT P
Zone           0          1
---------------------------
  49          --         --
  50          --         --
  51          --         --
  52          --         --
  53          --         --
  54          --         --
  55          --         --
  56          --         --
  57          --         --
  58          --         --
  59          --         --
  60          --         --
  61          --         --
  62          --         --
  63          --         --
  64          --         --
  65          --         --
  66          --         --
  67          --         --
  68          --         --
  69          --         --
  70          --         --
  71          --         --
  72          --         --
  73          --         --
  74          --         --
  75          --         --
  76          --         --
  77          --         --
  78          --         --
  79          --         --
  80          --         --
  81          --         --
  82          --         --
  83          --         --
  84          --         --
  85          --         --
  86          --         --
  87          --         --
  88          --         --
  89          --         --
  90          --         --
  91          --         --
  92          --         --
  93          --         --
  94          --         --
  95          --         --
  96          --         --
  97          --         --Page 520  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT P
Zone           0          1
---------------------------
  98          --         --
  99          --         --
 100          --         --
 101          --         --
 102          --         --
 103          --         --
 104          --         --
 105          --         --
 106          --         --
 107          --         --
 108          --         --
 109          --         --
 110          --         --
 111          --         --
 112          --         --
 113          --         --
 114          --         --
 115          --         --
 116          --         --
 117          --         --
 118          --         --
 119          --         --
 120          --         --
 121          --         --
 122          --         --
 123          --         --
 124          --         --
 125          --         --
 126          --         --
 127          --         --
 128          --         --
 129          --         --
 130          --         --
 131          --         --
 132          --         --
 133          --         --
 134          --         --
 135          --         --
 136          --         --
 137          --         --
 138          --         --
 139          --         --
 140          --         --
 141          --         --
 142          --         --
 143          --         --
 144          --         --
 145          --         --
 146          --         --Page 521  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT P
Zone           0          1
---------------------------
 147          --         --
 148          --         --
 149          --         --
 150          --         --
 151          --         --
 152          --         --
 153          --         --
 154          --         --
 155          --         --
 156          --         --
 157          --         --
 158          --         --
 159          --         --
 160          --         --
 161          --         --
 162          --         --
 163          --         --
 164          --         --
 165          --         --
 166          --         --
 167          --         --
 168          --         --
 169          --         --
 170          --         --
 171          --         --
 172          --         --
 173          --         --
 174          --         --
 175          --         --
 176          --         --
 177          --         --
 178          --         --
 179          --         --
 180          --         --
 181          --         --
 182          --         --
 183          --         --
 184          --         --
 185          --         --
 186          --         --
 187          --         --
 188          --         --
 189          --         --
 190          --         --
 191          --         --
 192          --         --
 193          --         --
 194          --         --
 195          --         --Page 522  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT P
Zone           0          1
---------------------------
 196          --         --
 197          --         --
 198          --         --
 199          --         --
 200          --         --
 201          --         --
 202          --         --
 203          --         --
 204          --         --
 205          --         --
 206          --         --
 207          --         --
 208          --         --
 209          --         --
 210          --         --
 211          --         --
 212          --         --
 213          --         --
 214          --         --
 215          --         --
 216          --         --
 217          --         --
 218          --         --
 219          --         --
 220          --         --
 221          --         --
 222          --         --
 223          --         --
 224          --         --
 225          --         --
 226          --         --
 227          --         --
 228          --         --
 229          --         --
 230          --         --
 231          --         --
 232          --         --
 233          --         --
 234          --         --
 235          --         --
 236          --         --
 237          --         --
 238          --         --
 239          --         --
 240          --         --
 241          --         --
 242          --         --
 243          --         --
 244          --         --Page 523  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT P
Zone           0          1
---------------------------
 245          --         --
 246          --         --
 247          --         --
 248          --         --
 249          --         --
 250   16,109.23  16,109.23
 251    7,673.5    7,673.5 
 252    2,028.15   2,028.15
 253      895.63     895.63
 254    9,147.92   9,147.92
 255          --         --
 256          --         --
 257   10,235.35  10,235.35
 258   14,847.79  14,847.79
 259    1,173.49   1,173.49
 260    5,589.32   5,589.32
 261    4,838.43   4,838.43
 262   21,283.07  21,283.07
 263    1,347.61   1,347.61
 264      990.34     990.34
 265    4,254.13   4,254.13
 266      177.4      177.4 
 267      252.32     252.32Page 524  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT A
Zone           0          1
---------------------------
   0  100,843.68 100,843.68
   1      501.59     501.59
   2       94.08      94.08
   3      456.11     456.11
   4      673.1      673.1 
   5      394.67     394.67
   6      191.3      191.3 
   7       78.09      78.09
   8      426.5      426.5 
   9      212.56     212.56
  10      438.06     438.06
  11      316.75     316.75
  12      309.22     309.22
  13      349.98     349.98
  14      522.42     522.42
  15      354.9      354.9 
  16      251.5      251.5 
  17       26.55      26.55
  18      301.1      301.1 
  19      202.68     202.68
  20      201.4      201.4 
  21      275.34     275.34
  22      432.53     432.53
  23      334.84     334.84
  24      229.38     229.38
  25      331.17     331.17
  26      273.01     273.01
  27      622.7      622.7 
  28      436.5      436.5 
  29      405.47     405.47
  30      441.01     441.01
  31      505.91     505.91
  32      232.57     232.57
  33      237.19     237.19
  34      364.09     364.09
  35      283.51     283.51
  36    1,450.42   1,450.42
  37      469.98     469.98
  38      252.88     252.88
  39    1,311.13   1,311.13
  40    1,455.15   1,455.15
  41    1,001.3    1,001.3 
  42      571.6      571.6 
  43    1,695.19   1,695.19
  44      657.74     657.74
  45    1,228.74   1,228.74
  46      493.53     493.53
  47      167.03     167.03
  48      178.81     178.81Page 525  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT A
Zone           0          1
---------------------------
  49      363.53     363.53
  50      577.31     577.31
  51      234.01     234.01
  52      317.78     317.78
  53      230.87     230.87
  54      255.29     255.29
  55      313.64     313.64
  56      496.3      496.3 
  57      781.86     781.86
  58      936.92     936.92
  59      913.84     913.84
  60      956.26     956.26
  61      147.88     147.88
  62      397.62     397.62
  63      680.95     680.95
  64      817.66     817.66
  65      706.44     706.44
  66      658.03     658.03
  67      426.47     426.47
  68      702.34     702.34
  69      631.01     631.01
  70      492.21     492.21
  71      201.86     201.86
  72      755.2      755.2 
  73      322.79     322.79
  74      226.66     226.66
  75      249.27     249.27
  76      177.45     177.45
  77      453.03     453.03
  78      278.03     278.03
  79      274.16     274.16
  80      278.8      278.8 
  81      299.03     299.03
  82      263.68     263.68
  83      347.48     347.48
  84      368.82     368.82
  85      379.06     379.06
  86      117.38     117.38
  87        9.77       9.77
  88      423.26     423.26
  89      414.14     414.14
  90      695.67     695.67
  91      131.31     131.31
  92    1,147.06   1,147.06
  93      212.28     212.28
  94      160.01     160.01
  95      452.64     452.64
  96    2,019.31   2,019.31
  97      632.05     632.05Page 526  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT A
Zone           0          1
---------------------------
  98      759.7      759.7 
  99      296.01     296.01
 100      961.05     961.05
 101      649.27     649.27
 102      243.29     243.29
 103      163.55     163.55
 104      726.96     726.96
 105      472.8      472.8 
 106      712.35     712.35
 107      490.97     490.97
 108    1,073.06   1,073.06
 109      654.32     654.32
 110      378.71     378.71
 111      296.17     296.17
 112      219.7      219.7 
 113      630.68     630.68
 114      557.88     557.88
 115      156        156   
 116      630.2      630.2 
 117      737.49     737.49
 118      160.78     160.78
 119      341.87     341.87
 120      166.66     166.66
 121      222.75     222.75
 122      263.98     263.98
 123      258        258   
 124      299.22     299.22
 125      351.95     351.95
 126      575.3      575.3 
 127      492.84     492.84
 128      480.95     480.95
 129      482.17     482.17
 130      303.38     303.38
 131      451.4      451.4 
 132      339.54     339.54
 133      302.43     302.43
 134      200.77     200.77
 135      358.1      358.1 
 136      691.38     691.38
 137      258.01     258.01
 138      288.3      288.3 
 139      446.35     446.35
 140      637.89     637.89
 141      867.19     867.19
 142      522.93     522.93
 143      583.88     583.88
 144      690.82     690.82
 145    1,251.44   1,251.44
 146      214.27     214.27Page 527  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT A
Zone           0          1
---------------------------
 147      616.93     616.93
 148    1,818.02   1,818.02
 149      399.9      399.9 
 150      717.11     717.11
 151      335.07     335.07
 152      527.42     527.42
 153      571.93     571.93
 154      227.78     227.78
 155      365.56     365.56
 156      805.68     805.68
 157      469.07     469.07
 158    1,090.65   1,090.65
 159    1,091.49   1,091.49
 160      381.62     381.62
 161      934.72     934.72
 162      937.56     937.56
 163      954.66     954.66
 164      706.66     706.66
 165      953.13     953.13
 166    1,537.79   1,537.79
 167      244.02     244.02
 168      330.04     330.04
 169      370.5      370.5 
 170      211.07     211.07
 171      345.87     345.87
 172      588.62     588.62
 173      472.71     472.71
 174      313.76     313.76
 175      816.19     816.19
 176      652.58     652.58
 177      957.37     957.37
 178      665.96     665.96
 179      369.83     369.83
 180      340.71     340.71
 181      618.53     618.53
 182      534.37     534.37
 183      512.91     512.91
 184      281.17     281.17
 185      499.28     499.28
 186      470.56     470.56
 187      229.8      229.8 
 188      417.56     417.56
 189      261.38     261.38
 190      260.5      260.5 
 191      401.33     401.33
 192      591.89     591.89
 193      348.75     348.75
 194      388.52     388.52
 195        6.19       6.19Page 528  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT A
Zone           0          1
---------------------------
 196          --         --
 197      510.67     510.67
 198      663.69     663.69
 199      631.46     631.46
 200      471.23     471.23
 201      259.95     259.95
 202      342.75     342.75
 203      120.18     120.18
 204      221.19     221.19
 205      215.43     215.43
 206      178.02     178.02
 207          --         --
 208          --         --
 209          --         --
 210          --         --
 211          --         --
 212          --         --
 213          --         --
 214          --         --
 215          --         --
 216          --         --
 217          --         --
 218          --         --
 219          --         --
 220          --         --
 221          --         --
 222          --         --
 223          --         --
 224          --         --
 225          --         --
 226          --         --
 227          --         --
 228          --         --
 229          --         --
 230          --         --
 231          --         --
 232          --         --
 233          --         --
 234          --         --
 235          --         --
 236          --         --
 237          --         --
 238          --         --
 239          --         --
 240          --         --
 241          --         --
 242          --         --
 243          --         --
 244          --         --Page 529  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT A
Zone           0          1
---------------------------
 245          --         --
 246          --         --
 247          --         --
 248          --         --
 249          --         --
 250          --         --
 251          --         --
 252          --         --
 253          --         --
 254          --         --
 255          --         --
 256          --         --
 257          --         --
 258          --         --
 259          --         --
 260          --         --
 261          --         --
 262          --         --
 263          --         --
 264          --         --
 265          --         --
 266          --         --
 267          --         --

Total P/A  1  100,844  100,844

File C:\projects\Roanoke\Base\Output\IEEI_PA_2012.DBF opened

GENERATION ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 530  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:32 2016

FILEO RECO[1] = "C:\projects\Roanoke\Base\Output\NHBNR_PA_2012.DBF",
 FIELDS=Z, NHBNR_P, NHBNR_A
FILEI RECI = "C:\projects\Roanoke\Base\Output\IEEI_PA_2012.DBF"


ZONES = 267
NHB_PCT = .30 ; 30% of External trips make NHB trips inside the region

RO.Z=RI.Z
RO.NHBNR_P = RI.P1 * NHB_PCT
RO.NHBNR_A = RI.A1 * NHB_PCT
WRITE RECO=1


MATRIX Stack Size = 474 bytes.
................................................................................


FILEI RECI=C:\projects\Roanoke\Base\Output\IEEI_PA_2012.DBF Opened: 267 data records  3 Fields:
Z N3                P1 N10.3            A1 N10.3           


M(705): 267 RECI records processed,  0 with errors.

Variable Values at end of Iteration 1 I loop:

    RECI   :  267   252.320     0.000
    NHB_PCT:  0.3

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\Output\NHBNR_PA_2012.DBF.

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 531  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
DISTRIBUTION (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:32 2016

FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Output\IEEI_PA_2012.DBF"
FILEO MATO[1] = "C:\projects\Roanoke\Base\Output\IEEI_2012.MAT",
 MO=1, NAME=TRIPS, DEC=D
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Hwyskim.MAT"

PAR maxiters=20 maxrmse=10
setpa p[1]=zi.1.p1, a[1]=zi.1.a1  ;Set P and A Fields

; Gamma Function parameters
alpha   =  1.3544
beta    = -4.0016
epsilon =  .14

MW[2]=mi.1.1      ; total travel time

; First replace any 0 times with a very small travel time to avoid
;  failure of the exponentiation calculation.
JLOOP
  IF (MW[2]=0)
    MW[2]=.1
    ENDIF
  ENDJLOOP

;calculate friction factor using the gamma function
mw[3]  = (alpha * (MW[2]^beta) * EXP(epsilon*MW[2]))

;apply the results of gamma formulation
PAF=0
MW[1] = A[1] * MW[3]
ATTRSUM=ROWSUM(1)
IF (ATTRSUM>0) PAF=P[1]/ATTRSUM
MW[1]=PAF * MW[1]


; ========GENERATE FREQUENCY REPORTS BASED ON TIME============
FREQUENCY VALUEMW=1 BASEMW=2, RANGE=0-42,
TITLE='** IEEI Travel Time Frequency **'

DISTRIBUTION Stack Size = 1220 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Output\IEEI_PA_2012.DBF Opened: 267 data records  3 Fields:
Z(N)            P1(N)           A1(N)          


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:31 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 532  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

Totals after Iteration 1 I loop:

	MI.01.001:     624,321.47   @J=I:         114.87
	MW[1]    :     100,843.68
	MW[2]    :     626,569.97   @J=I:         121.17
	MW[3]    : 727,973,896.82   @J=I: 145,088,110.8 

Variable Values at end of Iteration 1 I loop:

    ALPHA  :  1.3544
    BETA   : -4.0016
    EPSILON:  0.14  
    PAF    : 13.8421
    ATTRSUM: 18.2284Page 533  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 2
--------------------

Totals after Iteration 2 I loop:

	MI.01.001:     624,321.47   @J=I:         114.87
	MW[1]    :     100,843.68
	MW[2]    :     626,569.97   @J=I:         121.17
	MW[3]    : 727,973,896.82   @J=I: 145,088,110.8 

Variable Values at end of Iteration 2 I loop:

    ALPHA  :  1.3544
    BETA   : -4.0016
    EPSILON:  0.14  
    PAF    : 11.4102
    ATTRSUM: 22.1135Page 534  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 3
--------------------

Totals after Iteration 3 I loop:

	MI.01.001:     624,321.47   @J=I:         114.87
	MW[1]    :     100,843.68
	MW[2]    :     626,569.97   @J=I:         121.17
	MW[3]    : 727,973,896.82   @J=I: 145,088,110.8 

Variable Values at end of Iteration 3 I loop:

    ALPHA  :  1.3544
    BETA   : -4.0016
    EPSILON:  0.14  
    PAF    : 11.6002
    ATTRSUM: 21.7514Page 535  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 4
--------------------

Totals after Iteration 4 I loop:

	MI.01.001:     624,321.47   @J=I:         114.87
	MW[1]    :     100,843.68
	MW[2]    :     626,569.97   @J=I:         121.17
	MW[3]    : 727,973,896.82   @J=I: 145,088,110.8 

Variable Values at end of Iteration 4 I loop:

    ALPHA  :  1.3544
    BETA   : -4.0016
    EPSILON:  0.14  
    PAF    : 11.5907
    ATTRSUM: 21.7692Page 536  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 5
--------------------

Totals after Iteration 5 I loop:

	MI.01.001:     624,321.47   @J=I:         114.87
	MW[1]    :     100,843.68
	MW[2]    :     626,569.97   @J=I:         121.17
	MW[3]    : 727,973,896.82   @J=I: 145,088,110.8 

Variable Values at end of Iteration 5 I loop:

    ALPHA  :  1.3544
    BETA   : -4.0016
    EPSILON:  0.14  
    PAF    : 11.5715
    ATTRSUM: 21.8052

RMSE  MW=  1
------------
 1    820.49
 2     66.13
 3     27.93
 4     14.14
 5      5.63Page 537  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 5
--------------------

Totals after Iteration 5 I loop:

	MI.01.001:     624,321.47   @J=I:         114.87
	MW[1]    :     100,843.68
	MW[2]    :     626,569.97   @J=I:         121.17
	MW[3]    : 727,973,896.82   @J=I: 145,088,110.8 
	MO.01.001:     100,843.68

Variable Values at end of Iteration 5 I loop:

    ALPHA  :  1.3544
    BETA   : -4.0016
    EPSILON:  0.14  
    PAF    : 11.5628
    ATTRSUM: 21.8217

RMSE  MW=  1
------------
 1    820.49
 2     66.13
 3     27.93
 4     14.14
 5      1.97Page 538  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

FREQUENCY (Iter=5) ** IEEI Travel Time Frequency **
  BASEMW=2 VALUEMW=1 RANGE=0,42,1
  MW[2]                   Accum
>=  -  < Obs    Sum   Pct  Pct
---------------------------------------------------
  0 -  1   1   321.25 0.3   0.3 |
  1 -  2   2   199.92 0.2   0.5 |
  2 -  3   8 1,695.09 1.7   2.2 |=
  3 -  4   9 2,299.08 2.3   4.5 |==
  4 -  5  15 1,601.27 1.6   6.1 |=
  5 -  6  21 2,358.03 2.3   8.4 |==
  6 -  7  25 2,109.03 2.1  10.5 |==
  7 -  8  34 2,163.38 2.1  12.6 |==
  8 -  9  49 2,476.29 2.5  15.1 |==
  9 - 10  58 2,714.49 2.7  17.8 |==
 10 - 11  66 2,412.43 2.4  20.2 |==
 11 - 12  72 2,951.48 2.9  23.1 |==
 12 - 13  89 3,940.09 3.9  27.0 |===
 13 - 14  98 2,419.29 2.4  29.4 |==
 14 - 15 110 3,729.82 3.7  33.1 |===
 15 - 16 137 5,863.49 5.8  38.9 |=====
 16 - 17 168 6,214.59 6.2  45.1 |======
 17 - 18 162 4,996.00 5.0  50.0 |====
 18 - 19 189 5,372.74 5.3  55.4 |=====
 19 - 20 215 5,747.24 5.7  61.1 |=====
 20 - 21 244 5,867.44 5.8  66.9 |=====
 21 - 22 227 6,946.55 6.9  73.8 |======
 22 - 23 244 5,168.54 5.1  78.9 |=====
 23 - 24 217 5,029.98 5.0  83.9 |====
 24 - 25 177 3,672.14 3.6  87.5 |===
 25 - 26 138 2,702.43 2.7  90.2 |==
 26 - 27 132 3,517.41 3.5  93.7 |===
 27 - 28  88 1,859.86 1.8  95.5 |=
 28 - 29  64 1,592.19 1.6  97.1 |=
 29 - 30  64 1,290.15 1.3  98.4 |=
 30 - 31  50   894.34 0.9  99.3 |
 31 - 32  26   186.44 0.2  99.5 |
 32 - 33  27   246.35 0.2  99.7 |
 33 - 34  17   109.84 0.1  99.8 |
 34 - 35  15    61.66 0.1  99.9 |
 35 - 36   6     2.07 0.0  99.9 |
 36 - 37   7    89.23 0.1 100.0 |
 37 - 38   7    21.85 0.0 100.0 |
 38 - 39   2     0.24 0.0 100.0 |
 39 - 40  --       --  -- 100.0 |
 40 - 41  --       --  -- 100.0 |
 41 - 42  --       --  -- 100.0 |
 42+      --       --  -- 100.0 |
--------------------------------Page 539  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

FREQUENCY (Iter=5) ** IEEI Travel Time Frequency **
  BASEMW=2 VALUEMW=1 RANGE=0,42,1
  MW[2]                   Accum
>=  -  < Obs    Sum   Pct  Pct
---------------------------------------------------
Total Obs = 3,280
Total Sum = 100,843.68
Mean      = 17.24
@I=J      = 0

DISTRIBUTION ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 540  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:32 2016

FILEO MATO[4] = "C:\projects\Roanoke\Base\Output\IEEI_2012_NT.MAT",
 MO=34, NAME=IEEI_NT, DEC=D
FILEO MATO[3] = "C:\projects\Roanoke\Base\Output\IEEI_2012_PM.MAT",
 MO=33, NAME=IEEI_PM, DEC=D
FILEO MATO[2] = "C:\projects\Roanoke\Base\Output\IEEI_2012_MD.MAT",
 MO=32, NAME=IEEI_MD, DEC=D
FILEO MATO[1] = "C:\projects\Roanoke\Base\Output\IEEI_2012_AM.MAT",
 MO=31, NAME=IEEI_AM, DEC=D
FILEI MATI[1] = "C:\projects\Roanoke\Base\Output\IEEI_2012.MAT"
ZONES=267

;Define arrays of time of day factors
ARRAY IEFct=4
IEFct[1] = 0.03  ;AM IE Factor
IEFct[2] = 0.28   ;MD IE Factor
IEFct[3] = 0.08   ;PM IE Factor
IEFct[4] = 0.11   ;NT IE Factor

ARRAY EIFct=4
EIFct[1] = 0.16  ;AM EI Factor
EIFct[2] = 0.20   ;MD EI Factor
EIFct[3] = 0.03   ;PM EI Factor
EIFct[4] = 0.11   ;NT EI Factor

MW[1]=mi.1.1      ;IEEI Daily Trips
MW[2]=mi.1.1.T    ;IEEI Daily Trips

;  MW[11] through MW[14] are the working tables (four time periods) for IE trips
;  MW[21] through MW[24] are the working tables (four time periods) for EI trips
;  MW[31] through MW[34] are the final output tables (four time periods) for total IEEI trips.

LOOP TOD=1,4
  IETable = (10) + TOD
  MW[IETable] = MW[2] * IEFct[TOD]

  EITable = (20) + TOD
  MW[EITable] = MW[1] * EIFct[TOD]

  TODTable = (30) + TOD
  MW[TODTable] = MW[IETable] + MW[EITable]
ENDLOOP


MATRIX Stack Size = 1552 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\Output\IEEI_2012.MAT OpenedPage 541  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MAT PGM=DISTRIBUTION (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:32 2016 
ID=
PAR Zones=267 M=1
  TRIPS

M(792): ARRAY IEFCT requires 40 bytes.

M(792): ARRAY EIFCT requires 40 bytes.

Totals from Transpose:

	MI.01.001.T: 100,844

M(660): Transpose Disk Usage (bytes): Data=38,468, Index=1,068.Page 542  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  : 100,843.7
	MI.01.001.T: 100,843.7
	MW[1]      : 100,843.7
	MW[2]      : 100,843.7
	MW[11]     :   3,025.3
	MW[12]     :  28,236.2
	MW[13]     :   8,067.5
	MW[14]     :  11,092.8
	MW[21]     :  16,135  
	MW[22]     :  20,168.7
	MW[23]     :   3,025.3
	MW[24]     :  11,092.8
	MW[31]     :  19,160.3
	MW[32]     :  48,405  
	MW[33]     :  11,092.8
	MW[34]     :  22,185.6
	MO.04.001  :  22,185.6
	MO.03.001  :  11,092.8
	MO.02.001  :  48,405  
	MO.01.001  :  19,160.3

Variable Values at end of Iteration 1 I loop:

    TOD     :  5
    IETABLE : 14
    EITABLE : 24
    TODTABLE: 34

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 543  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:32 2016

FILEO MATO[4] = "C:\projects\Roanoke\Base\Output\EE_2012_NT.MAT",
MO=14, NAME=EE_NT, DEC=1*D
FILEO MATO[3] = "C:\projects\Roanoke\Base\Output\EE_2012_PM.MAT",
MO=13, NAME=EE_PM, DEC=1*D
FILEO MATO[2] = "C:\projects\Roanoke\Base\Output\EE_2012_MD.MAT",
MO=12, NAME=EE_MD, DEC=1*D
FILEO MATO[1] = "C:\projects\Roanoke\Base\Output\EE_2012_AM.MAT",
 MO=11, NAME=EE_AM, DEC=1*D
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\EE_2012.MAT"


MW[1]=mi.1.1     ;EE Daily Trips

ZONES=267

;Define arrays of time of day factors
ARRAY EEFct=4
EEFct[1] = 0.141 ;AM IE Factor
EEFct[2] = 0.458 ;MD IE Factor
EEFct[3] = 0.154 ;PM IE Factor
EEFct[4] = 0.247  ;NT IE Factor




;  MW[11] through MW[14] are the working tables (four time periods) for EE trips

LOOP TOD=1,4
  EETable = (10) + TOD
  MW[EETable] = MW[1] * EEFct[TOD]
ENDLOOP

MATRIX Stack Size = 1044 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\EE_2012.MAT Opened
MAT PGM=FRATAR (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:31 2016 
ID=
PAR Zones=267 M=1
  EE_TRIPS

M(792): ARRAY EEFCT requires 40 bytes.Page 544  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 41,786.7
	MW[1]    : 41,786.7
	MW[11]   :  5,891.9
	MW[12]   : 19,138.3
	MW[13]   :  6,435.1
	MW[14]   : 10,321.3
	MO.04.001: 10,321.3
	MO.03.001:  6,435.1
	MO.02.001: 19,138.3
	MO.01.001:  5,891.9

Variable Values at end of Iteration 1 I loop:

    TOD    :  5
    EETABLE: 14

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 545  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------
GENERATION (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:32 2016

FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\CVRATES.CSV"
FILEO PAO[1] = "C:\projects\Roanoke\Base\Output\CV_PA_2012.DBF",
FORM=10.3, DBF=T, LIST=Z, P[1], P[2], P[3], A[1], A[2], A[3]
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\se.dbf"

ZONES=206

LOOKUP, LOOKUPI=1,
 NAME=CVRates,
    LOOKUP[1]=1, RESULT=2,
    LOOKUP[2]=1, RESULT=3,
    LOOKUP[3]=1, RESULT=4,
 INTERPOLATE=N, FAIL[1]=0, FAIL[2]=0, FAIL[3]=0, LIST=Y

PHASE=ILOOP

 P[1]= (IND*CVRates(1,1))+((RET + SG_RET)*CVRates(1,2))+(HTRET*CVRates(1,3))+(OFF*CVRates(1,4))+((SER+SG_AIR+SG_COL+SG_HOS)*CVRates(1,5))+(HH*CVRates(1,6))

 P[2]= (IND*CVRates(2,1))+((RET + SG_RET)*CVRates(2,2))+(HTRET*CVRates(2,3))+(OFF*CVRates(2,4))+((SER+SG_AIR+SG_COL+SG_HOS)*CVRates(2,5))+(HH*CVRates(2,6))
 P[3]= (IND*CVRates(3,1))+((RET + SG_RET)*CVRates(3,2))+(HTRET*CVRates(3,3))+(OFF*CVRates(3,4))+((SER+SG_AIR+SG_COL+SG_HOS)*CVRates(3,5))+(HH*CVRates(3,6))

 A[1]=P[1]
  A[2]=P[2]
  A[3]=P[3]

ENDPHASE

PHASE=ADJUST
  BALANCE NHB=1
ENDPHASE


GENERATION Stack Size = 1370 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\se.dbf Opened: 205 data records  23 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)           


LOOKUP   CVRates:  FAIL=  --  --  --
         CVRates(1,1)  = 0.398
         CVRates(1,2)  = 0.051
         CVRates(1,3)  = 0.051
         CVRates(1,4)  = 0.051
         CVRates(1,5)  = 0.051
         CVRates(1,6)  = 0.166
         CVRates(2,1)  = 0.582Page 546  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------
         CVRates(2,2)  = 0.048
         CVRates(2,3)  = 0.048
         CVRates(2,4)  = 0.049
         CVRates(2,5)  = 0.02
         CVRates(2,6)  = 0.076
         CVRates(3,1)  = 0.132
         CVRates(3,2)  = 0.02
         CVRates(3,3)  = 0.02
         CVRates(3,4)  = 0.015
         CVRates(3,5)  = 0.015
         CVRates(3,6)  = 0.006


Total P/A  1  32,814  32,814
Total P/A  2  24,746  24,746
Total P/A  3   5,300   5,300

PHASE=ADJUST:

Total P/A  1  32,814  32,814
Total P/A  2  24,746  24,746
Total P/A  3   5,300   5,300

File C:\projects\Roanoke\Base\Output\CV_PA_2012.DBF opened

GENERATION ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 547  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
DISTRIBUTION (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:32 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\Output\CV_2012.MAT",
  MO=1-3, NAME=FourTire, SixTire, Combo, DEC=D
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Hwyskim.MAT"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Output\CV_PA_2012.DBF"


PAR maxiters=20 maxrmse=10

setpa  P[1]=ZI.1.P1, P[2]=ZI.1.P2, P[3]=ZI.1.P3,  ; Set P and A Fields 1-3 = 4-tire, 6-tire, and combo
   A[1]=ZI.1.A1, A[2]=ZI.1.A2, A[3]=ZI.1.A3

; Estmated Gamma Function parameters,  Define array of coefficients and poplate.
 ARRAY alpha=3
 ARRAY beta=3
 ARRAY epsilon=3

; Coefficients are set the the default NCDOT Small Area Travel Demand Model Procedures Manual
;     for all three CV types.  Further testing and calibration may be needed.
  alpha[1] = 4.6750
 beta[1] = 0.2916
 epsilon[1] = 0.1390

 alpha[2] = 4.6750
 beta[2] = 0.2916
 epsilon[2] = 0.1390

 alpha[3] = 4.6750
 beta[3] = 0.2916
 epsilon[3] = 2.4000

MW[10]=mi.1.1      ; total travel time

; First replace any 0 times with a very small travel time to avoid
;  failure of the exponentiation calculation.
JLOOP
  IF (MW[10]=0)
    MW[10]=0.0000001
    ENDIF
  ENDJLOOP

;calculate friction factor using the gamma function
LOOP CVType=1,3
  CVIDX=10+CVType
 MW[CVIDX] = alpha[CVType] * (MW[10]^beta[CVType]) * EXP(epsilon[CVType]*MW[10])
 ENDLOOP

;apply the results of gamma formulation
LOOP PURP= 1, 3
  CVIDX=10+PURP
 PAF=0
 MW[PURP] = A[PURP] * MW[CVIDX]
 ATTRSUM=ROWSUM(PURP)Page 548  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
 IF (ATTRSUM>0) PAF=P[PURP]/ATTRSUM
 MW[PURP]=PAF * MW[PURP]
ENDLOOP

; ========GENERATE FREQUENCY REPORTS BASED ON TIME============
FREQUENCY VALUEMW=1 BASEMW=10, RANGE=0-42,
TITLE='** CV 4-Tire Travel Time Frequency **'

FREQUENCY VALUEMW=2 BASEMW=10, RANGE=0-42,
TITLE='** SUT 6-Tire Travel Time Frequency **'

FREQUENCY VALUEMW=3 BASEMW=10, RANGE=0-42,
TITLE='** MUT Combo Travel Time Frequency **'


DISTRIBUTION Stack Size = 2236 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:31 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME

FILEI ZDATI=C:\projects\Roanoke\Base\Output\CV_PA_2012.DBF Opened: 206 data records  7 Fields:
Z(N)            P1(N)           P2(N)           P3(N)           A1(N)          
A2(N)           A3(N)          


M(792): ARRAY ALPHA requires 32 bytes.

M(792): ARRAY BETA requires 32 bytes.

M(792): ARRAY EPSILON requires 32 bytes.Page 549  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

Totals after Iteration 1 I loop:

	MI.01.001:                 624,321.47     @J=I:                     114.87  
	MW[1]    :                  32,814.354    @J=I:                      17.0986
	MW[2]    :                  24,745.767    @J=I:                      19.2541
	MW[3]    :                   5,299.9      @J=I:                       0     
	MW[10]   :                 624,321.4722   @J=I:                     114.87  
	MW[11]   :               5,196,970.2572   @J=I:                     810.392 
	MW[12]   :               5,196,970.2572   @J=I:                     810.392 
	MW[13]   :      3.0420865314495274e+044   @J=I:                  60,104.2156

Variable Values at end of Iteration 1 I loop:

    CVTYPE :                       4
    CVIDX  :                      13
    PURP   :                       4
    ATTRSUM: 1.6861999127547927e+039Page 550  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 2
--------------------

Totals after Iteration 2 I loop:

	MI.01.001:                 624,321.47     @J=I:                     114.87  
	MW[1]    :                  32,814.354    @J=I:                      24.2888
	MW[2]    :                  24,745.767    @J=I:                      26.3625
	MW[3]    :                   5,299.9      @J=I:                       0     
	MW[10]   :                 624,321.4722   @J=I:                     114.87  
	MW[11]   :               5,196,970.2572   @J=I:                     810.392 
	MW[12]   :               5,196,970.2572   @J=I:                     810.392 
	MW[13]   :      3.0420865314495274e+044   @J=I:                  60,104.2156

Variable Values at end of Iteration 2 I loop:

    CVTYPE :                       4
    CVIDX  :                      13
    PURP   :                       4
    ATTRSUM: 2.3506590561253248e+039Page 551  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 3
--------------------

Totals after Iteration 3 I loop:

	MI.01.001:                 624,321.47      @J=I:                     114.87   
	MW[1]    :                  32,814.354     @J=I:                      24.37592
	MW[2]    :                  24,745.767     @J=I:                      26.38422
	MW[3]    :                   5,299.9       @J=I:                       0.00001
	MW[10]   :                 624,321.47225   @J=I:                     114.87001
	MW[11]   :               5,196,970.25722   @J=I:                     810.39201
	MW[12]   :               5,196,970.25722   @J=I:                     810.39201
	MW[13]   :       3.0420865314495274e+044   @J=I:                  60,104.2156 

Variable Values at end of Iteration 3 I loop:

    CVTYPE :                       4
    CVIDX  :                      13
    PURP   :                       4
    ATTRSUM: 4.4162590101071035e+039Page 552  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 4
--------------------

Totals after Iteration 4 I loop:

	MI.01.001:                 624,321.47      @J=I:                     114.87   
	MW[1]    :                  32,814.354     @J=I:                      24.37944
	MW[2]    :                  24,745.767     @J=I:                      26.38241
	MW[3]    :                   5,299.9       @J=I:                       0.00001
	MW[10]   :                 624,321.47225   @J=I:                     114.87001
	MW[11]   :               5,196,970.25722   @J=I:                     810.39201
	MW[12]   :               5,196,970.25722   @J=I:                     810.39201
	MW[13]   :       3.0420865314495274e+044   @J=I:                  60,104.2156 

Variable Values at end of Iteration 4 I loop:

    CVTYPE :                       4
    CVIDX  :                      13
    PURP   :                       4
    ATTRSUM: 5.2988925629291475e+039Page 553  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 5
--------------------

Totals after Iteration 5 I loop:

	MI.01.001:                 624,321.47      @J=I:                     114.87   
	MW[1]    :                  32,814.354     @J=I:                      24.37977
	MW[2]    :                  24,745.767     @J=I:                      26.38225
	MW[3]    :                   5,299.9       @J=I:                       0.00001
	MW[10]   :                 624,321.47225   @J=I:                     114.87001
	MW[11]   :               5,196,970.25722   @J=I:                     810.39201
	MW[12]   :               5,196,970.25722   @J=I:                     810.39201
	MW[13]   :       3.0420865314495274e+044   @J=I:                  60,104.2156 

Variable Values at end of Iteration 5 I loop:

    CVTYPE :                       4
    CVIDX  :                      13
    PURP   :                       4
    ATTRSUM: 5.1691561195042167e+039Page 554  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 6
--------------------

Totals after Iteration 6 I loop:

	MI.01.001:                 624,321.47      @J=I:                     114.87   
	MW[1]    :                  32,814.354     @J=I:                      24.3798 
	MW[2]    :                  24,745.767     @J=I:                      26.38224
	MW[3]    :                   5,299.9       @J=I:                       0.00002
	MW[10]   :                 624,321.47225   @J=I:                     114.87001
	MW[11]   :               5,196,970.25722   @J=I:                     810.39201
	MW[12]   :               5,196,970.25722   @J=I:                     810.39201
	MW[13]   :       3.0420865314495274e+044   @J=I:                  60,104.2156 

Variable Values at end of Iteration 6 I loop:

    CVTYPE :                       4
    CVIDX  :                      13
    PURP   :                       4
    ATTRSUM: 4.7139134024765766e+039

RMSE  MW=  1       2       3
----------------------------
 1    102.19   80.70  173.00
 2      2.23    1.92   31.76
 3      0.14    0.16   20.25
 4      0.00    0.00   15.18
 5      0.00    0.00   11.67
 6      0.00    0.00    9.40Page 555  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 6
--------------------

Totals after Iteration 6 I loop:

	MI.01.001:                 624,321.47      @J=I:                     114.87   
	MW[1]    :                  32,814.354     @J=I:                      24.37981
	MW[2]    :                  24,745.767     @J=I:                      26.38224
	MW[3]    :                   5,299.9       @J=I:                       0.00002
	MW[10]   :                 624,321.47225   @J=I:                     114.87001
	MW[11]   :               5,196,970.25722   @J=I:                     810.39201
	MW[12]   :               5,196,970.25722   @J=I:                     810.39201
	MW[13]   :       3.0420865314495274e+044   @J=I:                  60,104.2156 
	MO.01.001:                  32,814.354  
	MO.01.002:                  24,748.53   
	MO.01.003:                   5,296.03   

Variable Values at end of Iteration 6 I loop:

    CVTYPE :                       4
    CVIDX  :                      13
    PURP   :                       4
    ATTRSUM: 4.2363226241556733e+039

RMSE  MW=  1       2       3
----------------------------
 1    102.19   80.70  173.00
 2      2.23    1.92   31.76
 3      0.14    0.16   20.25
 4      0.00    0.00   15.18
 5      0.00    0.00   11.67
 6      0.00    0.00    8.01Page 556  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

FREQUENCY (Iter=6) ** CV 4-Tire Travel Time Frequency **
  BASEMW=10 VALUEMW=1 RANGE=0,42,1
 MW[10]                     Accum
>=  -  <  Obs     Sum   Pct  Pct
--------------------------------------------------------
  0 -  1   565    74.40 0.2   0.2 |
  1 -  2   697   138.21 0.4   0.6 |
  2 -  3 1,111   329.65 1.0   1.7 |=
  3 -  4 1,443   548.99 1.7   3.3 |=
  4 -  5 1,835   838.03 2.6   5.9 |==
  5 -  6 2,092 1,207.62 3.7   9.6 |===
  6 -  7 2,300 1,548.32 4.7  14.3 |====
  7 -  8 2,471 1,807.40 5.5  19.8 |=====
  8 -  9 2,635 2,118.94 6.5  26.2 |======
  9 - 10 2,763 2,560.68 7.8  34.0 |=======
 10 - 11 2,690 2,629.43 8.0  42.1 |========
 11 - 12 2,758 2,683.96 8.2  50.2 |========
 12 - 13 2,600 2,558.98 7.8  58.0 |=======
 13 - 14 2,442 2,359.40 7.2  65.2 |=======
 14 - 15 2,205 2,222.97 6.8  72.0 |======
 15 - 16 2,037 1,880.68 5.7  77.7 |=====
 16 - 17 1,794 1,547.79 4.7  82.5 |====
 17 - 18 1,463 1,345.34 4.1  86.5 |====
 18 - 19 1,339 1,003.92 3.1  89.6 |===
 19 - 20 1,080   840.56 2.6  92.2 |==
 20 - 21   942   759.33 2.3  94.5 |==
 21 - 22   692   486.36 1.5  96.0 |=
 22 - 23   599   404.73 1.2  97.2 |=
 23 - 24   473   351.19 1.1  98.3 |=
 24 - 25   300   196.33 0.6  98.9 |
 25 - 26   201   116.04 0.4  99.2 |
 26 - 27   154    88.34 0.3  99.5 |
 27 - 28   113    66.03 0.2  99.7 |
 28 - 29    62    32.48 0.1  99.8 |
 29 - 30    63    24.62 0.1  99.9 |
 30 - 31    56    23.79 0.1  99.9 |
 31 - 32    18     8.03 0.0 100.0 |
 32 - 33     9     2.59 0.0 100.0 |
 33 - 34     7     2.82 0.0 100.0 |
 34 - 35    14     5.51 0.0 100.0 |
 35 - 36     2     0.90 0.0 100.0 |
 36 - 37    --       --  -- 100.0 |
 37 - 38    --       --  -- 100.0 |
 38 - 39    --       --  -- 100.0 |
 39 - 40    --       --  -- 100.0 |
 40 - 41    --       --  -- 100.0 |
 41 - 42    --       --  -- 100.0 |
 42+        --       --  -- 100.0 |
----------------------------------Page 557  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

FREQUENCY (Iter=6) ** CV 4-Tire Travel Time Frequency **
  BASEMW=10 VALUEMW=1 RANGE=0,42,1
 MW[10]                     Accum
>=  -  <  Obs     Sum   Pct  Pct
--------------------------------------------------------
Total Obs = 42,025
Total Sum = 32,814.35
Mean      = 12.35
@I=J      = 24.38Page 558  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

FREQUENCY (Iter=6) ** SUT 6-Tire Travel Time Frequency **
  BASEMW=10 VALUEMW=2 RANGE=0,42,1
 MW[10]                     Accum
>=  -  <  Obs     Sum   Pct  Pct
---------------------------------------------------------
  0 -  1   565    66.71 0.3   0.3 |
  1 -  2   697   109.07 0.4   0.7 |
  2 -  3 1,111   241.85 1.0   1.7 |
  3 -  4 1,443   407.33 1.6   3.3 |=
  4 -  5 1,835   603.20 2.4   5.8 |==
  5 -  6 2,092   918.29 3.7   9.5 |===
  6 -  7 2,300 1,139.13 4.6  14.1 |====
  7 -  8 2,471 1,298.91 5.2  19.3 |=====
  8 -  9 2,635 1,554.73 6.3  25.6 |======
  9 - 10 2,763 2,067.90 8.4  34.0 |========
 10 - 11 2,690 2,067.99 8.4  42.3 |========
 11 - 12 2,758 2,143.11 8.7  51.0 |========
 12 - 13 2,600 1,955.11 7.9  58.9 |=======
 13 - 14 2,442 1,781.76 7.2  66.1 |=======
 14 - 15 2,205 1,678.56 6.8  72.9 |======
 15 - 16 2,037 1,412.02 5.7  78.6 |=====
 16 - 17 1,794 1,170.93 4.7  83.3 |====
 17 - 18 1,463 1,020.18 4.1  87.4 |====
 18 - 19 1,339   706.77 2.9  90.3 |==
 19 - 20 1,080   635.33 2.6  92.9 |==
 20 - 21   942   548.30 2.2  95.1 |==
 21 - 22   692   318.73 1.3  96.4 |=
 22 - 23   599   275.77 1.1  97.5 |=
 23 - 24   473   243.83 1.0  98.5 |
 24 - 25   300   135.68 0.5  99.0 |
 25 - 26   201    73.67 0.3  99.3 |
 26 - 27   154    60.21 0.2  99.6 |
 27 - 28   113    44.48 0.2  99.7 |
 28 - 29    62    19.07 0.1  99.8 |
 29 - 30    63    16.98 0.1  99.9 |
 30 - 31    56    16.53 0.1  99.9 |
 31 - 32    18     5.98 0.0 100.0 |
 32 - 33     9     1.52 0.0 100.0 |
 33 - 34     7     1.93 0.0 100.0 |
 34 - 35    14     3.40 0.0 100.0 |
 35 - 36     2     0.81 0.0 100.0 |
 36 - 37    --       --  -- 100.0 |
 37 - 38    --       --  -- 100.0 |
 38 - 39    --       --  -- 100.0 |
 39 - 40    --       --  -- 100.0 |
 40 - 41    --       --  -- 100.0 |
 41 - 42    --       --  -- 100.0 |
 42+        --       --  -- 100.0 |
----------------------------------Page 559  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

FREQUENCY (Iter=6) ** SUT 6-Tire Travel Time Frequency **
  BASEMW=10 VALUEMW=2 RANGE=0,42,1
 MW[10]                     Accum
>=  -  <  Obs     Sum   Pct  Pct
---------------------------------------------------------
Total Obs = 42,025
Total Sum = 24,745.77
Mean      = 12.27
@I=J      = 26.38Page 560  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

FREQUENCY (Iter=6) ** MUT Combo Travel Time Frequency **
  BASEMW=10 VALUEMW=3 RANGE=0,42,1
 MW[10]                    Accum
>=  -  <  Obs    Sum   Pct  Pct
--------------------------------------------------------
  0 -  1   565   0.00  0.0   0.0 |
  1 -  2   697   0.00  0.0   0.0 |
  2 -  3 1,111   0.02  0.0   0.0 |
  3 -  4 1,443   0.41  0.0   0.0 |
  4 -  5 1,835   4.68  0.1   0.1 |
  5 -  6 2,092  38.05  0.7   0.8 |
  6 -  7 2,300 123.25  2.3   3.1 |==
  7 -  8 2,471 139.19  2.6   5.8 |==
  8 -  9 2,635 185.38  3.5   9.3 |===
  9 - 10 2,763 354.36  6.7  16.0 |======
 10 - 11 2,690 431.28  8.1  24.1 |========
 11 - 12 2,758 489.95  9.2  33.3 |=========
 12 - 13 2,600 549.85 10.4  43.7 |==========
 13 - 14 2,442 532.74 10.1  53.8 |==========
 14 - 15 2,205 514.39  9.7  63.5 |=========
 15 - 16 2,037 436.90  8.2  71.7 |========
 16 - 17 1,794 337.48  6.4  78.1 |======
 17 - 18 1,463 307.67  5.8  83.9 |=====
 18 - 19 1,339 204.94  3.9  87.7 |===
 19 - 20 1,080 171.84  3.2  91.0 |===
 20 - 21   942 155.92  2.9  93.9 |==
 21 - 22   692  84.58  1.6  95.5 |=
 22 - 23   599  81.87  1.5  97.1 |=
 23 - 24   473  62.26  1.2  98.2 |=
 24 - 25   300  35.71  0.7  98.9 |
 25 - 26   201  16.94  0.3  99.2 |
 26 - 27   154  14.84  0.3  99.5 |
 27 - 28   113  10.28  0.2  99.7 |
 28 - 29    62   4.21  0.1  99.8 |
 29 - 30    63   4.40  0.1  99.9 |
 30 - 31    56   3.18  0.1  99.9 |
 31 - 32    18   1.77  0.0 100.0 |
 32 - 33     9   0.24  0.0 100.0 |
 33 - 34     7   0.37  0.0 100.0 |
 34 - 35    14   0.60  0.0 100.0 |
 35 - 36     2   0.34  0.0 100.0 |
 36 - 37    --     --   -- 100.0 |
 37 - 38    --     --   -- 100.0 |
 38 - 39    --     --   -- 100.0 |
 39 - 40    --     --   -- 100.0 |
 40 - 41    --     --   -- 100.0 |
 41 - 42    --     --   -- 100.0 |
 42+        --     --   -- 100.0 |
---------------------------------Page 561  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

FREQUENCY (Iter=6) ** MUT Combo Travel Time Frequency **
  BASEMW=10 VALUEMW=3 RANGE=0,42,1
 MW[10]                    Accum
>=  -  <  Obs    Sum   Pct  Pct
--------------------------------------------------------
Total Obs = 42,025
Total Sum = 5,299.9
Mean      = 14.01
@I=J      = 0

DISTRIBUTION ReturnCode = 0  Elapsed Time = 00:00:02
################################################################################
Page 562  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:34 2016

FILEO MATO[4] = "C:\projects\Roanoke\Base\Output\CV_2012_NT.MAT",
 MO=41-43, NAME=CV_NT, SUT_NT, MUT_NT, DEC=D
FILEO MATO[3] = "C:\projects\Roanoke\Base\Output\CV_2012_PM.MAT",
 MO=31-33, NAME=CV_PM, SUT_PM, MUT_PM, DEC=D
FILEO MATO[2] = "C:\projects\Roanoke\Base\Output\CV_2012_MD.MAT",
 MO=21-23, NAME=CV_MD, SUT_MD, MUT_MD, DEC=D
FILEO MATO[1] = "C:\projects\Roanoke\Base\Output\CV_2012_AM.MAT",
 MO=11-13, NAME=CV_AM, SUT_AM, MUT_AM, DEC=D
FILEI MATI[1] = "C:\projects\Roanoke\Base\Output\CV_2012.MAT"

ZONES=267

;Define array of time of day factors
;Note that time of day factors for CV trips are the same for PA as AP trips.
;  So rather than apply a PA TOD and an AP TOD and then recombining the table
;  by time period we can simply apply double the PA (or AP)TOD rate.

ARRAY TODFct=4
TODFct[1] = 0.0458 * 2  ;AM Factor
TODFct[2] = 0.1652 * 2  ;MD Factor
TODFct[3] = 0.1634 * 2  ;PM Factor
TODFct[4] = 0.1256 * 2  ;NT Factor

MW[1]=mi.1.1      ;CV  Daily Trips
MW[2]=mi.1.2      ;SUT Daily Trips
MW[3]=mi.1.3      ;MUT Daily Trips

LOOP TOD=1,4
  LOOP CVType=1,3
     TODTable = (10*TOD)+ CVType
    MW[TODTable] = MW[CVType] * TODFct[TOD]
  ENDLOOP
ENDLOOP

MATRIX Stack Size = 1426 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\Output\CV_2012.MAT Opened
MAT PGM=DISTRIBUTION (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:32 2016 
ID=
PAR Zones=267 M=3
  FourTire  SixTire  Combo

M(792): ARRAY TODFCT requires 40 bytes.Page 563  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 32,814.354     @J=I:     24.37981
	MI.01.002: 24,748.53      @J=I:     26.31   
	MI.01.003:  5,296.03   
	MW[1]    : 32,814.354     @J=I:     24.37981
	MW[2]    : 24,748.53      @J=I:     26.31   
	MW[3]    :  5,296.03   
	MW[11]   :  3,005.79483   @J=I:      2.23319
	MW[12]   :  2,266.96535   @J=I:      2.41   
	MW[13]   :    485.11635
	MW[21]   : 10,841.86256   @J=I:      8.05509
	MW[22]   :  8,176.91431   @J=I:      8.69282
	MW[23]   :  1,749.80831
	MW[31]   : 10,723.73089   @J=I:      7.96732
	MW[32]   :  8,087.8196    @J=I:      8.59811
	MW[33]   :  1,730.7426 
	MW[41]   :  8,242.96572   @J=I:      6.12421
	MW[42]   :  6,216.83074   @J=I:      6.60907
	MW[43]   :  1,330.36274
	MO.04.001:  8,242.96572
	MO.04.002:  6,248.31   
	MO.04.003:  1,340.55   
	MO.03.001: 10,723.73089
	MO.03.002:  8,099.08   
	MO.03.003:  1,731.02   
	MO.02.001: 10,841.86256
	MO.02.002:  8,190.91   
	MO.02.003:  1,749.54   
	MO.01.001:  3,005.79483
	MO.01.002:  2,262.1    
	MO.01.003:    477.37   

Variable Values at end of Iteration 1 I loop:

    TOD     :  5
    CVTYPE  :  4
    TODTABLE: 43

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\CV_TLFD.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:34 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 575  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:34 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\pk_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\PK_FreeFlow_Skim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1332 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\PK_FreeFlow_Skim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Sun Mar 27 18:50:23 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 576  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,624,321.47   @J=I:     23,000,114.87
	MI.01.002: 22,402,468,534.04
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,833,939.47   @J=I:     23,000,792.87
	MW[1]    : 22,425,624,321.47   @J=I:     23,000,114.87
	MW[2]    : 22,402,468,534.04
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,833,939.47   @J=I:     23,000,792.87
	MW[11]   :        624,321.47   @J=I:            114.87
	MW[12]   :        468,534.04
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        769,739.47   @J=I:            782.87
	MO.01.001:        624,321.47
	MO.01.002:        468,534.04
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        769,739.47

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 577  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:34 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_FreeFlow_Skim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1332 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\OP_FreeFlow_Skim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Sun Mar 27 18:50:23 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 578  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,624,321.47   @J=I:     23,000,114.87
	MI.01.002: 22,402,468,534.04
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,833,939.47   @J=I:     23,000,792.87
	MW[1]    : 22,425,624,321.47   @J=I:     23,000,114.87
	MW[2]    : 22,402,468,534.04
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,833,939.47   @J=I:     23,000,792.87
	MW[11]   :        624,321.47   @J=I:            114.87
	MW[12]   :        468,534.04
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        769,739.47   @J=I:            782.87
	MO.01.001:        624,321.47
	MO.01.002:        468,534.04
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        769,739.47

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBW_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:35 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBO_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:36 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\NHB_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:37 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBSC_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:38 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\TDMAT00C.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:39 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\HBSC_distribution.PRN. 
DISTRIBUTION (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:39 2016
DISTRIBUTION ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_D2D_Flwos.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:39 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_noSchoolTrips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:39 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\PARAMS\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:39 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 638  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 639  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 640  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:35 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:34 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 641  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,555.672    @J=I:         44.3457
	MI.02.DISTANCE:    468,534.04  
	MW[1]         :    -27,555.672    @J=I:         44.3457
	MW[2]         :    461,202.46  
	MW[100]       :    232,184.5039   @J=I:      1,137.4991
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     97,999.215 
	MW[115]       :     -7,308.6   
	MW[116]       :              --
	MW[200]       :    117,677.504    @J=I:      1,890.7326
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 1,890.73259

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 642  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:40 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:39 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,493, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 643  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      1,890.7
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      1,890.7
	MW[1]      :    117,677.5   @J=I:      1,890.7
	MW[2]      :    117,677.5   @J=I:      1,890.7
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_1.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:40 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 644  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 645  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 646  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:35 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:34 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 647  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,555.672    @J=I:         44.3457
	MI.02.DISTANCE:    468,534.04  
	MW[1]         :    -27,555.672    @J=I:         44.3457
	MW[2]         :    461,202.46  
	MW[100]       :    239,195.9239   @J=I:      1,163.7591
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     97,999.215 
	MW[115]       :     -7,308.6   
	MW[116]       :      7,011.42     @J=I:         26.26  
	MW[200]       :    117,677.504    @J=I:      1,946.0103
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 1,946.01028

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 648  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:40 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:40 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,657, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 649  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      1,946  
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      1,946  
	MW[1]      :    117,677.5   @J=I:      1,946  
	MW[2]      :    117,677.5   @J=I:      1,946  
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_2.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:41 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 650  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 651  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 652  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:35 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:34 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 653  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,555.672    @J=I:         44.3457
	MI.02.DISTANCE:    468,534.04  
	MW[1]         :    -27,555.672    @J=I:         44.3457
	MW[2]         :    461,202.46  
	MW[100]       :    246,036.4639   @J=I:      1,189.3791
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     97,999.215 
	MW[115]       :     -7,308.6   
	MW[116]       :     13,851.96     @J=I:         51.88  
	MW[200]       :    117,677.504    @J=I:      1,981.6839
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 1,981.68386

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 654  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:41 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:41 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,757, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 655  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      1,981.7
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      1,981.7
	MW[1]      :    117,677.5   @J=I:      1,981.7
	MW[2]      :    117,677.5   @J=I:      1,981.7
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_3.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:41 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 656  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 657  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 658  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:35 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:34 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 659  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,555.672    @J=I:         44.3457
	MI.02.DISTANCE:    468,534.04  
	MW[1]         :    -27,555.672    @J=I:         44.3457
	MW[2]         :    461,202.46  
	MW[100]       :    252,748.8439   @J=I:      1,214.5191
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     97,999.215 
	MW[115]       :     -7,308.6   
	MW[116]       :     20,564.34     @J=I:         77.02  
	MW[200]       :    117,677.504    @J=I:      2,003.9769
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,003.97686

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 660  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:42 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:41 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,840, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 661  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,004  
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,004  
	MW[1]      :    117,677.5   @J=I:      2,004  
	MW[2]      :    117,677.5   @J=I:      2,004  
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_4.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:42 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 662  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 663  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 664  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:35 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:34 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 665  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,555.672    @J=I:         44.3457
	MI.02.DISTANCE:    468,534.04  
	MW[1]         :    -27,555.672    @J=I:         44.3457
	MW[2]         :    461,202.46  
	MW[100]       :    259,407.8239   @J=I:      1,239.4591
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     97,999.215 
	MW[115]       :     -7,308.6   
	MW[116]       :     27,223.32     @J=I:        101.96  
	MW[200]       :    117,677.504    @J=I:      2,018.1934
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,018.19339

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 666  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:42 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:42 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,899, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 667  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,018.2
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,018.2
	MW[1]      :    117,677.5   @J=I:      2,018.2
	MW[2]      :    117,677.5   @J=I:      2,018.2
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_5.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:42 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 668  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 669  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 670  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:35 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:34 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 671  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,555.672    @J=I:         44.3457
	MI.02.DISTANCE:    468,534.04  
	MW[1]         :    -27,555.672    @J=I:         44.3457
	MW[2]         :    461,202.46  
	MW[100]       :    266,251.0339   @J=I:      1,265.0891
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     97,999.215 
	MW[115]       :     -7,308.6   
	MW[116]       :     34,066.53     @J=I:        127.59  
	MW[200]       :    117,677.504    @J=I:      2,024.8586
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,024.85864

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 672  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:43 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:42 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,902, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 673  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,024.9
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,024.9
	MW[1]      :    117,677.5   @J=I:      2,024.9
	MW[2]      :    117,677.5   @J=I:      2,024.9
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_6.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:43 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 674  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 675  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 676  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:35 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:34 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 677  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,555.672    @J=I:         44.3457
	MI.02.DISTANCE:    468,534.04  
	MW[1]         :    -27,555.672    @J=I:         44.3457
	MW[2]         :    461,202.46  
	MW[100]       :    273,016.8139   @J=I:      1,290.4291
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     97,999.215 
	MW[115]       :     -7,308.6   
	MW[116]       :     40,832.31     @J=I:        152.93  
	MW[200]       :    117,677.504    @J=I:      2,030.5411
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,030.54108

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 678  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:43 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:43 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,938, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 679  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,030.5
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,030.5
	MW[1]      :    117,677.5   @J=I:      2,030.5
	MW[2]      :    117,677.5   @J=I:      2,030.5
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_7.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:43 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 680  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 681  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 682  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:35 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:34 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 683  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,555.672    @J=I:         44.3457
	MI.02.DISTANCE:    468,534.04  
	MW[1]         :    -27,555.672    @J=I:         44.3457
	MW[2]         :    461,202.46  
	MW[100]       :    279,747.8839   @J=I:      1,315.6391
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     97,999.215 
	MW[115]       :     -7,308.6   
	MW[116]       :     47,563.38     @J=I:        178.14  
	MW[200]       :    117,677.504    @J=I:      2,032.5525
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,032.55254

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 684  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:44 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:43 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,919, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 685  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,032.6
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,032.6
	MW[1]      :    117,677.5   @J=I:      2,032.6
	MW[2]      :    117,677.5   @J=I:      2,032.6
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_8.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:44 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 686  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 687  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 688  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:35 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:34 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 689  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,555.672    @J=I:         44.3457
	MI.02.DISTANCE:    468,534.04  
	MW[1]         :    -27,555.672    @J=I:         44.3457
	MW[2]         :    461,202.46  
	MW[100]       :    286,484.2939   @J=I:      1,340.8691
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     97,999.215 
	MW[115]       :     -7,308.6   
	MW[116]       :     54,299.79     @J=I:        203.37  
	MW[200]       :    117,677.504    @J=I:      2,034.0943
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,034.09431

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 690  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:44 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:44 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,923, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 691  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,034.1
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,034.1
	MW[1]      :    117,677.5   @J=I:      2,034.1
	MW[2]      :    117,677.5   @J=I:      2,034.1
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_9.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:44 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 692  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 693  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 694  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:35 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:34 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 695  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,555.672    @J=I:         44.3457
	MI.02.DISTANCE:    468,534.04  
	MW[1]         :    -27,555.672    @J=I:         44.3457
	MW[2]         :    461,202.46  
	MW[100]       :    293,226.0439   @J=I:      1,366.1191
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     97,999.215 
	MW[115]       :     -7,308.6   
	MW[116]       :     61,041.54     @J=I:        228.62  
	MW[200]       :    117,677.504    @J=I:      2,034.5762
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,034.57625

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 696  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:45 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:44 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,954, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 697  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,034.6
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,034.6
	MW[1]      :    117,677.5   @J=I:      2,034.6
	MW[2]      :    117,677.5   @J=I:      2,034.6
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_10.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBO.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:45 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:45 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:45 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:46 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBSH.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:46 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:46 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:46 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:46 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_NHB.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:46 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:47 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:47 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:47 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_tlfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:47 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_ttfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:47 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_d2d_flows.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:47 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 742  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:47 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT",
 MO = 1, NAME = HBO_HBSH
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT"

MW[1] = MI.1.1 + MI.2.1


MATRIX Stack Size = 344 bytes.
................................................................................


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:46 2016 
ID=
PAR Zones=267 M=1
  HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:45 2016 
ID=
PAR Zones=267 M=1
  HBO

Totals after Iteration 1 I loop:

	MI.02.001: 136,095   @J=I:  11,937
	MI.01.001: 264,074   @J=I:  60,845
	MW[1]    : 400,170   @J=I:  72,782
	MO.01.001: 400,173

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 743  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:47 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 744  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2804 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:44 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:35 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 745  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 117,677.504    @J=I:   2,034.5762
	MI.01.001:  58,634.7899   @J=I:     182.5157
	MI.01.002:   5,644.763    @J=I:      17.5708
	MI.01.003:   1,029.6903
	MI.01.004:           --
	MI.01.005:   5,979.7569   @J=I:      66.9135
	MI.01.006:  59,539.6053   @J=I:     182.5157
	MI.01.007:   5,731.8694   @J=I:      17.5708
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   6,017.5253   @J=I:      66.9135
	MW[1]    : 117,677.504    @J=I:   2,034.5762
	MW[2]    :  36,589.4029   @J=I:     693.8369
	MW[3]    :  81,088.1011   @J=I:   1,340.7393
	MW[11]   :  58,634.7899   @J=I:     182.5157
	MW[12]   :   5,644.763    @J=I:      17.5708
	MW[13]   :   1,029.6903
	MW[14]   :           --
	MW[15]   :   5,979.7569   @J=I:      66.9135
	MW[16]   :  59,539.6053   @J=I:     182.5157
	MW[17]   :   5,731.8694   @J=I:      17.5708
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   6,017.5253   @J=I:      66.9135
	MW[21]   : 103,281.1717   @J=I:   1,381.2837
	MW[22]   :   9,942.8638   @J=I:     132.976 
	MW[23]   :   3,129.8855
	MW[24]   :           --
	MW[25]   :   1,323.583    @J=I:     520.3166
	MO.01.001: 103,284.46  
	MO.01.002:   9,942.96  
	MO.01.003:   3,128.53  
	MO.01.005:   1,318.26  

Variable Values at end of Iteration 1 I loop:

    EDA: 103,281.2
    ESR:   9,942.9
    ELB:   3,129.9
    ENM:   1,323.6
    TRN:   3,129.9
    AUT: 113,224  
    TOT: 117,677.5

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################
Page 746  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:48 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 747  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2808 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:47 2016 
ID=
PAR Zones=267 M=1
  HBO_HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:36 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 748  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 400,173.14     @J=I:  72,781.93  
	MI.01.001:  30,511.9309   @J=I:      83.9684
	MI.01.002:  31,529.3161   @J=I:      86.7683
	MI.01.003:     210.9401
	MI.01.004:           --
	MI.01.005:   9,036.8129   @J=I:      96.2633
	MI.01.006:  30,608.2137   @J=I:      83.9684
	MI.01.007:  31,628.8094   @J=I:      86.7683
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   9,051.9769   @J=I:      96.2633
	MW[1]    : 400,173.14     @J=I:  72,781.93  
	MW[2]    : 154,835.918    @J=I:  25,084.08  
	MW[3]    : 245,337.222    @J=I:  47,697.85  
	MW[11]   :  30,511.9309   @J=I:      83.9684
	MW[12]   :  31,529.3161   @J=I:      86.7683
	MW[13]   :     210.9401
	MW[14]   :           --
	MW[15]   :   9,036.8129   @J=I:      96.2633
	MW[16]   :  30,608.2137   @J=I:      83.9684
	MW[17]   :  31,628.8094   @J=I:      86.7683
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   9,051.9769   @J=I:      96.2633
	MW[21]   : 170,395.7464   @J=I:  22,813.4199
	MW[22]   : 176,077.3966   @J=I:  23,574.1071
	MW[23]   :   2,277.4495
	MW[24]   :           --
	MW[25]   :  51,422.5474   @J=I:  26,394.403 
	MO.01.001: 170,388.44  
	MO.01.002: 176,090.23  
	MO.01.003:   2,276.42  
	MO.01.005:  51,415.87  

Variable Values at end of Iteration 1 I loop:

    EDA: 170,395.7
    ESR: 176,077.4
    ELB:   2,277.4
    ENM:  51,422.5
    TRN:   2,277.4
    AUT: 346,473.1
    TOT: 400,173.1

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 749  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:48 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 750  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2804 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:46 2016 
ID=
PAR Zones=267 M=1
  NHB

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:37 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 751  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 315,086.909    @J=I:  72,980.9804
	MI.01.001:  35,013.9807   @J=I:     118.4468
	MI.01.002:  32,744.9067   @J=I:     110.7709
	MI.01.003:      98.6595
	MI.01.004:           --
	MI.01.005:   3,431.4531   @J=I:      37.7823
	MI.01.006:  35,063.594    @J=I:     118.4468
	MI.01.007:  32,791.3049   @J=I:     110.7709
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   3,434.1011   @J=I:      37.7823
	MW[1]    : 315,086.909    @J=I:  72,980.9804
	MW[2]    : 124,114.9369   @J=I:  27,516.4639
	MW[3]    : 190,971.9721   @J=I:  45,464.5166
	MW[11]   :  35,013.9807   @J=I:     118.4468
	MW[12]   :  32,744.9067   @J=I:     110.7709
	MW[13]   :      98.6595
	MW[14]   :           --
	MW[15]   :   3,431.4531   @J=I:      37.7823
	MW[16]   :  35,063.594    @J=I:     118.4468
	MW[17]   :  32,791.3049   @J=I:     110.7709
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   3,434.1011   @J=I:      37.7823
	MW[21]   : 154,785.0496   @J=I:  32,312.1996
	MW[22]   : 144,754.2356   @J=I:  30,218.214 
	MW[23]   :     870.9046
	MW[24]   :           --
	MW[25]   :  14,676.7192   @J=I:  10,450.5668
	MO.01.001: 154,788.05  
	MO.01.002: 144,757.67  
	MO.01.003:     866.49  
	MO.01.005:  14,670.16  

Variable Values at end of Iteration 1 I loop:

    EDA: 154,785.05 
    ESR: 144,754.236
    ELB:     870.905
    ENM:  14,676.719
    TRN:     870.905
    AUT: 299,539.285
    TOT: 315,086.909

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 752  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:48 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 753  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2822 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:39 2016 
ID=
PAR Zones=267 M=1
  HBSC

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:50:38 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 754  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001:  7,670.59     @J=I:    987.4   
	MI.01.001: 35,013.9807   @J=I:    118.4468
	MI.01.002: 32,744.9067   @J=I:    110.7709
	MI.01.003:     98.6595
	MI.01.004:          --
	MI.01.005:  3,431.4531   @J=I:     37.7823
	MI.01.006: 35,063.594    @J=I:    118.4468
	MI.01.007: 32,791.3049   @J=I:    110.7709
	MI.01.008:          --
	MI.01.009:          --
	MI.01.010:  3,434.1011   @J=I:     37.7823
	MW[1]    :  7,670.59     @J=I:    987.4   
	MW[2]    :  2,608.9444   @J=I:    300.8499
	MW[3]    :  5,061.6456   @J=I:    686.5501
	MW[11]   : 35,013.9807   @J=I:    118.4468
	MW[12]   : 32,744.9067   @J=I:    110.7709
	MW[13]   :     98.6595
	MW[14]   :          --
	MW[15]   :  3,431.4531   @J=I:     37.7823
	MW[16]   : 35,063.594    @J=I:    118.4468
	MW[17]   : 32,791.3049   @J=I:    110.7709
	MW[18]   :          --
	MW[19]   :          --
	MW[20]   :  3,434.1011   @J=I:     37.7823
	MW[21]   :  3,768.9711   @J=I:    438.0162
	MW[22]   :  3,524.7236   @J=I:    409.6306
	MW[23]   :     22.2505
	MW[24]   :          --
	MW[25]   :    354.6448   @J=I:    139.7532
	MO.01.001:  3,777.46  
	MO.01.002:  3,516.85  
	MO.01.003:     21.14  
	MO.01.005:    353.53  

Variable Values at end of Iteration 1 I loop:

    EDA: 3,768.9711
    ESR: 3,524.7236
    ELB:    22.2505
    ENM:   354.6448
    TRN:    22.2505
    AUT: 7,293.6947
    TOT: 7,670.59  

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_AM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:49 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_MD.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:49 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_PM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:49 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_NT.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:50 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\MC_Transit_Trips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:50 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:50 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\AM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:50:51 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:24
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:51:15 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\MD.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:51:16 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:19
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:51:35 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:51:36 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:25
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:01 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\NT.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:02 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:05
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Merge_Hwy_Assignments.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:07 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Hwy_eval.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:08 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PBHWY00B.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:08 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\PBHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:08 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################

M(100): COPY C:\projects\Roanoke\Base\Output\PK_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\PK_HWYSKIM_1.MAT
M(100): COPY C:\projects\Roanoke\Base\Output\OP_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\OP_HWYSKIM_1.MATPage 856  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:09 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\pk_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\PK_CNG_HwySkim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1330 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\PK_CNG_HwySkim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Sun Mar 27 18:52:08 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 857  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,649,378.56   @J=I:     23,000,116.72
	MI.01.002: 22,402,473,161.1 
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,858,996.56   @J=I:     23,000,794.72
	MW[1]    : 22,425,649,378.56   @J=I:     23,000,116.72
	MW[2]    : 22,402,473,161.1 
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,858,996.56   @J=I:     23,000,794.72
	MW[11]   :        649,378.56   @J=I:            116.72
	MW[12]   :        473,161.1 
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        794,796.56   @J=I:            784.72
	MO.01.001:        649,378.56
	MO.01.002:        473,161.1 
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        794,796.56

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 858  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:09 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_CNG_HwySkim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1330 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\OP_CNG_HwySkim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Sun Mar 27 18:52:08 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 859  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,670,078.41   @J=I:     23,000,117.27
	MI.01.002: 22,402,468,929.18
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,879,696.41   @J=I:     23,000,795.27
	MW[1]    : 22,425,670,078.41   @J=I:     23,000,117.27
	MW[2]    : 22,402,468,929.18
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,879,696.41   @J=I:     23,000,795.27
	MW[11]   :        670,078.41   @J=I:            117.27
	MW[12]   :        468,929.18
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        815,496.41   @J=I:            785.27
	MO.01.001:        670,078.41
	MO.01.002:        468,929.18
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        815,496.41

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBW_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:09 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBO_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:10 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\NHB_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:11 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBSC_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:12 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\TDMAT00C.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:13 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\HBSC_distribution.PRN. 
DISTRIBUTION (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:13 2016
DISTRIBUTION ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_D2D_Flwos.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:14 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_noSchoolTrips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:14 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\PARAMS\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:14 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 923  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 924  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 925  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:09 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:09 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 926  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,271.4855   @J=I:         44.3114
	MI.02.DISTANCE:    473,161.1   
	MW[1]         :    -28,271.4855   @J=I:         44.3114
	MW[2]         :    465,670.73  
	MW[100]       :    231,167.1346   @J=I:      1,137.4794
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,360.8129
	MW[115]       :     -7,320.23  
	MW[116]       :              --
	MW[200]       :    117,677.504    @J=I:      1,916.8478
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 1,916.84782

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 927  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:15 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:14 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,463, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 928  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      1,916.8
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      1,916.8
	MW[1]      :    117,677.5   @J=I:      1,916.8
	MW[2]      :    117,677.5   @J=I:      1,916.8
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_1.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:15 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 929  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 930  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 931  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:09 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:09 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 932  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,271.4855   @J=I:         44.3114
	MI.02.DISTANCE:    473,161.1   
	MW[1]         :    -28,271.4855   @J=I:         44.3114
	MW[2]         :    465,670.73  
	MW[100]       :    238,330.7446   @J=I:      1,164.3094
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,360.8129
	MW[115]       :     -7,320.23  
	MW[116]       :      7,163.61     @J=I:         26.83  
	MW[200]       :    117,677.504    @J=I:      1,966.7226
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 1,966.72261

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 933  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:15 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:15 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,642, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 934  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      1,966.7
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      1,966.7
	MW[1]      :    117,677.5   @J=I:      1,966.7
	MW[2]      :    117,677.5   @J=I:      1,966.7
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_2.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:15 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 935  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 936  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 937  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:09 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:09 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 938  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,271.4855   @J=I:         44.3114
	MI.02.DISTANCE:    473,161.1   
	MW[1]         :    -28,271.4855   @J=I:         44.3114
	MW[2]         :    465,670.73  
	MW[100]       :    245,168.6146   @J=I:      1,189.9194
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,360.8129
	MW[115]       :     -7,320.23  
	MW[116]       :     14,001.48     @J=I:         52.44  
	MW[200]       :    117,677.504    @J=I:      2,002.2472
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,002.24715

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 939  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:16 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:15 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,735, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 940  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,002.2
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,002.2
	MW[1]      :    117,677.5   @J=I:      2,002.2
	MW[2]      :    117,677.5   @J=I:      2,002.2
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_3.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:16 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 941  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 942  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 943  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:09 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:09 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 944  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,271.4855   @J=I:         44.3114
	MI.02.DISTANCE:    473,161.1   
	MW[1]         :    -28,271.4855   @J=I:         44.3114
	MW[2]         :    465,670.73  
	MW[100]       :    252,062.5546   @J=I:      1,215.7394
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,360.8129
	MW[115]       :     -7,320.23  
	MW[116]       :     20,895.42     @J=I:         78.26  
	MW[200]       :    117,677.504    @J=I:      2,024.4567
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,024.45669

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 945  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:16 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:16 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,840, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 946  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,024.5
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,024.5
	MW[1]      :    117,677.5   @J=I:      2,024.5
	MW[2]      :    117,677.5   @J=I:      2,024.5
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_4.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:16 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 947  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 948  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 949  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:09 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:09 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 950  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,271.4855   @J=I:         44.3114
	MI.02.DISTANCE:    473,161.1   
	MW[1]         :    -28,271.4855   @J=I:         44.3114
	MW[2]         :    465,670.73  
	MW[100]       :    258,881.7346   @J=I:      1,241.2794
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,360.8129
	MW[115]       :     -7,320.23  
	MW[116]       :     27,714.6      @J=I:        103.8   
	MW[200]       :    117,677.504    @J=I:      2,037.4333
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,037.43326

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 951  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:17 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:16 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,915, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 952  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,037.4
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,037.4
	MW[1]      :    117,677.5   @J=I:      2,037.4
	MW[2]      :    117,677.5   @J=I:      2,037.4
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_5.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:17 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 953  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 954  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 955  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:09 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:09 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 956  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,271.4855   @J=I:         44.3114
	MI.02.DISTANCE:    473,161.1   
	MW[1]         :    -28,271.4855   @J=I:         44.3114
	MW[2]         :    465,670.73  
	MW[100]       :    265,548.7246   @J=I:      1,266.2494
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,360.8129
	MW[115]       :     -7,320.23  
	MW[116]       :     34,381.59     @J=I:        128.77  
	MW[200]       :    117,677.504    @J=I:      2,044.8926
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,044.89256

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 957  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:17 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:17 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,939, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 958  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,044.9
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,044.9
	MW[1]      :    117,677.5   @J=I:      2,044.9
	MW[2]      :    117,677.5   @J=I:      2,044.9
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_6.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:17 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 959  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 960  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 961  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:09 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:09 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 962  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,271.4855   @J=I:         44.3114
	MI.02.DISTANCE:    473,161.1   
	MW[1]         :    -28,271.4855   @J=I:         44.3114
	MW[2]         :    465,670.73  
	MW[100]       :    272,319.8446   @J=I:      1,291.6094
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,360.8129
	MW[115]       :     -7,320.23  
	MW[116]       :     41,152.71     @J=I:        154.13  
	MW[200]       :    117,677.504    @J=I:      2,051.2607
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,051.26069

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 963  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:18 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:17 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,969, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 964  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,051.3
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,051.3
	MW[1]      :    117,677.5   @J=I:      2,051.3
	MW[2]      :    117,677.5   @J=I:      2,051.3
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_7.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:18 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 965  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 966  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 967  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:09 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:09 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 968  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,271.4855   @J=I:         44.3114
	MI.02.DISTANCE:    473,161.1   
	MW[1]         :    -28,271.4855   @J=I:         44.3114
	MW[2]         :    465,670.73  
	MW[100]       :    279,042.9046   @J=I:      1,316.7894
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,360.8129
	MW[115]       :     -7,320.23  
	MW[116]       :     47,875.77     @J=I:        179.31  
	MW[200]       :    117,677.504    @J=I:      2,053.1125
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,053.11246

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 969  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:18 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:18 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,970, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 970  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,053.1
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,053.1
	MW[1]      :    117,677.5   @J=I:      2,053.1
	MW[2]      :    117,677.5   @J=I:      2,053.1
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_8.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:18 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 971  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 972  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 973  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:09 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:09 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 974  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,271.4855   @J=I:         44.3114
	MI.02.DISTANCE:    473,161.1   
	MW[1]         :    -28,271.4855   @J=I:         44.3114
	MW[2]         :    465,670.73  
	MW[100]       :    285,787.3246   @J=I:      1,342.0494
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,360.8129
	MW[115]       :     -7,320.23  
	MW[116]       :     54,620.19     @J=I:        204.57  
	MW[200]       :    117,677.504    @J=I:      2,054.8471
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,054.84706

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 975  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:19 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:18 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,965, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 976  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,054.8
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,054.8
	MW[1]      :    117,677.5   @J=I:      2,054.8
	MW[2]      :    117,677.5   @J=I:      2,054.8
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_9.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:19 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 977  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 978  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 979  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:09 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:09 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 980  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,271.4855   @J=I:         44.3114
	MI.02.DISTANCE:    473,161.1   
	MW[1]         :    -28,271.4855   @J=I:         44.3114
	MW[2]         :    465,670.73  
	MW[100]       :    292,694.6146   @J=I:      1,367.9194
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,360.8129
	MW[115]       :     -7,320.23  
	MW[116]       :     61,527.48     @J=I:        230.44  
	MW[200]       :    117,677.504    @J=I:      2,055.6547
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,055.65474

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 981  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:19 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:19 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,985, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 982  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,055.7
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,055.7
	MW[1]      :    117,677.5   @J=I:      2,055.7
	MW[2]      :    117,677.5   @J=I:      2,055.7
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_10.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBO.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:19 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:20 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:20 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:20 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBSH.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:20 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:21 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:21 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:21 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_NHB.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:21 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:21 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:21 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:21 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_tlfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:22 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_ttfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:22 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_d2d_flows.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:22 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 27  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:22 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT",
 MO = 1, NAME = HBO_HBSH
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT"

MW[1] = MI.1.1 + MI.2.1


MATRIX Stack Size = 344 bytes.
................................................................................


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:20 2016 
ID=
PAR Zones=267 M=1
  HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:19 2016 
ID=
PAR Zones=267 M=1
  HBO

Totals after Iteration 1 I loop:

	MI.02.001: 136,095   @J=I:  11,948
	MI.01.001: 264,074   @J=I:  60,892
	MW[1]    : 400,170   @J=I:  72,840
	MO.01.001: 400,174

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 28  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:22 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 29  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------

MATRIX Stack Size = 2804 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:19 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:09 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 30  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 117,677.504    @J=I:   2,055.6547
	MI.01.001:  58,625.5286   @J=I:     182.5077
	MI.01.002:   5,643.8714   @J=I:      17.57  
	MI.01.003:   1,038.5399
	MI.01.004:           --
	MI.01.005:   5,981.0601   @J=I:      66.9223
	MI.01.006:  59,538.2099   @J=I:     182.5077
	MI.01.007:   5,731.7351   @J=I:      17.57  
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   6,019.0551   @J=I:      66.9223
	MW[1]    : 117,677.504    @J=I:   2,055.6547
	MW[2]    :  36,670.2476   @J=I:     704.731 
	MW[3]    :  81,007.2564   @J=I:   1,350.9237
	MW[11]   :  58,625.5286   @J=I:     182.5077
	MW[12]   :   5,643.8714   @J=I:      17.57  
	MW[13]   :   1,038.5399
	MW[14]   :           --
	MW[15]   :   5,981.0601   @J=I:      66.9223
	MW[16]   :  59,538.2099   @J=I:     182.5077
	MW[17]   :   5,731.7351   @J=I:      17.57  
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   6,019.0551   @J=I:      66.9223
	MW[21]   : 103,216.3105   @J=I:   1,395.5582
	MW[22]   :   9,936.6197   @J=I:     134.3502
	MW[23]   :   3,178.0183
	MW[24]   :           --
	MW[25]   :   1,346.5555   @J=I:     525.7463
	MO.01.001: 103,219.22  
	MO.01.002:   9,935.86  
	MO.01.003:   3,177.02  
	MO.01.005:   1,341.09  

Variable Values at end of Iteration 1 I loop:

    EDA: 103,216.3
    ESR:   9,936.6
    ELB:   3,178  
    ENM:   1,346.6
    TRN:   3,178  
    AUT: 113,152.9
    TOT: 117,677.5

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 31  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:22 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 32  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------

MATRIX Stack Size = 2808 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:22 2016 
ID=
PAR Zones=267 M=1
  HBO_HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:10 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 33  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 400,173.87     @J=I:  72,839.6   
	MI.01.001:  30,507.8518   @J=I:      83.9644
	MI.01.002:  31,525.1011   @J=I:      86.7641
	MI.01.003:     212.7659
	MI.01.004:           --
	MI.01.005:   9,043.2812   @J=I:      96.2716
	MI.01.006:  30,604.9775   @J=I:      83.9644
	MI.01.007:  31,625.4653   @J=I:      86.7641
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   9,058.5572   @J=I:      96.2716
	MW[1]    : 400,173.87     @J=I:  72,839.6   
	MW[2]    : 154,761.0007   @J=I:  25,116.8723
	MW[3]    : 245,412.8693   @J=I:  47,722.7277
	MW[11]   :  30,507.8518   @J=I:      83.9644
	MW[12]   :  31,525.1011   @J=I:      86.7641
	MW[13]   :     212.7659
	MW[14]   :           --
	MW[15]   :   9,043.2812   @J=I:      96.2716
	MW[16]   :  30,604.9775   @J=I:      83.9644
	MW[17]   :  31,625.4653   @J=I:      86.7641
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   9,058.5572   @J=I:      96.2716
	MW[21]   : 170,286.9298   @J=I:  22,830.6111
	MW[22]   : 175,964.9516   @J=I:  23,591.8716
	MW[23]   :   2,288.0034
	MW[24]   :           --
	MW[25]   :  51,633.9852   @J=I:  26,417.1174
	MO.01.001: 170,279.97  
	MO.01.002: 175,977.77  
	MO.01.003:   2,287.26  
	MO.01.005:  51,627.42  

Variable Values at end of Iteration 1 I loop:

    EDA: 170,286.9
    ESR: 175,965  
    ELB:   2,288  
    ENM:  51,634  
    TRN:   2,288  
    AUT: 346,251.9
    TOT: 400,173.9

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################
Page 34  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:23 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 35  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------

MATRIX Stack Size = 2804 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:21 2016 
ID=
PAR Zones=267 M=1
  NHB

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:11 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 36  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 315,086.909    @J=I:  73,229.3114
	MI.01.001:  35,012.6389   @J=I:     118.4437
	MI.01.002:  32,743.6519   @J=I:     110.768 
	MI.01.003:      99.6596
	MI.01.004:           --
	MI.01.005:   3,433.0495   @J=I:      37.7882
	MI.01.006:  35,062.7584   @J=I:     118.4437
	MI.01.007:  32,790.5234   @J=I:     110.768 
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   3,435.7183   @J=I:      37.7882
	MW[1]    : 315,086.909    @J=I:  73,229.3114
	MW[2]    : 124,113.3065   @J=I:  27,616.964 
	MW[3]    : 190,973.6025   @J=I:  45,612.3473
	MW[11]   :  35,012.6389   @J=I:     118.4437
	MW[12]   :  32,743.6519   @J=I:     110.768 
	MW[13]   :      99.6596
	MW[14]   :           --
	MW[15]   :   3,433.0495   @J=I:      37.7882
	MW[16]   :  35,062.7584   @J=I:     118.4437
	MW[17]   :  32,790.5234   @J=I:     110.768 
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   3,435.7183   @J=I:      37.7882
	MW[21]   : 154,740.794    @J=I:  32,421.8129
	MW[22]   : 144,712.848    @J=I:  30,320.7239
	MW[23]   :     877.3641
	MW[24]   :           --
	MW[25]   :  14,755.9029   @J=I:  10,486.7746
	MO.01.001: 154,743.42  
	MO.01.002: 144,715.49  
	MO.01.003:     872.9   
	MO.01.005:  14,749.13  

Variable Values at end of Iteration 1 I loop:

    EDA: 154,740.794
    ESR: 144,712.848
    ELB:     877.364
    ENM:  14,755.903
    TRN:     877.364
    AUT: 299,453.642
    TOT: 315,086.909

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 37  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:23 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 38  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------

MATRIX Stack Size = 2822 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:14 2016 
ID=
PAR Zones=267 M=1
  HBSC

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:52:12 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 39  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------

Totals after Iteration 1 I loop:

	MI.02.001:  7,669.56     @J=I:  1,017.92  
	MI.01.001: 35,012.6389   @J=I:    118.4437
	MI.01.002: 32,743.6519   @J=I:    110.768 
	MI.01.003:     99.6596
	MI.01.004:          --
	MI.01.005:  3,433.0495   @J=I:     37.7882
	MI.01.006: 35,062.7584   @J=I:    118.4437
	MI.01.007: 32,790.5234   @J=I:    110.768 
	MI.01.008:          --
	MI.01.009:          --
	MI.01.010:  3,435.7183   @J=I:     37.7882
	MW[1]    :  7,669.56     @J=I:  1,017.92  
	MW[2]    :  2,630.6412   @J=I:    326.3158
	MW[3]    :  5,038.9188   @J=I:    691.6042
	MW[11]   : 35,012.6389   @J=I:    118.4437
	MW[12]   : 32,743.6519   @J=I:    110.768 
	MW[13]   :     99.6596
	MW[14]   :          --
	MW[15]   :  3,433.0495   @J=I:     37.7882
	MW[16]   : 35,062.7584   @J=I:    118.4437
	MW[17]   : 32,790.5234   @J=I:    110.768 
	MW[18]   :          --
	MW[19]   :          --
	MW[20]   :  3,435.7183   @J=I:     37.7882
	MW[21]   :  3,762.0404   @J=I:    451.4716
	MW[22]   :  3,518.2421   @J=I:    422.2141
	MW[23]   :     22.8852
	MW[24]   :          --
	MW[25]   :    366.3923   @J=I:    144.2344
	MO.01.001:  3,769.99  
	MO.01.002:  3,510.74  
	MO.01.003:     21.79  
	MO.01.005:    365.28  

Variable Values at end of Iteration 1 I loop:

    EDA: 3,762.0404
    ESR: 3,518.2421
    ELB:    22.8852
    ENM:   366.3923
    TRN:    22.8852
    AUT: 7,280.2825
    TOT: 7,669.56  

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_AM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:23 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_MD.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:24 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_PM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:24 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_NT.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:24 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\MC_Transit_Trips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:25 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:25 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\AM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:25 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:16
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:41 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\MD.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:52:42 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:19
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:01 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:02 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:24
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:26 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\NT.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:26 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:03
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Merge_Hwy_Assignments.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:29 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Hwy_eval.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:30 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PBHWY00B.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:30 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\PBHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:30 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################

M(100): COPY C:\projects\Roanoke\Base\Output\PK_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\PK_HWYSKIM_2.MAT
M(100): COPY C:\projects\Roanoke\Base\Output\OP_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\OP_HWYSKIM_2.MATPage 133  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:31 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\pk_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\PK_CNG_HwySkim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1330 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\PK_CNG_HwySkim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Sun Mar 27 18:53:30 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 134  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,648,803.46   @J=I:     23,000,116.69
	MI.01.002: 22,402,472,838.81
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,858,421.46   @J=I:     23,000,794.69
	MW[1]    : 22,425,648,803.46   @J=I:     23,000,116.69
	MW[2]    : 22,402,472,838.81
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,858,421.46   @J=I:     23,000,794.69
	MW[11]   :        648,803.46   @J=I:            116.69
	MW[12]   :        472,838.81
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        794,221.46   @J=I:            784.69
	MO.01.001:        648,803.46
	MO.01.002:        472,838.81
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        794,221.46

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 135  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:31 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_CNG_HwySkim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1330 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\OP_CNG_HwySkim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Sun Mar 27 18:53:30 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 136  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,669,659.37   @J=I:     23,000,117.25
	MI.01.002: 22,402,468,740.77
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,879,277.37   @J=I:     23,000,795.25
	MW[1]    : 22,425,669,659.37   @J=I:     23,000,117.25
	MW[2]    : 22,402,468,740.77
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,879,277.37   @J=I:     23,000,795.25
	MW[11]   :        669,659.37   @J=I:            117.25
	MW[12]   :        468,740.77
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        815,077.37   @J=I:            785.25
	MO.01.001:        669,659.37
	MO.01.002:        468,740.77
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        815,077.37

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBW_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:31 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:02
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBO_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:33 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\NHB_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:34 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBSC_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:35 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:02
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\TDMAT00C.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:37 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\HBSC_distribution.PRN. 
DISTRIBUTION (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:37 2016
DISTRIBUTION ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_D2D_Flwos.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:37 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_noSchoolTrips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:38 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\PARAMS\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:38 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 200  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 201  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 202  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:31 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:31 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 203  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,250.5468   @J=I:         44.312 
	MI.02.DISTANCE:    472,838.81  
	MW[1]         :    -28,250.5468   @J=I:         44.312 
	MW[2]         :    465,338.48  
	MW[100]       :    231,225.8433   @J=I:      1,137.4797
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,330.3966
	MW[115]       :     -7,320.48  
	MW[116]       :              --
	MW[200]       :    117,677.504    @J=I:      1,915.129 
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 1,915.12899

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 204  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:38 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:38 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,468, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 205  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      1,915.1
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      1,915.1
	MW[1]      :    117,677.5   @J=I:      1,915.1
	MW[2]      :    117,677.5   @J=I:      1,915.1
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_1.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:38 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 206  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 207  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 208  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:31 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:31 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 209  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,250.5468   @J=I:         44.312 
	MI.02.DISTANCE:    472,838.81  
	MW[1]         :    -28,250.5468   @J=I:         44.312 
	MW[2]         :    465,338.48  
	MW[100]       :    238,386.7833   @J=I:      1,164.2997
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,330.3966
	MW[115]       :     -7,320.48  
	MW[116]       :      7,160.94     @J=I:         26.82  
	MW[200]       :    117,677.504    @J=I:      1,965.2322
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 1,965.23221

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 210  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:39 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:38 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,645, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 211  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      1,965.2
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      1,965.2
	MW[1]      :    117,677.5   @J=I:      1,965.2
	MW[2]      :    117,677.5   @J=I:      1,965.2
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_2.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:39 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 212  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 213  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 214  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:31 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:31 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 215  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,250.5468   @J=I:         44.312 
	MI.02.DISTANCE:    472,838.81  
	MW[1]         :    -28,250.5468   @J=I:         44.312 
	MW[2]         :    465,338.48  
	MW[100]       :    245,229.9933   @J=I:      1,189.9297
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,330.3966
	MW[115]       :     -7,320.48  
	MW[116]       :     14,004.15     @J=I:         52.45  
	MW[200]       :    117,677.504    @J=I:      2,001.2801
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,001.28012

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 216  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:39 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:39 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,738, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 217  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,001.3
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,001.3
	MW[1]      :    117,677.5   @J=I:      2,001.3
	MW[2]      :    117,677.5   @J=I:      2,001.3
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_3.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:40 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 218  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 219  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 220  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:31 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:31 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 221  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,250.5468   @J=I:         44.312 
	MI.02.DISTANCE:    472,838.81  
	MW[1]         :    -28,250.5468   @J=I:         44.312 
	MW[2]         :    465,338.48  
	MW[100]       :    251,955.7233   @J=I:      1,215.1197
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,330.3966
	MW[115]       :     -7,320.48  
	MW[116]       :     20,729.88     @J=I:         77.64  
	MW[200]       :    117,677.504    @J=I:      2,023.5577
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,023.55765

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 222  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:40 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:40 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,838, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 223  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,023.6
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,023.6
	MW[1]      :    117,677.5   @J=I:      2,023.6
	MW[2]      :    117,677.5   @J=I:      2,023.6
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_4.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:40 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 224  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 225  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 226  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:31 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:31 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 227  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,250.5468   @J=I:         44.312 
	MI.02.DISTANCE:    472,838.81  
	MW[1]         :    -28,250.5468   @J=I:         44.312 
	MW[2]         :    465,338.48  
	MW[100]       :    258,774.9033   @J=I:      1,240.6597
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,330.3966
	MW[115]       :     -7,320.48  
	MW[116]       :     27,549.06     @J=I:        103.18  
	MW[200]       :    117,677.504    @J=I:      2,037.4071
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,037.40707

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 228  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:41 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:40 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,905, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 229  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,037.4
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,037.4
	MW[1]      :    117,677.5   @J=I:      2,037.4
	MW[2]      :    117,677.5   @J=I:      2,037.4
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_5.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:41 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 230  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 231  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 232  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:31 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:31 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 233  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,250.5468   @J=I:         44.312 
	MI.02.DISTANCE:    472,838.81  
	MW[1]         :    -28,250.5468   @J=I:         44.312 
	MW[2]         :    465,338.48  
	MW[100]       :    265,615.4433   @J=I:      1,266.2797
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,330.3966
	MW[115]       :     -7,320.48  
	MW[116]       :     34,389.6      @J=I:        128.8   
	MW[200]       :    117,677.504    @J=I:      2,044.9348
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,044.93485

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 234  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:41 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:41 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,914, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 235  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,044.9
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,044.9
	MW[1]      :    117,677.5   @J=I:      2,044.9
	MW[2]      :    117,677.5   @J=I:      2,044.9
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_6.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:41 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 236  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 237  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 238  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:31 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:31 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 239  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,250.5468   @J=I:         44.312 
	MI.02.DISTANCE:    472,838.81  
	MW[1]         :    -28,250.5468   @J=I:         44.312 
	MW[2]         :    465,338.48  
	MW[100]       :    272,389.2333   @J=I:      1,291.6497
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,330.3966
	MW[115]       :     -7,320.48  
	MW[116]       :     41,163.39     @J=I:        154.17  
	MW[200]       :    117,677.504    @J=I:      2,050.7468
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,050.7468 

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 240  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:42 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:41 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,944, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 241  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,050.7
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,050.7
	MW[1]      :    117,677.5   @J=I:      2,050.7
	MW[2]      :    117,677.5   @J=I:      2,050.7
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_7.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:42 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 242  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 243  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 244  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:31 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:31 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 245  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,250.5468   @J=I:         44.312 
	MI.02.DISTANCE:    472,838.81  
	MW[1]         :    -28,250.5468   @J=I:         44.312 
	MW[2]         :    465,338.48  
	MW[100]       :    279,098.9433   @J=I:      1,316.7797
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,330.3966
	MW[115]       :     -7,320.48  
	MW[116]       :     47,873.1      @J=I:        179.3   
	MW[200]       :    117,677.504    @J=I:      2,052.9269
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,052.92694

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 246  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:42 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:42 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,927, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 247  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,052.9
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,052.9
	MW[1]      :    117,677.5   @J=I:      2,052.9
	MW[2]      :    117,677.5   @J=I:      2,052.9
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_8.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:42 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 248  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 249  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 250  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:31 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:31 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 251  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,250.5468   @J=I:         44.312 
	MI.02.DISTANCE:    472,838.81  
	MW[1]         :    -28,250.5468   @J=I:         44.312 
	MW[2]         :    465,338.48  
	MW[100]       :    285,838.0233   @J=I:      1,342.0197
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,330.3966
	MW[115]       :     -7,320.48  
	MW[116]       :     54,612.18     @J=I:        204.54  
	MW[200]       :    117,677.504    @J=I:      2,054.6827
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,054.68268

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 252  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:43 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:42 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,952, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 253  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,054.7
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,054.7
	MW[1]      :    117,677.5   @J=I:      2,054.7
	MW[2]      :    117,677.5   @J=I:      2,054.7
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_9.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:43 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 254  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 255  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 256  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:31 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:31 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 257  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,250.5468   @J=I:         44.312 
	MI.02.DISTANCE:    472,838.81  
	MW[1]         :    -28,250.5468   @J=I:         44.312 
	MW[2]         :    465,338.48  
	MW[100]       :    292,563.7533   @J=I:      1,367.2097
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,330.3966
	MW[115]       :     -7,320.48  
	MW[116]       :     61,337.91     @J=I:        229.73  
	MW[200]       :    117,677.504    @J=I:      2,054.6787
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,054.67866

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 258  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:44 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:43 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,956, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 259  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,054.7
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,054.7
	MW[1]      :    117,677.5   @J=I:      2,054.7
	MW[2]      :    117,677.5   @J=I:      2,054.7
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_10.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBO.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:44 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:44 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:44 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:44 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBSH.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:44 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:45 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:45 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:45 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_NHB.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:45 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:45 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:45 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:46 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_tlfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:46 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_ttfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:46 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_d2d_flows.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:46 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 304  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:46 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT",
 MO = 1, NAME = HBO_HBSH
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT"

MW[1] = MI.1.1 + MI.2.1


MATRIX Stack Size = 344 bytes.
................................................................................


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:44 2016 
ID=
PAR Zones=267 M=1
  HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:44 2016 
ID=
PAR Zones=267 M=1
  HBO

Totals after Iteration 1 I loop:

	MI.02.001: 136,095   @J=I:  11,948
	MI.01.001: 264,074   @J=I:  60,883
	MW[1]    : 400,170   @J=I:  72,831
	MO.01.001: 400,174

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 305  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:46 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 306  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2804 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:43 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:31 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 307  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 117,677.504    @J=I:   2,054.6787
	MI.01.001:  58,625.8629   @J=I:     182.5078
	MI.01.002:   5,643.9036   @J=I:      17.57  
	MI.01.003:   1,038.1807
	MI.01.004:           --
	MI.01.005:   5,981.0529   @J=I:      66.9222
	MI.01.006:  59,538.2201   @J=I:     182.5078
	MI.01.007:   5,731.736    @J=I:      17.57  
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   6,019.0439   @J=I:      66.9222
	MW[1]    : 117,677.504    @J=I:   2,054.6787
	MW[2]    :  36,666.3447   @J=I:     704.4302
	MW[3]    :  81,011.1593   @J=I:   1,350.2485
	MW[11]   :  58,625.8629   @J=I:     182.5078
	MW[12]   :   5,643.9036   @J=I:      17.57  
	MW[13]   :   1,038.1807
	MW[14]   :           --
	MW[15]   :   5,981.0529   @J=I:      66.9222
	MW[16]   :  59,538.2201   @J=I:     182.5078
	MW[17]   :   5,731.736    @J=I:      17.57  
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   6,019.0439   @J=I:      66.9222
	MW[21]   : 103,217.0425   @J=I:   1,394.883 
	MW[22]   :   9,936.6901   @J=I:     134.2852
	MW[23]   :   3,178.0166
	MW[24]   :           --
	MW[25]   :   1,345.7547   @J=I:     525.5105
	MO.01.001: 103,220.41  
	MO.01.002:   9,936.5   
	MO.01.003:   3,177     
	MO.01.005:   1,340.29  

Variable Values at end of Iteration 1 I loop:

    EDA: 103,217  
    ESR:   9,936.7
    ELB:   3,178  
    ENM:   1,345.8
    TRN:   3,178  
    AUT: 113,153.7
    TOT: 117,677.5

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 308  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:46 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 309  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2808 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:46 2016 
ID=
PAR Zones=267 M=1
  HBO_HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:33 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 310  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 400,173.54     @J=I:  72,831.41  
	MI.01.001:  30,507.967    @J=I:      83.9644
	MI.01.002:  31,525.22     @J=I:      86.7641
	MI.01.003:     212.7052
	MI.01.004:           --
	MI.01.005:   9,043.1077   @J=I:      96.2715
	MI.01.006:  30,605.0646   @J=I:      83.9644
	MI.01.007:  31,625.5553   @J=I:      86.7641
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   9,058.3801   @J=I:      96.2715
	MW[1]    : 400,173.54     @J=I:  72,831.41  
	MW[2]    : 154,768.74     @J=I:  25,113.5185
	MW[3]    : 245,404.8      @J=I:  47,717.8915
	MW[11]   :  30,507.967    @J=I:      83.9644
	MW[12]   :  31,525.22     @J=I:      86.7641
	MW[13]   :     212.7052
	MW[14]   :           --
	MW[15]   :   9,043.1077   @J=I:      96.2715
	MW[16]   :  30,605.0646   @J=I:      83.9644
	MW[17]   :  31,625.5553   @J=I:      86.7641
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   9,058.3801   @J=I:      96.2715
	MW[21]   : 170,291.0949   @J=I:  22,828.1356
	MW[22]   : 175,969.2556   @J=I:  23,589.3136
	MW[23]   :   2,287.8911
	MW[24]   :           --
	MW[25]   :  51,625.2985   @J=I:  26,413.9608
	MO.01.001: 170,284.07  
	MO.01.002: 175,981.92  
	MO.01.003:   2,286.93  
	MO.01.005:  51,619.16  

Variable Values at end of Iteration 1 I loop:

    EDA: 170,291.1
    ESR: 175,969.3
    ELB:   2,287.9
    ENM:  51,625.3
    TRN:   2,287.9
    AUT: 346,260.4
    TOT: 400,173.5

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################
Page 311  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:47 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 312  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2804 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:45 2016 
ID=
PAR Zones=267 M=1
  NHB

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:34 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 313  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 315,086.909    @J=I:  73,222.8871
	MI.01.001:  35,012.6813   @J=I:     118.4438
	MI.01.002:  32,743.6915   @J=I:     110.768 
	MI.01.003:      99.6279
	MI.01.004:           --
	MI.01.005:   3,432.9993   @J=I:      37.7882
	MI.01.006:  35,062.7846   @J=I:     118.4438
	MI.01.007:  32,790.5479   @J=I:     110.768 
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   3,435.6674   @J=I:      37.7882
	MW[1]    : 315,086.909    @J=I:  73,222.8871
	MW[2]    : 124,115.574    @J=I:  27,616.2586
	MW[3]    : 190,971.335    @J=I:  45,606.6285
	MW[11]   :  35,012.6813   @J=I:     118.4438
	MW[12]   :  32,743.6915   @J=I:     110.768 
	MW[13]   :      99.6279
	MW[14]   :           --
	MW[15]   :   3,432.9993   @J=I:      37.7882
	MW[16]   :  35,062.7846   @J=I:     118.4438
	MW[17]   :  32,790.5479   @J=I:     110.768 
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   3,435.6674   @J=I:      37.7882
	MW[21]   : 154,741.9012   @J=I:  32,419.0248
	MW[22]   : 144,713.8835   @J=I:  30,318.1165
	MW[23]   :     877.257 
	MW[24]   :           --
	MW[25]   :  14,753.8673   @J=I:  10,485.7458
	MO.01.001: 154,743.68  
	MO.01.002: 144,716.84  
	MO.01.003:     872.78  
	MO.01.005:  14,747.1   

Variable Values at end of Iteration 1 I loop:

    EDA: 154,741.901
    ESR: 144,713.883
    ELB:     877.257
    ENM:  14,753.867
    TRN:     877.257
    AUT: 299,455.785
    TOT: 315,086.909

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 314  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:47 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 315  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2822 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:38 2016 
ID=
PAR Zones=267 M=1
  HBSC

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:53:35 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 316  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001:  7,669.48     @J=I:  1,017.22  
	MI.01.001: 35,012.6813   @J=I:    118.4438
	MI.01.002: 32,743.6915   @J=I:    110.768 
	MI.01.003:     99.6279
	MI.01.004:          --
	MI.01.005:  3,432.9993   @J=I:     37.7882
	MI.01.006: 35,062.7846   @J=I:    118.4438
	MI.01.007: 32,790.5479   @J=I:    110.768 
	MI.01.008:          --
	MI.01.009:          --
	MI.01.010:  3,435.6674   @J=I:     37.7882
	MW[1]    :  7,669.48     @J=I:  1,017.22  
	MW[2]    :  2,630.5113   @J=I:    325.7058
	MW[3]    :  5,038.9687   @J=I:    691.5142
	MW[11]   : 35,012.6813   @J=I:    118.4438
	MW[12]   : 32,743.6915   @J=I:    110.768 
	MW[13]   :     99.6279
	MW[14]   :          --
	MW[15]   :  3,432.9993   @J=I:     37.7882
	MW[16]   : 35,062.7846   @J=I:    118.4438
	MW[17]   : 32,790.5479   @J=I:    110.768 
	MW[18]   :          --
	MW[19]   :          --
	MW[20]   :  3,435.6674   @J=I:     37.7882
	MW[21]   :  3,762.1237   @J=I:    451.1637
	MW[22]   :  3,518.32     @J=I:    421.9261
	MW[23]   :     22.8809
	MW[24]   :          --
	MW[25]   :    366.1555   @J=I:    144.1302
	MO.01.001:  3,770.14  
	MO.01.002:  3,510.82  
	MO.01.003:     21.8   
	MO.01.005:    365.08  

Variable Values at end of Iteration 1 I loop:

    EDA: 3,762.1237
    ESR: 3,518.32  
    ELB:    22.8809
    ENM:   366.1555
    TRN:    22.8809
    AUT: 7,280.4437
    TOT: 7,669.48  

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_AM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:47 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_MD.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:48 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_PM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:48 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_NT.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:48 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\MC_Transit_Trips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:49 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:49 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\AM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:53:49 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:20
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:54:09 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\MD.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:54:09 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:19
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:54:28 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:54:29 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:24
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:54:53 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\NT.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:54:53 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:03
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Merge_Hwy_Assignments.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Sun Mar 27 18:54:56 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Hwy_eval.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Sun Mar 27 18:54:57 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PBHWY00B.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:54:57 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\PBHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:54:57 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################

M(100): COPY C:\projects\Roanoke\Base\Output\PK_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\PK_HWYSKIM_3.MAT
M(100): COPY C:\projects\Roanoke\Base\Output\OP_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\OP_HWYSKIM_3.MATPage 413  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:54:58 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\pk_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\PK_CNG_HwySkim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1330 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\PK_CNG_HwySkim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Sun Mar 27 18:54:57 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 414  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,648,940.86   @J=I:     23,000,116.68
	MI.01.002: 22,402,473,080.99
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,858,558.86   @J=I:     23,000,794.68
	MW[1]    : 22,425,648,940.86   @J=I:     23,000,116.68
	MW[2]    : 22,402,473,080.99
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,858,558.86   @J=I:     23,000,794.68
	MW[11]   :        648,940.86   @J=I:            116.68
	MW[12]   :        473,080.99
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        794,358.86   @J=I:            784.68
	MO.01.001:        648,940.86
	MO.01.002:        473,080.99
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        794,358.86

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 415  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:54:58 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_CNG_HwySkim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1330 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\OP_CNG_HwySkim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Sun Mar 27 18:54:57 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 416  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,669,687.27   @J=I:     23,000,117.26
	MI.01.002: 22,402,468,893.33
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,879,305.27   @J=I:     23,000,795.26
	MW[1]    : 22,425,669,687.27   @J=I:     23,000,117.26
	MW[2]    : 22,402,468,893.33
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,879,305.27   @J=I:     23,000,795.26
	MW[11]   :        669,687.27   @J=I:            117.26
	MW[12]   :        468,893.33
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        815,105.27   @J=I:            785.26
	MO.01.001:        669,687.27
	MO.01.002:        468,893.33
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        815,105.27

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBW_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:54:58 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBO_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:54:59 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\NHB_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:00 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBSC_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:01 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:02
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\TDMAT00C.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:03 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\HBSC_distribution.PRN. 
DISTRIBUTION (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:03 2016
DISTRIBUTION ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_D2D_Flwos.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:03 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_noSchoolTrips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:03 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\PARAMS\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:03 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 480  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 481  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 482  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:54:58 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:54:58 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 483  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,259.2862   @J=I:         44.3122
	MI.02.DISTANCE:    473,080.99  
	MW[1]         :    -28,259.2862   @J=I:         44.3122
	MW[2]         :    465,580.2   
	MW[100]       :    231,193.214    @J=I:      1,137.4798
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,359.025 
	MW[115]       :     -7,313.53  
	MW[116]       :              --
	MW[200]       :    117,677.504    @J=I:      1,917.2351
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 1,917.23514

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 484  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:04 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:55:03 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,468, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 485  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      1,917.2
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      1,917.2
	MW[1]      :    117,677.5   @J=I:      1,917.2
	MW[2]      :    117,677.5   @J=I:      1,917.2
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_1.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:04 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 486  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 487  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 488  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:54:58 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:54:58 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 489  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,259.2862   @J=I:         44.3122
	MI.02.DISTANCE:    473,080.99  
	MW[1]         :    -28,259.2862   @J=I:         44.3122
	MW[2]         :    465,580.2   
	MW[100]       :    238,348.814    @J=I:      1,164.2798
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,359.025 
	MW[115]       :     -7,313.53  
	MW[116]       :      7,155.6      @J=I:         26.8   
	MW[200]       :    117,677.504    @J=I:      1,966.7882
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 1,966.78824

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 490  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:04 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:55:04 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,662, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 491  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      1,966.8
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      1,966.8
	MW[1]      :    117,677.5   @J=I:      1,966.8
	MW[2]      :    117,677.5   @J=I:      1,966.8
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_2.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:04 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 492  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 493  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 494  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:54:58 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:54:58 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 495  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,259.2862   @J=I:         44.3122
	MI.02.DISTANCE:    473,080.99  
	MW[1]         :    -28,259.2862   @J=I:         44.3122
	MW[2]         :    465,580.2   
	MW[100]       :    245,189.354    @J=I:      1,189.8998
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,359.025 
	MW[115]       :     -7,313.53  
	MW[116]       :     13,996.14     @J=I:         52.42  
	MW[200]       :    117,677.504    @J=I:      2,002.3399
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,002.33991

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 496  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:05 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:55:04 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,747, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 497  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,002.3
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,002.3
	MW[1]      :    117,677.5   @J=I:      2,002.3
	MW[2]      :    117,677.5   @J=I:      2,002.3
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_3.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:05 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 498  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 499  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 500  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:54:58 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:54:58 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 501  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,259.2862   @J=I:         44.3122
	MI.02.DISTANCE:    473,080.99  
	MW[1]         :    -28,259.2862   @J=I:         44.3122
	MW[2]         :    465,580.2   
	MW[100]       :    251,907.074    @J=I:      1,215.0598
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,359.025 
	MW[115]       :     -7,313.53  
	MW[116]       :     20,713.86     @J=I:         77.58  
	MW[200]       :    117,677.504    @J=I:      2,024.7908
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,024.7908 

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 502  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:05 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:55:05 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,834, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 503  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,024.8
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,024.8
	MW[1]      :    117,677.5   @J=I:      2,024.8
	MW[2]      :    117,677.5   @J=I:      2,024.8
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_4.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:05 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 504  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 505  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 506  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:54:58 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:54:58 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 507  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,259.2862   @J=I:         44.3122
	MI.02.DISTANCE:    473,080.99  
	MW[1]         :    -28,259.2862   @J=I:         44.3122
	MW[2]         :    465,580.2   
	MW[100]       :    258,723.584    @J=I:      1,240.5898
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,359.025 
	MW[115]       :     -7,313.53  
	MW[116]       :     27,530.37     @J=I:        103.11  
	MW[200]       :    117,677.504    @J=I:      2,037.8449
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,037.84485

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 508  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:06 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:55:05 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,916, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 509  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,037.8
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,037.8
	MW[1]      :    117,677.5   @J=I:      2,037.8
	MW[2]      :    117,677.5   @J=I:      2,037.8
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_5.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:06 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 510  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 511  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 512  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:54:58 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:54:58 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 513  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,259.2862   @J=I:         44.3122
	MI.02.DISTANCE:    473,080.99  
	MW[1]         :    -28,259.2862   @J=I:         44.3122
	MW[2]         :    465,580.2   
	MW[100]       :    265,403.924    @J=I:      1,265.6098
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,359.025 
	MW[115]       :     -7,313.53  
	MW[116]       :     34,210.71     @J=I:        128.13  
	MW[200]       :    117,677.504    @J=I:      2,044.7356
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,044.73558

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 514  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:06 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:55:06 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,913, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 515  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,044.7
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,044.7
	MW[1]      :    117,677.5   @J=I:      2,044.7
	MW[2]      :    117,677.5   @J=I:      2,044.7
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_6.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:06 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 516  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 517  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 518  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:54:58 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:54:58 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 519  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,259.2862   @J=I:         44.3122
	MI.02.DISTANCE:    473,080.99  
	MW[1]         :    -28,259.2862   @J=I:         44.3122
	MW[2]         :    465,580.2   
	MW[100]       :    272,164.364    @J=I:      1,290.9298
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,359.025 
	MW[115]       :     -7,313.53  
	MW[116]       :     40,971.15     @J=I:        153.45  
	MW[200]       :    117,677.504    @J=I:      2,050.8359
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,050.83592

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 520  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:07 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:55:06 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,969, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 521  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,050.8
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,050.8
	MW[1]      :    117,677.5   @J=I:      2,050.8
	MW[2]      :    117,677.5   @J=I:      2,050.8
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_7.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:07 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 522  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 523  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 524  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:54:58 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:54:58 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 525  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,259.2862   @J=I:         44.3122
	MI.02.DISTANCE:    473,080.99  
	MW[1]         :    -28,259.2862   @J=I:         44.3122
	MW[2]         :    465,580.2   
	MW[100]       :    278,882.084    @J=I:      1,316.0898
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,359.025 
	MW[115]       :     -7,313.53  
	MW[116]       :     47,688.87     @J=I:        178.61  
	MW[200]       :    117,677.504    @J=I:      2,052.5928
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,052.59277

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 526  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:07 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:55:07 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,939, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 527  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,052.6
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,052.6
	MW[1]      :    117,677.5   @J=I:      2,052.6
	MW[2]      :    117,677.5   @J=I:      2,052.6
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_8.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:07 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 528  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 529  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 530  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:54:58 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:54:58 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 531  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,259.2862   @J=I:         44.3122
	MI.02.DISTANCE:    473,080.99  
	MW[1]         :    -28,259.2862   @J=I:         44.3122
	MW[2]         :    465,580.2   
	MW[100]       :    285,770.684    @J=I:      1,341.8898
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,359.025 
	MW[115]       :     -7,313.53  
	MW[116]       :     54,577.47     @J=I:        204.41  
	MW[200]       :    117,677.504    @J=I:      2,054.8921
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,054.89208

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 532  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:08 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:55:07 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,981, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 533  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,054.9
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,054.9
	MW[1]      :    117,677.5   @J=I:      2,054.9
	MW[2]      :    117,677.5   @J=I:      2,054.9
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_9.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:08 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 534  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 535  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 536  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:54:58 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:54:58 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 537  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,259.2862   @J=I:         44.3122
	MI.02.DISTANCE:    473,080.99  
	MW[1]         :    -28,259.2862   @J=I:         44.3122
	MW[2]         :    465,580.2   
	MW[100]       :    292,499.084    @J=I:      1,367.0898
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,359.025 
	MW[115]       :     -7,313.53  
	MW[116]       :     61,305.87     @J=I:        229.61  
	MW[200]       :    117,677.504    @J=I:      2,055.151 
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,055.15104

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 538  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:08 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:55:08 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,956, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 539  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,055.2
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,055.2
	MW[1]      :    117,677.5   @J=I:      2,055.2
	MW[2]      :    117,677.5   @J=I:      2,055.2
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_10.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBO.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:09 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:09 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:09 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:09 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBSH.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:09 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:10 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:10 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:10 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_NHB.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:10 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:10 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:10 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:11 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_tlfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:11 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_ttfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:11 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_d2d_flows.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:11 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 584  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:11 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT",
 MO = 1, NAME = HBO_HBSH
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT"

MW[1] = MI.1.1 + MI.2.1


MATRIX Stack Size = 344 bytes.
................................................................................


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:55:09 2016 
ID=
PAR Zones=267 M=1
  HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:55:09 2016 
ID=
PAR Zones=267 M=1
  HBO

Totals after Iteration 1 I loop:

	MI.02.001: 136,095   @J=I:  11,950
	MI.01.001: 264,074   @J=I:  60,891
	MW[1]    : 400,170   @J=I:  72,841
	MO.01.001: 400,173

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 585  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:11 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 586  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2804 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:55:08 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:54:58 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 587  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 117,677.504    @J=I:   2,055.151 
	MI.01.001:  58,625.9251   @J=I:     182.5078
	MI.01.002:   5,643.9095   @J=I:      17.57  
	MI.01.003:   1,038.2895
	MI.01.004:           --
	MI.01.005:   5,980.8758   @J=I:      66.9222
	MI.01.006:  59,538.4004   @J=I:     182.5078
	MI.01.007:   5,731.7534   @J=I:      17.57  
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   6,018.8462   @J=I:      66.9222
	MW[1]    : 117,677.504    @J=I:   2,055.151 
	MW[2]    :  36,669.6856   @J=I:     704.9554
	MW[3]    :  81,007.8184   @J=I:   1,350.1956
	MW[11]   :  58,625.9251   @J=I:     182.5078
	MW[12]   :   5,643.9095   @J=I:      17.57  
	MW[13]   :   1,038.2895
	MW[14]   :           --
	MW[15]   :   5,980.8758   @J=I:      66.9222
	MW[16]   :  59,538.4004   @J=I:     182.5078
	MW[17]   :   5,731.7534   @J=I:      17.57  
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   6,018.8462   @J=I:      66.9222
	MW[21]   : 103,218.5219   @J=I:   1,395.2495
	MW[22]   :   9,936.8326   @J=I:     134.3205
	MW[23]   :   3,177.357 
	MW[24]   :           --
	MW[25]   :   1,344.7925   @J=I:     525.5811
	MO.01.001: 103,221.8   
	MO.01.002:   9,936.1   
	MO.01.003:   3,176.55  
	MO.01.005:   1,339.28  

Variable Values at end of Iteration 1 I loop:

    EDA: 103,218.5
    ESR:   9,936.8
    ELB:   3,177.4
    ENM:   1,344.8
    TRN:   3,177.4
    AUT: 113,155.4
    TOT: 117,677.5

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 588  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:11 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 589  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2808 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:55:11 2016 
ID=
PAR Zones=267 M=1
  HBO_HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:54:59 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 590  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 400,172.7      @J=I:  72,840.71  
	MI.01.001:  30,508.0122   @J=I:      83.9644
	MI.01.002:  31,525.2668   @J=I:      86.7641
	MI.01.003:     212.7325
	MI.01.004:           --
	MI.01.005:   9,042.9885   @J=I:      96.2716
	MI.01.006:  30,605.1238   @J=I:      83.9644
	MI.01.007:  31,625.6165   @J=I:      86.7641
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   9,058.2597   @J=I:      96.2716
	MW[1]    : 400,172.7      @J=I:  72,840.71  
	MW[2]    : 154,757.9936   @J=I:  25,125.2715
	MW[3]    : 245,414.7064   @J=I:  47,715.4385
	MW[11]   :  30,508.0122   @J=I:      83.9644
	MW[12]   :  31,525.2668   @J=I:      86.7641
	MW[13]   :     212.7325
	MW[14]   :           --
	MW[15]   :   9,042.9885   @J=I:      96.2716
	MW[16]   :  30,605.1238   @J=I:      83.9644
	MW[17]   :  31,625.6165   @J=I:      86.7641
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   9,058.2597   @J=I:      96.2716
	MW[21]   : 170,287.282    @J=I:  22,830.9601
	MW[22]   : 175,965.3156   @J=I:  23,592.2322
	MW[23]   :   2,287.9681
	MW[24]   :           --
	MW[25]   :  51,632.1343   @J=I:  26,417.5176
	MO.01.001: 170,280.22  
	MO.01.002: 175,978.32  
	MO.01.003:   2,287.1   
	MO.01.005:  51,625.86  

Variable Values at end of Iteration 1 I loop:

    EDA: 170,287.3
    ESR: 175,965.3
    ELB:   2,288  
    ENM:  51,632.1
    TRN:   2,288  
    AUT: 346,252.6
    TOT: 400,172.7

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################
Page 591  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:12 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 592  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2804 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:55:10 2016 
ID=
PAR Zones=267 M=1
  NHB

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:55:00 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 593  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 315,086.909    @J=I:  73,224.4046
	MI.01.001:  35,012.6762   @J=I:     118.4438
	MI.01.002:  32,743.6868   @J=I:     110.768 
	MI.01.003:      99.6389
	MI.01.004:           --
	MI.01.005:   3,432.9981   @J=I:      37.7882
	MI.01.006:  35,062.7852   @J=I:     118.4438
	MI.01.007:  32,790.5485   @J=I:     110.768 
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   3,435.6663   @J=I:      37.7882
	MW[1]    : 315,086.909    @J=I:  73,224.4046
	MW[2]    : 124,108.2788   @J=I:  27,626.1781
	MW[3]    : 190,978.6302   @J=I:  45,598.2265
	MW[11]   :  35,012.6762   @J=I:     118.4438
	MW[12]   :  32,743.6868   @J=I:     110.768 
	MW[13]   :      99.6389
	MW[14]   :           --
	MW[15]   :   3,432.9981   @J=I:      37.7882
	MW[16]   :  35,062.7852   @J=I:     118.4438
	MW[17]   :  32,790.5485   @J=I:     110.768 
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   3,435.6663   @J=I:      37.7882
	MW[21]   : 154,741.3237   @J=I:  32,419.6336
	MW[22]   : 144,713.3434   @J=I:  30,318.6858
	MW[23]   :     877.3254
	MW[24]   :           --
	MW[25]   :  14,754.9165   @J=I:  10,486.0853
	MO.01.001: 154,743.12  
	MO.01.002: 144,716.25  
	MO.01.003:     872.82  
	MO.01.005:  14,748.14  

Variable Values at end of Iteration 1 I loop:

    EDA: 154,741.324
    ESR: 144,713.343
    ELB:     877.325
    ENM:  14,754.917
    TRN:     877.325
    AUT: 299,454.667
    TOT: 315,086.909

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 594  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:12 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 595  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2822 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:55:03 2016 
ID=
PAR Zones=267 M=1
  HBSC

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:55:01 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 596  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001:  7,669.47     @J=I:  1,017.22  
	MI.01.001: 35,012.6762   @J=I:    118.4438
	MI.01.002: 32,743.6868   @J=I:    110.768 
	MI.01.003:     99.6389
	MI.01.004:          --
	MI.01.005:  3,432.9981   @J=I:     37.7882
	MI.01.006: 35,062.7852   @J=I:    118.4438
	MI.01.007: 32,790.5485   @J=I:    110.768 
	MI.01.008:          --
	MI.01.009:          --
	MI.01.010:  3,435.6663   @J=I:     37.7882
	MW[1]    :  7,669.47     @J=I:  1,017.22  
	MW[2]    :  2,630.5239   @J=I:    325.6939
	MW[3]    :  5,038.9461   @J=I:    691.5261
	MW[11]   : 35,012.6762   @J=I:    118.4438
	MW[12]   : 32,743.6868   @J=I:    110.768 
	MW[13]   :     99.6389
	MW[14]   :          --
	MW[15]   :  3,432.9981   @J=I:     37.7882
	MW[16]   : 35,062.7852   @J=I:    118.4438
	MW[17]   : 32,790.5485   @J=I:    110.768 
	MW[18]   :          --
	MW[19]   :          --
	MW[20]   :  3,435.6663   @J=I:     37.7882
	MW[21]   :  3,762.1055   @J=I:    451.1633
	MW[22]   :  3,518.303    @J=I:    421.9257
	MW[23]   :     22.8817
	MW[24]   :          --
	MW[25]   :    366.1798   @J=I:    144.131 
	MO.01.001:  3,770.14  
	MO.01.002:  3,510.76  
	MO.01.003:     21.8   
	MO.01.005:    365.1   

Variable Values at end of Iteration 1 I loop:

    EDA: 3,762.1055
    ESR: 3,518.303 
    ELB:    22.8817
    ENM:   366.1798
    TRN:    22.8817
    AUT: 7,280.4085
    TOT: 7,669.47  

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_AM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:12 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_MD.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:13 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_PM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:13 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_NT.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:13 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\MC_Transit_Trips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:14 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:14 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\AM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:14 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:16
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:30 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\MD.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:30 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:20
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:50 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:55:50 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:22
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:12 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\NT.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:13 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:03
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Merge_Hwy_Assignments.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:16 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Hwy_eval.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:16 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PBHWY00B.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:16 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\PBHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:17 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\Output\PK_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\PK_HWYSKIM_4.MAT
M(100): COPY C:\projects\Roanoke\Base\Output\OP_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\OP_HWYSKIM_4.MATPage 689  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:17 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\pk_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\PK_CNG_HwySkim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1330 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\PK_CNG_HwySkim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Sun Mar 27 18:56:16 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 690  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,648,814.5   @J=I:     23,000,116.7
	MI.01.002: 22,402,472,857.3
	MI.01.003:         90,513     @J=I:            339  
	MI.01.004:        119,105     @J=I:            339  
	MI.01.005: 22,425,858,432.5   @J=I:     23,000,794.7
	MW[1]    : 22,425,648,814.5   @J=I:     23,000,116.7
	MW[2]    : 22,402,472,857.3
	MW[3]    :         90,513     @J=I:            339  
	MW[4]    :        119,105     @J=I:            339  
	MW[5]    : 22,425,858,432.5   @J=I:     23,000,794.7
	MW[11]   :        648,814.5   @J=I:            116.7
	MW[12]   :        472,857.3
	MW[13]   :         90,513     @J=I:            339  
	MW[14]   :        119,105     @J=I:            339  
	MW[15]   :        794,232.5   @J=I:            784.7
	MO.01.001:        648,814.5
	MO.01.002:        472,857.3
	MO.01.003:         90,513  
	MO.01.004:        119,105  
	MO.01.005:        794,232.5

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 691  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:17 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_CNG_HwySkim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1330 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\OP_CNG_HwySkim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Sun Mar 27 18:56:17 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 692  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,669,624.17   @J=I:     23,000,117.24
	MI.01.002: 22,402,468,681.81
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,879,242.17   @J=I:     23,000,795.24
	MW[1]    : 22,425,669,624.17   @J=I:     23,000,117.24
	MW[2]    : 22,402,468,681.81
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,879,242.17   @J=I:     23,000,795.24
	MW[11]   :        669,624.17   @J=I:            117.24
	MW[12]   :        468,681.81
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        815,042.17   @J=I:            785.24
	MO.01.001:        669,624.17
	MO.01.002:        468,681.81
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        815,042.17

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBW_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:18 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBO_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:19 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\NHB_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:20 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBSC_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:21 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\TDMAT00C.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:22 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\HBSC_distribution.PRN. 
DISTRIBUTION (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:22 2016
DISTRIBUTION ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_D2D_Flwos.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:23 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_noSchoolTrips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:23 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\PARAMS\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:23 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 756  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 757  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 758  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:18 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:17 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 759  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,251.1606   @J=I:         44.3118
	MI.02.DISTANCE:    472,857.34  
	MW[1]         :    -28,251.1606   @J=I:         44.3118
	MW[2]         :    465,357.01  
	MW[100]       :    231,222.2821   @J=I:      1,137.4796
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,330.3238
	MW[115]       :     -7,321.8   
	MW[116]       :              --
	MW[200]       :    117,677.504    @J=I:      1,915.1861
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 1,915.18612

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 760  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:23 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:23 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,470, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 761  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      1,915.2
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      1,915.2
	MW[1]      :    117,677.5   @J=I:      1,915.2
	MW[2]      :    117,677.5   @J=I:      1,915.2
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_1.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:23 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 762  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 763  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 764  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:18 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:17 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 765  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,251.1606   @J=I:         44.3118
	MI.02.DISTANCE:    472,857.34  
	MW[1]         :    -28,251.1606   @J=I:         44.3118
	MW[2]         :    465,357.01  
	MW[100]       :    238,383.2221   @J=I:      1,164.2996
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,330.3238
	MW[115]       :     -7,321.8   
	MW[116]       :      7,160.94     @J=I:         26.82  
	MW[200]       :    117,677.504    @J=I:      1,965.2916
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 1,965.29164

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 766  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:24 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:23 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,649, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 767  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      1,965.3
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      1,965.3
	MW[1]      :    117,677.5   @J=I:      1,965.3
	MW[2]      :    117,677.5   @J=I:      1,965.3
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_2.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:24 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 768  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 769  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 770  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:18 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:17 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 771  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,251.1606   @J=I:         44.3118
	MI.02.DISTANCE:    472,857.34  
	MW[1]         :    -28,251.1606   @J=I:         44.3118
	MW[2]         :    465,357.01  
	MW[100]       :    245,223.7621   @J=I:      1,189.9196
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,330.3238
	MW[115]       :     -7,321.8   
	MW[116]       :     14,001.48     @J=I:         52.44  
	MW[200]       :    117,677.504    @J=I:      2,001.1914
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,001.1914 

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 772  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:24 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:24 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,740, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 773  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,001.2
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,001.2
	MW[1]      :    117,677.5   @J=I:      2,001.2
	MW[2]      :    117,677.5   @J=I:      2,001.2
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_3.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:24 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 774  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 775  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 776  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:18 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:17 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 777  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,251.1606   @J=I:         44.3118
	MI.02.DISTANCE:    472,857.34  
	MW[1]         :    -28,251.1606   @J=I:         44.3118
	MW[2]         :    465,357.01  
	MW[100]       :    251,941.4821   @J=I:      1,215.0796
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,330.3238
	MW[115]       :     -7,321.8   
	MW[116]       :     20,719.2      @J=I:         77.6   
	MW[200]       :    117,677.504    @J=I:      2,023.5669
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,023.56687

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 778  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:25 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:24 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,833, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 779  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,023.6
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,023.6
	MW[1]      :    117,677.5   @J=I:      2,023.6
	MW[2]      :    117,677.5   @J=I:      2,023.6
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_4.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:25 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 780  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 781  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 782  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:18 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:17 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 783  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,251.1606   @J=I:         44.3118
	MI.02.DISTANCE:    472,857.34  
	MW[1]         :    -28,251.1606   @J=I:         44.3118
	MW[2]         :    465,357.01  
	MW[100]       :    258,760.6621   @J=I:      1,240.6196
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,330.3238
	MW[115]       :     -7,321.8   
	MW[116]       :     27,538.38     @J=I:        103.14  
	MW[200]       :    117,677.504    @J=I:      2,037.5554
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,037.55539

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 784  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:25 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:25 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,908, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 785  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,037.6
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,037.6
	MW[1]      :    117,677.5   @J=I:      2,037.6
	MW[2]      :    117,677.5   @J=I:      2,037.6
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_5.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:25 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 786  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 787  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 788  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:18 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:17 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 789  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,251.1606   @J=I:         44.3118
	MI.02.DISTANCE:    472,857.34  
	MW[1]         :    -28,251.1606   @J=I:         44.3118
	MW[2]         :    465,357.01  
	MW[100]       :    265,598.5321   @J=I:      1,266.2296
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,330.3238
	MW[115]       :     -7,321.8   
	MW[116]       :     34,376.25     @J=I:        128.75  
	MW[200]       :    117,677.504    @J=I:      2,044.6683
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,044.66834

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 790  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:26 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:25 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,910, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 791  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,044.7
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,044.7
	MW[1]      :    117,677.5   @J=I:      2,044.7
	MW[2]      :    117,677.5   @J=I:      2,044.7
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_6.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:26 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 792  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 793  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 794  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:18 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:17 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 795  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,251.1606   @J=I:         44.3118
	MI.02.DISTANCE:    472,857.34  
	MW[1]         :    -28,251.1606   @J=I:         44.3118
	MW[2]         :    465,357.01  
	MW[100]       :    272,369.6521   @J=I:      1,291.5896
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,330.3238
	MW[115]       :     -7,321.8   
	MW[116]       :     41,147.37     @J=I:        154.11  
	MW[200]       :    117,677.504    @J=I:      2,051.1022
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,051.10224

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 796  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:26 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:26 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,944, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 797  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,051.1
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,051.1
	MW[1]      :    117,677.5   @J=I:      2,051.1
	MW[2]      :    117,677.5   @J=I:      2,051.1
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_7.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:26 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 798  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 799  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 800  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:18 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:17 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 801  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,251.1606   @J=I:         44.3118
	MI.02.DISTANCE:    472,857.34  
	MW[1]         :    -28,251.1606   @J=I:         44.3118
	MW[2]         :    465,357.01  
	MW[100]       :    279,076.6921   @J=I:      1,316.7096
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,330.3238
	MW[115]       :     -7,321.8   
	MW[116]       :     47,854.41     @J=I:        179.23  
	MW[200]       :    117,677.504    @J=I:      2,052.4449
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,052.4449 

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 802  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:27 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:26 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,924, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 803  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,052.4
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,052.4
	MW[1]      :    117,677.5   @J=I:      2,052.4
	MW[2]      :    117,677.5   @J=I:      2,052.4
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_8.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:27 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 804  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 805  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 806  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:18 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:17 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 807  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,251.1606   @J=I:         44.3118
	MI.02.DISTANCE:    472,857.34  
	MW[1]         :    -28,251.1606   @J=I:         44.3118
	MW[2]         :    465,357.01  
	MW[100]       :    285,813.1021   @J=I:      1,341.9396
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,330.3238
	MW[115]       :     -7,321.8   
	MW[116]       :     54,590.82     @J=I:        204.46  
	MW[200]       :    117,677.504    @J=I:      2,055.2631
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,055.26305

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 808  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:27 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:27 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,966, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 809  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,055.3
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,055.3
	MW[1]      :    117,677.5   @J=I:      2,055.3
	MW[2]      :    117,677.5   @J=I:      2,055.3
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_9.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:27 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 810  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 811  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 812  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:18 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:17 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = -0.39182
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.28
         COEFF(1,19)  = 0.05


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 813  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,251.1606   @J=I:         44.3118
	MI.02.DISTANCE:    472,857.34  
	MW[1]         :    -28,251.1606   @J=I:         44.3118
	MW[2]         :    465,357.01  
	MW[100]       :    292,541.5021   @J=I:      1,367.1396
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,330.3238
	MW[115]       :     -7,321.8   
	MW[116]       :     61,319.22     @J=I:        229.66  
	MW[200]       :    117,677.504    @J=I:      2,054.5355
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :    -0.39182
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.28   
    KDIST67       :     0.05   
    INTRAZONAL_SUM: 2,054.53548

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 814  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:28 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:27 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,953, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 815  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      2,054.5
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      2,054.5
	MW[1]      :    117,677.5   @J=I:      2,054.5
	MW[2]      :    117,677.5   @J=I:      2,054.5
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_10.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBO.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:28 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:28 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:29 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:29 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBSH.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:29 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:29 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:29 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:29 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_NHB.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:29 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:30 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:30 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:30 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_tlfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:30 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_ttfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:30 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_d2d_flows.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:30 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 860  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:30 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT",
 MO = 1, NAME = HBO_HBSH
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT"

MW[1] = MI.1.1 + MI.2.1


MATRIX Stack Size = 344 bytes.
................................................................................


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:29 2016 
ID=
PAR Zones=267 M=1
  HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:28 2016 
ID=
PAR Zones=267 M=1
  HBO

Totals after Iteration 1 I loop:

	MI.02.001: 136,095   @J=I:  11,947
	MI.01.001: 264,074   @J=I:  60,870
	MW[1]    : 400,170   @J=I:  72,817
	MO.01.001: 400,173

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 861  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:30 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 862  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2804 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:27 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:18 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 863  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 117,677.504    @J=I:   2,054.5355
	MI.01.001:  58,625.8204   @J=I:     182.5078
	MI.01.002:   5,643.8995   @J=I:      17.57  
	MI.01.003:   1,038.1707
	MI.01.004:           --
	MI.01.005:   5,981.1094   @J=I:      66.9222
	MI.01.006:  59,538.1662   @J=I:     182.5078
	MI.01.007:   5,731.7309   @J=I:      17.57  
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   6,019.1029   @J=I:      66.9222
	MW[1]    : 117,677.504    @J=I:   2,054.5355
	MW[2]    :  36,667.7993   @J=I:     704.487 
	MW[3]    :  81,009.7047   @J=I:   1,350.0485
	MW[11]   :  58,625.8204   @J=I:     182.5078
	MW[12]   :   5,643.8995   @J=I:      17.57  
	MW[13]   :   1,038.1707
	MW[14]   :           --
	MW[15]   :   5,981.1094   @J=I:      66.9222
	MW[16]   :  59,538.1662   @J=I:     182.5078
	MW[17]   :   5,731.7309   @J=I:      17.57  
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   6,019.1029   @J=I:      66.9222
	MW[21]   : 103,216.6362   @J=I:   1,394.8287
	MW[22]   :   9,936.651    @J=I:     134.28  
	MW[23]   :   3,178.1013
	MW[24]   :           --
	MW[25]   :   1,346.1155   @J=I:     525.4268
	MO.01.001: 103,220.01  
	MO.01.002:   9,936.17  
	MO.01.003:   3,177.13  
	MO.01.005:   1,340.65  

Variable Values at end of Iteration 1 I loop:

    EDA: 103,216.6
    ESR:   9,936.7
    ELB:   3,178.1
    ENM:   1,346.1
    TRN:   3,178.1
    AUT: 113,153.3
    TOT: 117,677.5

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################
Page 864  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:31 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 865  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2808 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:30 2016 
ID=
PAR Zones=267 M=1
  HBO_HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:19 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 866  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 400,173.32     @J=I:  72,817.51  
	MI.01.001:  30,507.9685   @J=I:      83.9644
	MI.01.002:  31,525.2217   @J=I:      86.7641
	MI.01.003:     212.6955
	MI.01.004:           --
	MI.01.005:   9,043.1143   @J=I:      96.2715
	MI.01.006:  30,605.0613   @J=I:      83.9644
	MI.01.007:  31,625.5519   @J=I:      86.7641
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   9,058.3868   @J=I:      96.2715
	MW[1]    : 400,173.32     @J=I:  72,817.51  
	MW[2]    : 154,750.3406   @J=I:  25,113.5178
	MW[3]    : 245,422.9794   @J=I:  47,703.9922
	MW[11]   :  30,507.9685   @J=I:      83.9644
	MW[12]   :  31,525.2217   @J=I:      86.7641
	MW[13]   :     212.6955
	MW[14]   :           --
	MW[15]   :   9,043.1143   @J=I:      96.2715
	MW[16]   :  30,605.0613   @J=I:      83.9644
	MW[17]   :  31,625.5519   @J=I:      86.7641
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   9,058.3868   @J=I:      96.2715
	MW[21]   : 170,293.8929   @J=I:  22,823.6341
	MW[22]   : 175,972.1469   @J=I:  23,584.6619
	MW[23]   :   2,287.7513
	MW[24]   :           --
	MW[25]   :  51,619.5289   @J=I:  26,409.214 
	MO.01.001: 170,286.83  
	MO.01.002: 175,985.3   
	MO.01.003:   2,286.79  
	MO.01.005:  51,613.09  

Variable Values at end of Iteration 1 I loop:

    EDA: 170,293.9
    ESR: 175,972.1
    ELB:   2,287.8
    ENM:  51,619.5
    TRN:   2,287.8
    AUT: 346,266  
    TOT: 400,173.3

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 867  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:31 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 868  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2804 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:29 2016 
ID=
PAR Zones=267 M=1
  NHB

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:20 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 869  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 315,086.909    @J=I:  73,201.0988
	MI.01.001:  35,012.6803   @J=I:     118.4438
	MI.01.002:  32,743.6906   @J=I:     110.7681
	MI.01.003:      99.6238
	MI.01.004:           --
	MI.01.005:   3,433.0054   @J=I:      37.7882
	MI.01.006:  35,062.7815   @J=I:     118.4438
	MI.01.007:  32,790.545    @J=I:     110.7681
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   3,435.6736   @J=I:      37.7882
	MW[1]    : 315,086.909    @J=I:  73,201.0988
	MW[2]    : 124,101.8224   @J=I:  27,613.8122
	MW[3]    : 190,985.0866   @J=I:  45,587.2866
	MW[11]   :  35,012.6803   @J=I:     118.4438
	MW[12]   :  32,743.6906   @J=I:     110.7681
	MW[13]   :      99.6238
	MW[14]   :           --
	MW[15]   :   3,433.0054   @J=I:      37.7882
	MW[16]   :  35,062.7815   @J=I:     118.4438
	MW[17]   :  32,790.545    @J=I:     110.7681
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   3,435.6736   @J=I:      37.7882
	MW[21]   : 154,743.5907   @J=I:  32,409.2684
	MW[22]   : 144,715.4634   @J=I:  30,308.9923
	MW[23]   :     877.184 
	MW[24]   :           --
	MW[25]   :  14,750.6709   @J=I:  10,482.8381
	MO.01.001: 154,745.2   
	MO.01.002: 144,717.99  
	MO.01.003:     872.71  
	MO.01.005:  14,744.03  

Variable Values at end of Iteration 1 I loop:

    EDA: 154,743.591
    ESR: 144,715.463
    ELB:     877.184
    ENM:  14,750.671
    TRN:     877.184
    AUT: 299,459.054
    TOT: 315,086.909

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 870  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:31 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 871  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2822 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:23 2016 
ID=
PAR Zones=267 M=1
  HBSC

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Sun Mar 27 18:56:21 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 872  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001:  7,669.47     @J=I:  1,017.2   
	MI.01.001: 35,012.6803   @J=I:    118.4438
	MI.01.002: 32,743.6906   @J=I:    110.7681
	MI.01.003:     99.6238
	MI.01.004:          --
	MI.01.005:  3,433.0054   @J=I:     37.7882
	MI.01.006: 35,062.7815   @J=I:    118.4438
	MI.01.007: 32,790.545    @J=I:    110.7681
	MI.01.008:          --
	MI.01.009:          --
	MI.01.010:  3,435.6736   @J=I:     37.7882
	MW[1]    :  7,669.47     @J=I:  1,017.2   
	MW[2]    :  2,630.4874   @J=I:    325.6598
	MW[3]    :  5,038.9826   @J=I:    691.5402
	MW[11]   : 35,012.6803   @J=I:    118.4438
	MW[12]   : 32,743.6906   @J=I:    110.7681
	MW[13]   :     99.6238
	MW[14]   :          --
	MW[15]   :  3,433.0054   @J=I:     37.7882
	MW[16]   : 35,062.7815   @J=I:    118.4438
	MW[17]   : 32,790.545    @J=I:    110.7681
	MW[18]   :          --
	MW[19]   :          --
	MW[20]   :  3,435.6736   @J=I:     37.7882
	MW[21]   :  3,762.1076   @J=I:    451.1547
	MW[22]   :  3,518.305    @J=I:    421.9177
	MW[23]   :     22.8783
	MW[24]   :          --
	MW[25]   :    366.1791   @J=I:    144.1276
	MO.01.001:  3,770.15  
	MO.01.002:  3,510.87  
	MO.01.003:     21.8   
	MO.01.005:    365.07  

Variable Values at end of Iteration 1 I loop:

    EDA: 3,762.1076
    ESR: 3,518.305 
    ELB:    22.8783
    ENM:   366.1791
    TRN:    22.8783
    AUT: 7,280.4126
    TOT: 7,669.47  

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_AM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:32 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_MD.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:32 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_PM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:32 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_NT.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:33 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\MC_Transit_Trips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:33 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:33 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\AM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:34 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:23
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:57 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\MD.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:56:57 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:19
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:57:16 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:57:17 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:27
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:57:44 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\NT.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:57:45 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:03
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Merge_Hwy_Assignments.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Sun Mar 27 18:57:48 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Hwy_eval.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Sun Mar 27 18:57:48 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PBHWY00B.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:57:49 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\PBHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Sun Mar 27 18:57:49 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\Output\PK_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\PK_HWYSKIM_5.MAT
M(100): COPY C:\projects\Roanoke\Base\Output\OP_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\OP_HWYSKIM_5.MAT

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\Trn_Assignment_PK.PRN. 
PUBLIC TRANSPORT (v.08/05/2014 [6.1.1])  Sun Mar 27 18:57:49 2016
PUBLIC TRANSPORT ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\Trn_Assignment_OP.PRN. 
PUBLIC TRANSPORT (v.08/05/2014 [6.1.1])  Sun Mar 27 18:57:50 2016
PUBLIC TRANSPORT ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################


--------------------------------------------------------------------------------

SYS "COPY "C:\projects\Roanoke\CUBE\*.PRN" "C:\projects\Roanoke\Base\OUTPUT\LOGS\*.PRN""
C:\projects\Roanoke\CUBE\ASHWY00A.PRN
C:\projects\Roanoke\CUBE\CVMAT00B.PRN
C:\projects\Roanoke\CUBE\PBHWY00A.PRN
C:\projects\Roanoke\CUBE\Roanoke Area MPO Model_0000.PRN
        4 file(s) copied.

SYS ReturnCode = 0

--------------------------------------------------------------------------------

--------------------------------------------------------------------------------

SYS "DEL "C:\projects\Roanoke\CUBE\*.PRN""
C:\projects\Roanoke\CUBE\Roanoke Area MPO Model_0000.PRN

SYS ReturnCode = 0

--------------------------------------------------------------------------------

VOYAGER  ReturnCode = 1  Elapsed Time = 00:07:31