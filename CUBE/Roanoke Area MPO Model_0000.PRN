Page 1  (VOYAGER PILOT) 
Parsons Brinckerhoff
------------------------
PILOT (v.08/05/2014 [6.1.1]) Tue Mar 29 14:11:00 2016

Args: C:\Users\SARVEP~1\AppData\Local\Temp\Cit1ECD.tmp -SC:\PROJECTS\ROANOKE\CUBE\ -RC:\projects\Roanoke\Cube\Roanoke Area MPO Model_0000.PRN -PH:58 -PW:80 -I -P"Roan"
Input:   C:\Users\SARVEP~1\AppData\Local\Temp\Cit1ECD.tmp

SYS=(del C:\projects\Roanoke\CUBE\*.prn)
SYS=(del C:\projects\Roanoke\CUBE\*.bak)
SYS=(del C:\projects\Roanoke\CUBE\*.0??)
SYS=(del C:\projects\Roanoke\CUBE\trc*.s)
SYS=(IF NOT EXIST "C:\projects\Roanoke\Base\Output" MKDIR "C:\projects\Roanoke\Base\Output")
SYS=(IF NOT EXIST "C:\projects\Roanoke\Base\OUTPUT" MKDIR "C:\projects\Roanoke\Base\OUTPUT")
SYS=(IF NOT EXIST "C:\projects\Roanoke\Base\OUTPUT\LOGS" MKDIR "C:\projects\Roanoke\Base\OUTPUT\LOGS")
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\scenario.properties"
 print list = 'About the scenario'    printo = 1
 print list = '-----------------------------------'             printo = 1
 print list = 'SCENARIO_FULLNAME  = ', 'Base'    printo = 1
 print list = 'SCENARIO_SHORTNAME = ', 'Base'   printo = 1
 print list = 'SCENARIO_CODE      = ', '0000'        printo = 1
 print list = 'SCENARIO_DIR       = ', 'C:\projects\Roanoke\Base'         printo = 1
 print list = 'CATALOG_DIR        = ', 'C:\projects\Roanoke'          printo = 1
 print list = 'Alternative        = ', 'A'          printo = 1
 print list = 'Description        = ', 'Year 2012 Calibration Scenario'          printo = 1
 print list = 'Year               = ', '2012'                 printo = 1
 print list = '\n \nModel settings'    printo = 1
 print list = '-----------------------------------'             printo = 1
 print list = 'Total-Zones        = ', '267'          printo = 1
 print list = 'ZONESA             = ', '264'               printo = 1
 print list = 'Internal-Zones     = ', '206'       printo = 1
 print list = 'MAXWLKACCLNKS      = ', '5'        printo = 1
 print list = 'NODEMIN            = ', '1000'              printo = 1
 print list = 'Radius             = ', '1.5'               printo = 1
 print list = 'AVGWLKSPD          = ', '2.5'            printo = 1
 print list = 'UNIT               = ', '2'                 printo = 1
 print list = 'WALKACC            = ', '0.6'              printo = 1
 print list = '\n \nDebug and select link settings'             printo = 1
 print list = '-----------------------------------'             printo = 1
 print list = 'DebugDC            = ', '1'              printo = 1
 print list = 'FromNode           = ', '179'             printo = 1
 print list = 'ToNode             = ', '200'               printo = 1
 print list = 'SelOrigin          = ', '1'            printo = 1
 print list = 'SelDest            = ', '159'              printo = 1
 print list = 'SelectLink         = ', 'L=4561-4556'           printo = 1
RUN PGM=NETWORK,2931 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\AT_1.PRN" MSG='OUTPUT LINK AND ZONE DATA'
RUN PGM=MATRIX,4417 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\AT_2.PRN" MSG='FIND THE CLOSEST ZONE TO EACH LINK'
RUN PGM=NETWORK,5708 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\AT_3.PRN" MSG='INSERT LINK DATA TO NETWORK'
RUN PGM=NETWORK,6927 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\AT_4.PRN" MSG='ADD LAND USE DATA TO ZONES'
RUN PGM=NETWORK,8069 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\AT-5.PRN" MSG='DETERMINE AREA TYPE FROM LAND USE DENSITY AND PROXIMITY'
RUN PGM=NETWORK,11503 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\AT_6.PRN" MSG='INSERT LINK AREA TYPE ON THE NETWORK'
RUN PGM=MATRIX,12767 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\AT_7.PRN" MSG='OUTPUT AREA TYPE AS DBF FOR LATER USE'
Rexe = 'C:\projects\Roanoke\R\R-3.2.2\bin\Rscript.exe'
Rscript = 'C:\projects\Roanoke\R\calculate_capacities.R'
link_file = 'C:\projects\Roanoke\Base\Output\link_atype2012A.DBF'
output_file = 'C:\projects\Roanoke\Base\Output\link_capacities2012A.DBF'
PRINT LIST= Rexe ' ' Rscript ' ' link_file ' ' output_file,Page 2  (VOYAGER PILOT) 
Parsons Brinckerhoff
------------------------
 FILE = "C:\projects\Roanoke\CUBE\LINK_CALC.BAT"
SYS=(C:\projects\Roanoke\CUBE\LINK_CALC.BAT)
RUN PGM=NETWORK,14962 MSG='Attach capacity and FFS to network'
RUN PGM=HIGHWAY,17535 PRNFILE="C:\projects\Roanoke\Base\Output\Logs\FreeFlowSpeeds.PRN" MSG='Build Initial Skims'
SYS=(COPY C:\projects\Roanoke\Base\Output\IMPED11.MAT C:\projects\Roanoke\Base\OUTPUT\PK_FreeFlow_Skim.MAT)
SYS=(COPY C:\projects\Roanoke\Base\Output\IMPED11.MAT C:\projects\Roanoke\Base\OUTPUT\OP_FreeFlow_Skim.MAT)
Rexe = 'C:\projects\Roanoke\R\R-3.2.2\bin\Rscript.exe'
Rscript = 'C:\projects\Roanoke\R\classification.R'
input_se_file = 'C:\projects\Roanoke\Base\Input\se.dbf'
lookup_dir = 'C:\projects\Roanoke\Params\classification'
output_file = 'C:\projects\Roanoke\Base\Output\se_classified_2012A.dbf'
PRINT LIST= Rexe ' ' Rscript ' ' input_se_file ' ' lookup_dir ' ' output_file,
 FILE = "C:\projects\Roanoke\CUBE\CLASSIFICATION.BAT"
SYS=(C:\projects\Roanoke\CUBE\CLASSIFICATION.BAT)
RUN PGM=GENERATION,20983 MSG='Household Trip Production'
RUN PGM=NETWORK,28092 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\TransitSpeeds.PRN" MSG='Transit Speeds'
RUN PGM='PUBLIC TRANSPORT',31736 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\BuildWalkAccessConenctors.PRN" MSG='Build Walk Access Connectors'
RUN PGM=MATRIX,34031 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\WalkAccess_ByMode.PRN" MSG='Subdivide Connectors into Separate Files by Mode'
RUN PGM='PUBLIC TRANSPORT',36032 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\Trn_PK_Skims.PRN" MSG='PK-Walk Access Paths / Skims'
RUN PGM='PUBLIC TRANSPORT',39883 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\Trn_OP_Skims.PRN" MSG='OP-Walk Access Paths / Skims'
RUN PGM=FRATAR,43665 MSG='Future year EE Table'
RUN PGM=MATRIX,44530
RUN PGM=MATRIX,45233 MSG='Process Highway Skims'
RUN PGM=GENERATION,46341 MSG='IEEI_TripGen'
RUN PGM=MATRIX,47741 MSG='NR-NHB Model'
RUN PGM=DISTRIBUTION,48389 MSG='IEEI_TripDist'
RUN PGM=MATRIX,49696
RUN PGM=MATRIX,51308 MSG='EE TOD'
RUN PGM=GENERATION,52476 MSG='CV_TripGen'
RUN PGM=DISTRIBUTION,53817
RUN PGM=MATRIX,55938
RUN PGM=MATRIX,57389 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\CV_TLFD.PRN" MSG='Trip Length Frequency'
LOOP FeedBack_ITER = 1, 5, 1
IF (FeedBack_ITER=1)
FB_ITER = 1
pk_hwy_skim = 'PK_FreeFlow_Skim.MAT'
OP_hwy_skim = 'OP_FreeFlow_Skim.MAT'
ELSE
pk_hwy_skim = 'PK_CNG_HwySkim.MAT'
OP_hwy_skim = 'OP_CNG_HwySkim.MAT'
ENDIF
RUN PGM=MATRIX,60864 MSG='Process Highway Skims'
RUN PGM=MATRIX,61930 MSG='Process Highway Skims'
  LOOP PURPOSE = 1, 4, 1
IF (PURPOSE=1) ; HBW Purpose
PURP='HBW'
PURPNO=3
PRK='LONGPARK'
hwySkim = 'pk_Hwyskim.MAT'
busSkim = 'pk_TSKIMBus.MAT'
premSkim = 'PK_TSKIMPrem.MAT'
ELSEIF (PURPOSE=2) ; HBO Purpose
PURP='HBO'
PURPNO=4Page 3  (VOYAGER PILOT) 
Parsons Brinckerhoff
------------------------
PRK='LONGPARK'
hwySkim = 'op_Hwyskim.MAT'
busSkim = 'op_TSKIMBus.MAT'
premSkim = 'op_TSKIMPrem.MAT'
ELSEIF (PURPOSE=3) ; NHB Purpose
PURP='NHB'
PURPNO=5
PRK='LONGPARK'
hwySkim = 'op_Hwyskim.MAT'
busSkim = 'op_TSKIMBus.MAT'
premSkim = 'op_TSKIMPrem.MAT'
ELSEIF (PURPOSE=4) ; HBSC Purpose
PURP='HBSC'
PURPNO=5
PRK='LONGPARK'
hwySkim = 'op_Hwyskim.MAT'
busSkim = 'op_TSKIMBus.MAT'
premSkim = 'op_TSKIMPrem.MAT'
ENDIF
RUN PGM=MATRIX,63880 PRNFILE="C:\projects\Roanoke\Base\Output\LOGS\@PURP@_logsum.PRN" MSG='Mode Choice Logsums and Probabilities'
  ENDLOOP
RUN PGM=MATRIX,76306 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\TDMAT00C.PRN" MSG='HBSC FF'
RUN PGM=DISTRIBUTION,77023 PRNFILE="C:\projects\Roanoke\Base\Output\Logs\HBSC_distribution.PRN" MSG='Gravity Model - HBSC'
RUN PGM=MATRIX,78468 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_D2D_Flwos.PRN" MSG='HBSC District - to - District Flows'
RUN PGM=MATRIX,79099 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_noSchoolTrips.PRN" MSG='HBSC - no sch bus trips'
SYS=(COPY C:\projects\Roanoke\PARAMS\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf)
  LOOP Iteration = 1, 10, 1
RUN PGM=MATRIX,79781 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN" MSG='HBW Apply Destination Choice Model'
RUN PGM=MATRIX,88717 MSG='Shadow Price'
SYS=(COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_@ITERATION@.dbf)
  ENDLOOP
  LOOP PURPOSE = 2, 4, 1
IF (PURPOSE=1) ; HBW PK
PURP='HBW'
MCLS_MAT = 'HBW'
PERIOD='PK'
PURPNO=1
MARKETS=1
isHBW=' '
noHBW=';'
isNHB=';'
noNHB=' '
PRINT LIST="Trip Distribution Loop Number = 1 of 4 HBW", printo=0
ELSEIF (PURPOSE=2) ; HBO
PURP='HBO'
MCLS_MAT = 'HBO'
PERIOD='PK'
PURPNO=2
MARKETS=1
isHBW=';'
noHBW=' '
isNHB=';'
noNHB=' '
PRINT LIST="Trip Distribution Loop Number = 2 of 4 HBO ", printo=0Page 4  (VOYAGER PILOT) 
Parsons Brinckerhoff
------------------------
ELSEIF (PURPOSE=3) ; HBSH
PURP='HBSH'
MCLS_MAT = 'HBO'
PERIOD='PK'
PURPNO=3
MARKETS=1
isHBW=';'
noHBW=' '
isNHB=';'
noNHB=' '
PRINT LIST="Trip Distribution Loop Number = 3 of 4 HBSH", printo=0
ELSEIF (PURPOSE=4) ; NHBW
PURP='NHB'
MCLS_MAT = 'NHB'
PERIOD='PK'
PURPNO=4
MARKETS=1
isHBW=';'
noHBW=' '
isNHB=' '
noNHB=';'
PRINT LIST="Trip Distribution Loop Number = 4 of 4 NHB ", printo=0
ENDIF
RUN PGM=MATRIX,90656 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_@PURP@.PRN" MSG='Apply Destination Choice Model'
RUN PGM=MATRIX,99500 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN" MSG='Non-Work Trip Length Frequency'
RUN PGM=MATRIX,100974 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN" MSG='Non-Work Trip Time Frequency'
RUN PGM=MATRIX,102416 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN" MSG='District - to - District Flows'
  ENDLOOP
RUN PGM=MATRIX,103041 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\work_tlfd_msg.PRN" MSG='Work Trip Length Frequency'
RUN PGM=MATRIX,104502 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\work_ttfd_msg.PRN" MSG='Work Trip Time Frequency'
RUN PGM=MATRIX,105930 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\work_d2d_flows.PRN" MSG='HBW District - to - District Flows'
RUN PGM=MATRIX,106586 MSG='HBO + HBSH'
  LOOP PURPOSE = 1, 4, 1
IF (PURPOSE=1) ; HBW Purpose
PURP='HBW'
PURPNAME = 'HBW'
PURPNO=3
PRK='LONGPARK'
ELSEIF (PURPOSE=2) ; HBO Purpose
PURP='HBO'
PURPNAME = 'HBO_HBSH'
PURPNO=4
PRK='LONGPARK'
ELSEIF (PURPOSE=3) ; NHB Purpose
PURP='NHB'
PURPNAME='NHB'
PURPNO=5
PRK='LONGPARK'
ELSEIF (PURPOSE=4) ; SCH Purpose
PURP='HBSC'
PURPNAME='HBSC'
PURPNO=6
PRK='LONGPARK'
ENDIFPage 5  (VOYAGER PILOT) 
Parsons Brinckerhoff
------------------------
RUN PGM=MATRIX,107693
  ENDLOOP
  LOOP PER = 1, 4, 1
IF (PER=1) ; AM
PERIOD_COL=3
PERIOD_NAME = 'AM'
ELSEIF (PER=2) ; MD
PERIOD_COL=4
PERIOD_NAME = 'MD'
ELSEIF (PER=3) ; PM
PERIOD_COL=6
PERIOD_NAME = 'PM'
ELSEIF (PER=4) ; NT
PERIOD_COL=5
PERIOD_NAME = 'NT'
ENDIF
RUN PGM=MATRIX,110883 PRNFILE="C:\projects\Roanoke\Base\Output\Logs\TOD_Model_@PERIOD_NAME@.PRN" MSG='Convert PA Trips to OD Trips'
  ENDLOOP
RUN PGM=MATRIX,113070 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\MC_Transit_Trips.PRN" MSG='Transit Trips'
  LOOP PER = 1, 4, 1
IF (PER=1) ; AM
PERIOD_COL=3
PERIOD_NAME = 'AM'
ELSEIF (PER=2) ; MD
PERIOD_COL=4
PERIOD_NAME = 'MD'
ELSEIF (PER=3) ; PM
PERIOD_COL=5
PERIOD_NAME = 'PM'
ELSEIF (PER=4) ; NT
PERIOD_COL=6
PERIOD_NAME = 'NT'
ENDIF
RUN PGM=HIGHWAY,114462 PRNFILE="C:\projects\ROANOKE\CUBE\ASHWY00A.PRN" MSG='Preload External Trips'
RUN PGM=HIGHWAY,117024 PRNFILE="C:\projects\Roanoke\Base\Output\Logs\@PERIOD_NAME@.PRN" MSG='Load Final Trips onto Network'
  ENDLOOP
RUN PGM=NETWORK,120583 PRNFILE="C:\projects\Roanoke\Base\Output\Merge_Hwy_Assignments.PRN"
RUN PGM=NETWORK,124570 PRNFILE="C:\projects\Roanoke\Base\Output\Hwy_eval.PRN"
RUN PGM=HIGHWAY,144995 PRNFILE="C:\projects\Roanoke\Base\Output\Logs\PBHWY00B.PRN" MSG='Build PK congested skims'
RUN PGM=HIGHWAY,146823 PRNFILE="C:\projects\ROANOKE\CUBE\PBHWY00A.PRN" MSG='Build OP congested skims'
SYS=(COPY C:\projects\Roanoke\Base\Output\PK_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\PK_HWYSKIM_@Feedback_ITER@.MAT)
SYS=(COPY C:\projects\Roanoke\Base\Output\OP_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\OP_HWYSKIM_@Feedback_ITER@.MAT)
ENDLOOP
RUN PGM='PUBLIC TRANSPORT',149274 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\Trn_Assignment_PK.PRN" MSG='Transit Assignment'
RUN PGM='PUBLIC TRANSPORT',150407 PRNFILE="C:\projects\Roanoke\Base\OUTPUT\LOGS\Trn_Assignment_OP.PRN" MSG='Transit Assignment'
SYS=(COPY "C:\projects\Roanoke\CUBE\*.PRN" "C:\projects\Roanoke\Base\OUTPUT\LOGS\*.PRN")
SYS=(DEL "C:\projects\Roanoke\CUBE\*.PRN")

PILOT Stack Size = 18228 bytes.
................................................................................


--------------------------------------------------------------------------------Page 6  (VOYAGER PILOT) 
Parsons Brinckerhoff
------------------------

SYS "del C:\projects\Roanoke\CUBE\*.prn"
C:\projects\Roanoke\CUBE\Roanoke Area MPO Model_0000.PRN

SYS ReturnCode = 0

--------------------------------------------------------------------------------

--------------------------------------------------------------------------------

SYS "del C:\projects\Roanoke\CUBE\*.bak"

SYS ReturnCode = 0

--------------------------------------------------------------------------------

--------------------------------------------------------------------------------

SYS "del C:\projects\Roanoke\CUBE\*.0??"

SYS ReturnCode = 0

--------------------------------------------------------------------------------

--------------------------------------------------------------------------------

SYS "del C:\projects\Roanoke\CUBE\trc*.s"

SYS ReturnCode = 0

--------------------------------------------------------------------------------

--------------------------------------------------------------------------------

SYS "IF NOT EXIST "C:\projects\Roanoke\Base\Output" MKDIR "C:\projects\Roanoke\Base\Output""

SYS ReturnCode = 0

--------------------------------------------------------------------------------

--------------------------------------------------------------------------------

SYS "IF NOT EXIST "C:\projects\Roanoke\Base\OUTPUT" MKDIR "C:\projects\Roanoke\Base\OUTPUT""
Page 7  (VOYAGER PILOT) 
Parsons Brinckerhoff
------------------------
SYS ReturnCode = 0

--------------------------------------------------------------------------------

--------------------------------------------------------------------------------

SYS "IF NOT EXIST "C:\projects\Roanoke\Base\OUTPUT\LOGS" MKDIR "C:\projects\Roanoke\Base\OUTPUT\LOGS""

SYS ReturnCode = 0

--------------------------------------------------------------------------------

M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\AT_1.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:01 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\AT_2.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:01 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\AT_3.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:02 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\AT_4.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:02 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\AT-5.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:02 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\AT_6.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:02 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\AT_7.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:02 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


--------------------------------------------------------------------------------

SYS "C:\projects\Roanoke\CUBE\LINK_CALC.BAT"

C:\PROJECTS\ROANOKE\CUBE>C:\projects\Roanoke\R\R-3.2.2\bin\Rscript.exe C:\projects\Roanoke\R\calculate_capacities.R C:\projects\Roanoke\Base\Output\link_atype2012A.DBF C:\projects\Roanoke\Base\Output\link_capacities2012A.DBF 

SYS ReturnCode = 0

--------------------------------------------------------------------------------Page 24  (VOYAGER NETWORK) 
Parsons Brinckerhoff
---------------------------
NETWORK (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:43 2016

FILEO NETO = "C:\projects\Roanoke\Base\Output\RVTPOBase2012A.NET"
FILEI LINKI[2] = "C:\projects\Roanoke\Base\Output\link_capacities2012A.DBF"
FILEI LINKI[1] = "C:\projects\Roanoke\Base\Output\ATYPE NETWORK2012A.NET"

PROCESS  PHASE=INPUT
;Use this phase to modify data as it is read, such as recoding node numbers.


ENDPROCESS


PROCESS  PHASE=NODEMERGE
; Use this phase to make computations and selections of any data on the NODEI files.


ENDPROCESS


PROCESS  PHASE=LINKMERGE
; Use this phase to make computations and selections of any data on the LINKI files.
CAPE_AM = LI.2.CAPE * 2.79 ; 2.5  ; AM Capacity
CAPE_MD = LI.2.CAPE * 4.40 ; 5.5  ; MD Capacity
CAPE_PM = LI.2.CAPE * 3.18 ; 2.5  ; PM Capacity
CAPE_NT = LI.2.CAPE * 5.63 ; 4.5  ; NT Capacity
POST_SPEED = LI.1.POST_SPD



; Arterials
IF (LI.1.FACTYPE > 2 & LI.1.FACTYPE < 5 & LI.1.POST_SPD > 25 )
     FFSPEED = LI.1.POST_SPD - 5
ENDIF

; Local and collector
IF (LI.1.FACTYPE > 6 & LI.1.FACTYPE < 9 & LI.1.POST_SPD <> 0)
     FFSPEED = LI.1.POST_SPD + 3
ENDIF



ENDPROCESS


PROCESS  PHASE=SUMMARY
; Use this phase for combining and reporting of working variables.


ENDPROCESS


NETWORK Stack Size = 1302 bytes.Page 25  (VOYAGER NETWORK) 
Parsons Brinckerhoff
---------------------------
................................................................................




C:\projects\Roanoke\Base\Output\ATYPE NETWORK2012A.NET   (VOYAGER):

NET PGM=NETWORK (v.08/05/2014 [6.1.1]) DATE=Tue Mar 29 14:11:02 2016
ID= 
PAR Zones=267 Nodes=5716 Links=9078 NodeRecs=4643 
NVR 25    N    Z    DISTRICT    COUNTY    ACRES    POP    HH    WORK    VEH
    EMP    EMP_NOSG    SCHOOL    IND    RET    HTRET    OFF    SER    SG_RET
    SG_HOS    SG_AIR    SG_COL    SG_NAME=053    ID    X    Y
LVR 21    A    B    ID    LENGTH    DIR    DISTANCE    FACTYPE    LANES
    POST_SPD    RTE_NAME=029    AAWDT    TMS_ID=020    SCREENLN    TUNNEL=001
    BRIDGE=001    TRK_PHB=001    PED_PHB=001    TRAFF_PHB=001    ZN    DIST_XY
    ATYPE


C:\projects\Roanoke\Base\Output\link_capacities2012A.DBF (DBF):
A          B          FFSPEED    CAPD       CAPE       


Begin PROCESS PHASE INPUT
     9078 records read from LINKI[2]: C:\projects\Roanoke\Base\Output\link_capacities2012A.DBF
End   PROCESS PHASE INPUT


Begin PROCESS PHASE NODEMERGE
       4,643 records merged from NODEI[1]: C:\projects\Roanoke\Base\Output\ATYPE NETWORK2012A.NET
       4,643 data base records.Page 26  (VOYAGER NETWORK) 
Parsons Brinckerhoff
---------------------------

Variable  Obs<>0          Total        Ave        Min        Max        RMS  
--------  ------          -----        ---        ---        ---        ---  
N          4,643             --         --       1      5,716            --
Z            205      21,125        103.05       1        206        118.87
DISTRICT     205       1,333          6.5        1         12          7.41
COUNTY       205  10,556,836     51,496.76  51,019     51,775     51,497.75
ACRES        205     158,960.21     775.42      64.05   6,223.82   1,249.34
POP          201     257,292      1,280.06      22      5,661      1,585.46
HH           201     113,015        562.26      10      2,588        709.83
WORK         201     126,846        631.07      12      2,929        805.93
VEH          201     199,984        994.95      15      3,998      1,260.71
EMP          205     131,629        642.09       1      3,976        959.49
EMP_NOSG     205     124,206        605.88       1      3,441        883.78
SCHOOL        50      35,388        707.76      50      2,581        883.56
IND          181      21,155        116.88       1      1,937        254.16
RET          181      21,169        116.96       1        878        186.72
HTRET        146      10,568         72.38       1        401        112.9 
OFF          192      23,117        120.4        1      1,635        259.29
SER          204      48,197        236.26       1      1,450        377.54
SG_RET         2       2,711      1,355.5      308      2,403      1,713.08
SG_HOS         3       3,059      1,019.67     455      1,419      1,099.21
SG_AIR         1         535        535        535        535        535   
SG_COL         3       1,118        372.67     322        450        376.78
SG_NAME        9                            (Hollins )  (Virginia)
ID           204      20,910        102.5        1        204        118.21
X          4,643    -371,270.36     -79.96     -80.28     -79.78      79.96
Y          4,643     173,146.2       37.29      37.13      37.5       37.29

_Variables with values:

_ZONES              267      

End   PROCESS PHASE NODEMERGE


Begin PROCESS PHASE LINKMERGE
       9,078 records merged from NETI[1]: C:\projects\Roanoke\Base\Output\ATYPE NETWORK2012A.NET
       9,078 records merged from NETI[2]: L2.111672
       9,078 data base records.Page 27  (VOYAGER NETWORK) 
Parsons Brinckerhoff
---------------------------

Variable    Obs<>0           Total        Ave       Min         Max        RMS  
--------    ------           -----        ---       ---         ---        ---  
A            9,078              --         --      1       5,716            --
B            9,078              --         --      1       5,716            --
FFSPEED      9,078      321,595         35.43     18          74         37.18
CAPD         9,078   22,509,973      2,479.62    600     100,000      6,850.16
CAPE         9,078   23,401,853      2,577.86    700     100,000      6,880.53
ID           9,076   41,164,549      4,535.54      1       9,067      5,236.63
LENGTH       9,076        1,217.19       0.13      0.01        3.27       0.23
DISTANCE     8,327        1,003.9        0.12      0.01        3.49       0.22
FACTYPE      9,078       53,103          5.85      1          12          6.27
LANES        8,328       11,183          1.34      1           3          1.44
POST_SPD     8,328      277,540         33.33      5          70         35.16
RTE_NAME     7,344                             (        )  (Kermit/T)
AAWDT          505    4,022,329      7,965.01    109      43,583     10,860.89
TMS_ID       9,072                             (        )  (  686146)
SCREENLN       118          308          2.61      1           4          2.91
TUNNEL       8,322                             (N       )  (Y       )
BRIDGE       8,322                             (N       )  (N       )
TRK_PHB      8,322                             (N       )  (Y       )
PED_PHB      8,322                             (N       )  (Y       )
TRAFF_PHB    8,322                             (Y       )  (Y       )
ZN           9,078      904,427         99.63      1         267        118.34
ATYPE        9,078       35,033          3.86      2           5          3.95
CAPE_AM      9,078   65,291,169.87   7,192.24  1,953     279,000     19,196.67
CAPE_MD      9,078  102,968,153.2   11,342.6   3,080     440,000     30,274.32
CAPE_PM      9,078   74,417,892.54   8,197.61  2,226     318,000     21,880.08
CAPE_NT      9,078  131,752,432.39  14,513.38  3,941     563,000     38,737.37
POST_SPEED   8,328      277,540         33.33      5          70         35.16

      Obs = 0:  DIR  DIST_XY

_Variables with values:

_ZONES              267      

End   PROCESS PHASE LINKMERGE

M(664): Unconnected Zones:  196<->  207-249<->  255-256<->


Begin PROCESS PHASE SUMMARY

_Variables with values:

_ZONES              267      

End   PROCESS PHASE SUMMARYPage 28  (VOYAGER NETWORK) 
Parsons Brinckerhoff
---------------------------

FILEO NETO=C:\projects\Roanoke\Base\Output\RVTPOBase2012A.NET

NET PGM=NETWORK (v.08/05/2014 [6.1.1]) DATE=Tue Mar 29 14:11:43 2016
ID= 
PAR Zones=267 Nodes=5716 Links=9078 NodeRecs=4643 
NVR 25    N    Z    DISTRICT    COUNTY    ACRES    POP    HH    WORK    VEH
    EMP    EMP_NOSG    SCHOOL    IND    RET    HTRET    OFF    SER    SG_RET
    SG_HOS    SG_AIR    SG_COL    SG_NAME=053    ID    X    Y
LVR 29    A    B    FFSPEED    CAPD    CAPE    ID    LENGTH    DIR
    DISTANCE    FACTYPE    LANES    POST_SPD    RTE_NAME=029    AAWDT
    TMS_ID=020    SCREENLN    TUNNEL=001    BRIDGE=001    TRK_PHB=001
    PED_PHB=001    TRAFF_PHB=001    ZN    DIST_XY    ATYPE    CAPE_AM
    CAPE_MD    CAPE_PM    CAPE_NT    POST_SPEED


NETWORK  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\FreeFlowSpeeds.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:44 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\Output\IMPED11.MAT C:\projects\Roanoke\Base\OUTPUT\PK_FreeFlow_Skim.MAT
M(100): COPY C:\projects\Roanoke\Base\Output\IMPED11.MAT C:\projects\Roanoke\Base\OUTPUT\OP_FreeFlow_Skim.MAT

--------------------------------------------------------------------------------

SYS "C:\projects\Roanoke\CUBE\CLASSIFICATION.BAT"

C:\PROJECTS\ROANOKE\CUBE>C:\projects\Roanoke\R\R-3.2.2\bin\Rscript.exe C:\projects\Roanoke\R\classification.R C:\projects\Roanoke\Base\Input\se.dbf C:\projects\Roanoke\Params\classification C:\projects\Roanoke\Base\Output\se_classified_2012A.dbf 

SYS ReturnCode = 0

--------------------------------------------------------------------------------Page 31  (VOYAGER GENERATION) 
Parsons Brinckerhoff
------------------------------
GENERATION (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:47 2016

FILEO PRINTO[1] = "C:\projects\Roanoke\Base\Output\hbw.csv"
FILEI LOOKUPI[6] = "C:\projects\Roanoke\PARAMS\TRIP_PROD\NHBO.DBF"
FILEI LOOKUPI[5] = "C:\projects\Roanoke\PARAMS\TRIP_PROD\HBSHOP.DBF"
FILEI LOOKUPI[4] = "C:\projects\Roanoke\PARAMS\TRIP_PROD\HBSCHOOL.DBF"
FILEI LOOKUPI[3] = "C:\projects\Roanoke\PARAMS\TRIP_PROD\HBO.DBF"
FILEI LOOKUPI[2] = "C:\projects\Roanoke\PARAMS\TRIP_PROD\NHBW.DBF"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\TRIP_PROD\HBW.DBF"
FILEO PAO[1] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF",
  FORM=10.3, LIST = Z, P[1], P[2], P[3], P[4], P[5], P[6], DBF=T,
  NAMES = TAZ, HBWP, NHBWP, HBOP, HBSCP, HBSHP, NHBOP
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Output\se_classified_2012A.dbf"

ZONES = 267

LOOKUP LOOKUPI=1, NAME=hbw_lu,
  LOOKUP[1]=index, RESULT=vehicle0,
  LOOKUP[2]=index, RESULT=vehicle1,
  LOOKUP[3]=index, RESULT=vehicle2,
  LOOKUP[4]=index, RESULT=vehicle3,
  FAIL[3]=0

LOOKUP LOOKUPI=2, NAME=nhbw_lu,
  LOOKUP[1]=index, RESULT=vehicle0,
  LOOKUP[2]=index, RESULT=vehicle1,
  LOOKUP[3]=index, RESULT=vehicle2,
  LOOKUP[4]=index, RESULT=vehicle3,
  FAIL[3]=0

LOOKUP LOOKUPI=3, NAME=hbo_lu,
  LOOKUP[1]=index, RESULT=vehicle0,
  LOOKUP[2]=index, RESULT=vehicle1,
  LOOKUP[3]=index, RESULT=vehicle2,
  LOOKUP[4]=index, RESULT=vehicle3,
  FAIL[3]=0

LOOKUP LOOKUPI=4, NAME=hbschool_lu,
  LOOKUP[1]=index, RESULT=vehicle0,
  LOOKUP[2]=index, RESULT=vehicle1,
  LOOKUP[3]=index, RESULT=vehicle2,
  LOOKUP[4]=index, RESULT=vehicle3,
  FAIL[3]=0

LOOKUP LOOKUPI=5, NAME=hbshop_lu,
  LOOKUP[1]=index, RESULT=vehicle0,
  LOOKUP[2]=index, RESULT=vehicle1,
  LOOKUP[3]=index, RESULT=vehicle2,
  LOOKUP[4]=index, RESULT=vehicle3,
  FAIL[3]=0

LOOKUP LOOKUPI=6, NAME=nhbo_lu,
  LOOKUP[1]=index, RESULT=vehicle0,
  LOOKUP[2]=index, RESULT=vehicle1,Page 32  (VOYAGER GENERATION) 
Parsons Brinckerhoff
------------------------------
  LOOKUP[3]=index, RESULT=vehicle2,
  LOOKUP[4]=index, RESULT=vehicle3,
  FAIL[3]=0


PROCESS PHASE=ILOOP
; This phase performs a zonal loop (I=1,Zones).  This phase is used to compute productions (P[#]=) and
; attractions (A[#]=) by zone.  Up to 20 P's and 20 A's can be computed in a single run.


  ;# Home-based work productions
  P[1] = 0 +
    zi.1.w0v0 * hbw_lu(1, 1) + zi.1.w0v1 * hbw_lu(2, 1) + zi.1.w0v2 * hbw_lu(3, 1) + zi.1.w0v3 * hbw_lu(4, 1) +
    zi.1.w1v0 * hbw_lu(1, 2) + zi.1.w1v1 * hbw_lu(2, 2) + zi.1.w1v2 * hbw_lu(3, 2) + zi.1.w1v3 * hbw_lu(4, 2) +
    zi.1.w2v0 * hbw_lu(1, 3) + zi.1.w2v1 * hbw_lu(2, 3) + zi.1.w2v2 * hbw_lu(3, 3) + zi.1.w2v3 * hbw_lu(4, 3) +
    zi.1.w3v0 * hbw_lu(1, 4) + zi.1.w3v1 * hbw_lu(2, 4) + zi.1.w3v2 * hbw_lu(3, 4) + zi.1.w3v3 * hbw_lu(4, 4)

  ;# Non home-based work productions
  P[2] = 0 +
    zi.1.w0v0 * nhbw_lu(1, 1) + zi.1.w0v1 * nhbw_lu(2, 1) + zi.1.w0v2 * nhbw_lu(3, 1) + zi.1.w0v3 * nhbw_lu(4, 1) +
    zi.1.w1v0 * nhbw_lu(1, 2) + zi.1.w1v1 * nhbw_lu(2, 2) + zi.1.w1v2 * nhbw_lu(3, 2) + zi.1.w1v3 * nhbw_lu(4, 2) +
    zi.1.w2v0 * nhbw_lu(1, 3) + zi.1.w2v1 * nhbw_lu(2, 3) + zi.1.w2v2 * nhbw_lu(3, 3) + zi.1.w2v3 * nhbw_lu(4, 3) +
    zi.1.w3v0 * nhbw_lu(1, 4) + zi.1.w3v1 * nhbw_lu(2, 4) + zi.1.w3v2 * nhbw_lu(3, 4) + zi.1.w3v3 * nhbw_lu(4, 4)

  ;# Home-based other productions
  P[3] =
    zi.1.p1v0 * hbo_lu(1, 1) + zi.1.p1v1 * hbo_lu(2, 1) + zi.1.p1v2 * hbo_lu(3, 1) + zi.1.p1v3 * hbo_lu(4, 1) +
    zi.1.p2v0 * hbo_lu(1, 2) + zi.1.p2v1 * hbo_lu(2, 2) + zi.1.p2v2 * hbo_lu(3, 2) + zi.1.p2v3 * hbo_lu(4, 2) +
    zi.1.p3v0 * hbo_lu(1, 3) + zi.1.p3v1 * hbo_lu(2, 3) + zi.1.p3v2 * hbo_lu(3, 3) + zi.1.p3v3 * hbo_lu(4, 3) +
    zi.1.p4v0 * hbo_lu(1, 4) + zi.1.p4v1 * hbo_lu(2, 4) + zi.1.p4v2 * hbo_lu(3, 4) + zi.1.p4v3 * hbo_lu(4, 4)


  ;# Home-based school productions
  P[4] = 0 +
    zi.1.p1v0 * hbschool_lu(1, 1) + zi.1.p1v1 * hbschool_lu(2, 1) + zi.1.p1v2 * hbschool_lu(3, 1) + zi.1.p1v3 * hbschool_lu(4, 1) +
    zi.1.p2v0 * hbschool_lu(1, 2) + zi.1.p2v1 * hbschool_lu(2, 2) + zi.1.p2v2 * hbschool_lu(3, 2) + zi.1.p2v3 * hbschool_lu(4, 2) +
    zi.1.p3v0 * hbschool_lu(1, 3) + zi.1.p3v1 * hbschool_lu(2, 3) + zi.1.p3v2 * hbschool_lu(3, 3) + zi.1.p3v3 * hbschool_lu(4, 3) +
    zi.1.p4v0 * hbschool_lu(1, 4) + zi.1.p4v1 * hbschool_lu(2, 4) + zi.1.p4v2 * hbschool_lu(3, 4) + zi.1.p4v3 * hbschool_lu(4, 4)


  ;# Home-based shop productions
  P[5] = 0 +
    zi.1.p1v0 * hbshop_lu(1, 1) + zi.1.p1v1 * hbshop_lu(2, 1) + zi.1.p1v2 * hbshop_lu(3, 1) + zi.1.p1v3 * hbshop_lu(4, 1) +
    zi.1.p2v0 * hbshop_lu(1, 2) + zi.1.p2v1 * hbshop_lu(2, 2) + zi.1.p2v2 * hbshop_lu(3, 2) + zi.1.p2v3 * hbshop_lu(4, 2) +
    zi.1.p3v0 * hbshop_lu(1, 3) + zi.1.p3v1 * hbshop_lu(2, 3) + zi.1.p3v2 * hbshop_lu(3, 3) + zi.1.p3v3 * hbshop_lu(4, 3) +
    zi.1.p4v0 * hbshop_lu(1, 4) + zi.1.p4v1 * hbshop_lu(2, 4) + zi.1.p4v2 * hbshop_lu(3, 4) + zi.1.p4v3 * hbshop_lu(4, 4)

  ;# non-Home-based other productions
  P[6] = 0 +
    zi.1.p1v0 * nhbo_lu(1, 1) + zi.1.p1v1 * nhbo_lu(2, 1) + zi.1.p1v2 * nhbo_lu(3, 1) + zi.1.p1v3 * nhbo_lu(4, 1) +
    zi.1.p2v0 * nhbo_lu(1, 2) + zi.1.p2v1 * nhbo_lu(2, 2) + zi.1.p2v2 * nhbo_lu(3, 2) + zi.1.p2v3 * nhbo_lu(4, 2) +
    zi.1.p3v0 * nhbo_lu(1, 3) + zi.1.p3v1 * nhbo_lu(2, 3) + zi.1.p3v2 * nhbo_lu(3, 3) + zi.1.p3v3 * nhbo_lu(4, 3) +
    zi.1.p4v0 * nhbo_lu(1, 4) + zi.1.p4v1 * nhbo_lu(2, 4) + zi.1.p4v2 * nhbo_lu(3, 4) + zi.1.p4v3 * nhbo_lu(4, 4)
Page 33  (VOYAGER GENERATION) 
Parsons Brinckerhoff
------------------------------
  p1v0 = zi.1.p1v0 * nhbo_lu(1, 1)
  p1v1 = zi.1.p1v1 * nhbo_lu(2, 1)
  p1v2 = zi.1.p1v2 * nhbo_lu(3, 1)
  p1v3 = zi.1.p1v3 * nhbo_lu(4, 1)
  p2v0 = zi.1.p2v0 * nhbo_lu(1, 2)
  p2v1 = zi.1.p2v1 * nhbo_lu(2, 2)
  p2v2 = zi.1.p2v2 * nhbo_lu(3, 2)
  p2v3 = zi.1.p2v3 * nhbo_lu(4, 2)
  p3v0 = zi.1.p3v0 * nhbo_lu(1, 3)
  p3v1 = zi.1.p3v1 * nhbo_lu(2, 3)
  p3v2 = zi.1.p3v2 * nhbo_lu(3, 3)
  p3v3 = zi.1.p3v3 * nhbo_lu(4, 3)
  p4v0 = zi.1.p4v0 * nhbo_lu(1, 4)
  p4v1 = zi.1.p4v1 * nhbo_lu(2, 4)
  p4v2 = zi.1.p4v2 * nhbo_lu(3, 4)
  p4v3 = zi.1.p4v3 * nhbo_lu(4, 4)
  all =
    p1v0 + p1v1 + p1v2 + p1v3 +
    p2v0 + p2v1 + p2v2 + p2v3 +
    p3v0 + p3v1 + p3v2 + p3v3 +
    p4v0 + p4v1 + p4v2 + p4v3


PRINT FORM = 10.10, CSV = T, LIST = Z, P[6], p1v0, p1v1, p1v2, p1v3, p2v0,
  p2v1, p2v2, p2v3, p3v0, p3v1, p3v2, p3v3, p4v0, p4v1, p4v2, p4v3, all,
  PRINTO = 1


ENDPROCESS


PROCESS PHASE=ADJUST



ENDPROCESS


GENERATION Stack Size = 6922 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Output\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        Page 34  (VOYAGER GENERATION) 
Parsons Brinckerhoff
------------------------------

LOOKUP #1: hbw_lu C:\projects\Roanoke\PARAMS\TRIP_PROD\HBW.DBF:
index       N5      workers     C8      vehicle0    N19.15  vehicle1    N19.15 
vehicle2    N19.15  vehicle3    N19.15 

LOOKUP #2: nhbw_lu C:\projects\Roanoke\PARAMS\TRIP_PROD\NHBW.DBF:
index       N5      workers     C8      vehicle0    N19.15  vehicle1    N19.15 
vehicle2    N19.15  vehicle3    N19.15 

LOOKUP #3: hbo_lu C:\projects\Roanoke\PARAMS\TRIP_PROD\HBO.DBF:
index       N5      size        C8      vehicle0    N19.15  vehicle1    N19.15 
vehicle2    N19.15  vehicle3    N19.15 

LOOKUP #4: hbschool_lu C:\projects\Roanoke\PARAMS\TRIP_PROD\HBSCHOOL.DBF:
index       N5      size        C8      vehicle0    N19.15  vehicle1    N19.15 
vehicle2    N19.15  vehicle3    N19.15 

LOOKUP #5: hbshop_lu C:\projects\Roanoke\PARAMS\TRIP_PROD\HBSHOP.DBF:
index       N5      size        C8      vehicle0    N19.15  vehicle1    N19.15 
vehicle2    N19.15  vehicle3    N19.15 

LOOKUP #6: nhbo_lu C:\projects\Roanoke\PARAMS\TRIP_PROD\NHBO.DBF:
index       N5      size        C8      vehicle0    N19.15  vehicle1    N19.15 
vehicle2    N19.15  vehicle3    N19.15 


Total P/A  1  117,678       --
Total P/A  2   62,525       --
Total P/A  3  264,074       --
Total P/A  4   45,117       --
Total P/A  5  136,095       --
Total P/A  6  222,309       --

PHASE=ADJUST:

Total P/A  1  117,678       --
Total P/A  2   62,525       --
Total P/A  3  264,074       --
Total P/A  4   45,117       --
Total P/A  5  136,095       --
Total P/A  6  222,309       --

File C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF opened

GENERATION ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\TransitSpeeds.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:47 2016
NETWORK  ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\BuildWalkAccessConenctors.PRN. 
PUBLIC TRANSPORT (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:48 2016
PUBLIC TRANSPORT ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\WalkAccess_ByMode.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:50 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\Trn_PK_Skims.PRN. 
PUBLIC TRANSPORT (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:51 2016
PUBLIC TRANSPORT ReturnCode = 1  Elapsed Time = 00:00:02
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\Trn_OP_Skims.PRN. 
PUBLIC TRANSPORT (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:53 2016
PUBLIC TRANSPORT ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 510  (VOYAGER FRATAR) 
Parsons Brinckerhoff
---------------------------
FRATAR (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:54 2016

FILEI MATI[1] = "C:\projects\Roanoke\Base\INPUT\EE_seed.MAT"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\Base\INPUT\EXTERNALTRIPS.DBF"
FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\EE_2012.MAT",
 MO=1,NAME = EE_TRIPS, DEC=1*D

PARAMETERS MAXRMSE=0.0001 MAXITERS=25
; USE A LOOKUP FILE TO find appropriate factors (1.0 is assumed unless expressly provided)
LOOKUP LOOKUPI=1, LIST=Y,
  NAME=GROWTHF,
  LOOKUP[1]=ZONE,RESULT=AADT_FAC,
  LOOKUP[2]=ZONE,RESULT=AADT_FAC,
  FAIL[1]=1,FAIL[2]=1,FAIL[3]=1

SETPA PGF[1]=GROWTHF(1,I) AGF[1]=GROWTHF(2,I) MW[1]=MI.1.1


FRATAR Stack Size = 602 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\INPUT\EE_seed.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Fri Mar 11 11:08:13 2016 
ID=Model Run
PAR Zones=267 M=1
  EE_Trips
LOOKUP #1: GROWTHF C:\projects\Roanoke\Base\INPUT\EXTERNALTRIPS.DBF:
ZONE        N6      EXTTOTAL    N15.2   EE          N8.2    IEEI        N8.2   
AADT_FAC    N8.2   


LOOKUP   GROWTHF:  FAIL=  1  1  1
         GROWTHF(1,250)  = 1
         GROWTHF(1,251)  = 1
         GROWTHF(1,252)  = 1
         GROWTHF(1,253)  = 1
         GROWTHF(1,254)  = 1
         GROWTHF(1,257)  = 1
         GROWTHF(1,258)  = 1
         GROWTHF(1,259)  = 1
         GROWTHF(1,260)  = 1
         GROWTHF(1,261)  = 1
         GROWTHF(1,262)  = 1
         GROWTHF(1,263)  = 1
         GROWTHF(1,264)  = 1
         GROWTHF(1,265)  = 1
         GROWTHF(1,266)  = 1
         GROWTHF(1,267)  = 1
         GROWTHF(2,250)  = 1
         GROWTHF(2,251)  = 1
         GROWTHF(2,252)  = 1
         GROWTHF(2,253)  = 1
         GROWTHF(2,254)  = 1Page 511  (VOYAGER FRATAR) 
Parsons Brinckerhoff
---------------------------
         GROWTHF(2,257)  = 1
         GROWTHF(2,258)  = 1
         GROWTHF(2,259)  = 1
         GROWTHF(2,260)  = 1
         GROWTHF(2,261)  = 1
         GROWTHF(2,262)  = 1
         GROWTHF(2,263)  = 1
         GROWTHF(2,264)  = 1
         GROWTHF(2,265)  = 1
         GROWTHF(2,266)  = 1
         GROWTHF(2,267)  = 1


W(678): SETPA CONTROL[1]= specified 0 times.

FRATAR:

     MW[1]  =  41,787           Input Total
     P/A[1] =  41,787   41,787  Total
     MW[1]  =  41,787           Final Target

RMSE  MW= 1
-----------
 1     0.00

Totals after Iteration 1 I loop:

	MI.01.001: 41,787
	MW[1]    : 41,787
	MO.01.001: 41,787

FRATAR   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 512  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:54 2016

FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\EXTERNALTRIPS.DBF",
fields=ZONE,AADT,EE_Total,IEEI
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\EXTERNALTRIPS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\EE_2012.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t

IF ( I >= 250)
  RO.PROD1=ROWSUM(1)
  RO.ATTR1=ROWSUM(2)
  RO.ZONE=I
  RO.EE_Total = RO.PROD1 + RO.ATTR1
  RO.AADT = ZI.1.EXTTOTAL * ZI.1.AADT_FAC
  RO.IEEI = RO.AADT - RO.EE_Total

WRITE RECO=1
ENDIF


MATRIX Stack Size = 846 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\EXTERNALTRIPS.DBF Opened: 16 data records  5 Fields:
ZONE(N)         EXTTOTAL(N)     EE(N)           IEEI(N)         AADT_FAC(N)    


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\EE_2012.MAT Opened
MAT PGM=FRATAR (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:54 2016 
ID=
PAR Zones=267 M=1
  EE_TRIPS

W(754): Following RO.vars not in any RECO:
   PROD1        ATTR1      

Totals from Transpose:

	MI.01.001.T: 41,787

M(660): Transpose Disk Usage (bytes): Data=4,233, Index=1,068.Page 513  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  : 41,787
	MI.01.001.T: 41,787
	MW[1]      : 41,787
	MW[2]      : 41,787

M(751): 18 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\EXTERNALTRIPS.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 514  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:54 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\Output\IMPED11.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1318 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\Output\IMPED11.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Tue Mar 29 14:11:44 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 515  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,627,483.52   @J=I:     23,000,116.87
	MI.01.002: 22,402,469,244.49
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,837,101.52   @J=I:     23,000,794.87
	MW[1]    : 22,425,627,483.52   @J=I:     23,000,116.87
	MW[2]    : 22,402,469,244.49
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,837,101.52   @J=I:     23,000,794.87
	MW[11]   :        627,483.52   @J=I:            116.87
	MW[12]   :        469,244.49
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        772,901.52   @J=I:            784.87
	MO.01.001:        627,483.52
	MO.01.002:        469,244.49
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        772,901.52

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 516  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------
GENERATION (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:54 2016

FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\EXTERNALTRIPS.DBF"
FILEO PAO[1] = "C:\projects\Roanoke\Base\Output\IEEI_PA_2012.DBF",
FORM=10.3, DBF=T, LIST=Z, P[1], A[1]
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\se.dbf"

ZONES=267

PHASE=ILOOP
  CoeffHH     = 0.423546369 * 2
  CoeffIND    = 0.235065256 * 2
  CoeffSER    = 0.158333776 * 2
  CoeffOFFHTR = 0.148286574 * 2
  CoeffRET    = 0.208675310 * 2
  CoeffSG     = 0.225389103 * 2
       ; adjustent factor reflects change required to make estimated trip generation rates match observed trips

GrwthRate=1.0        ; for future year models, replace this 1.0 with the assumed growth rate

  IF (I<=206)
    TOTALSG = ZI.1.SG_RET + ZI.1.SG_HOS + ZI.1.SG_AIR + ZI.1.SG_COL
    OFFHTRET = ZI.1.OFF + ZI.1.HTRET
    A[1]=(ZI.1.HH * CoeffHH) + (ZI.1.IND * CoeffIND) + (ZI.1.RET * CoeffRET) +
       (OFFHTRET * CoeffOFFHTR) + (ZI.1.SER * CoeffSER) + (TOTALSG * CoeffSG)
    P[1]= 0
  ELSE
    A[1]=0
    P[1]= ZI.2.IEEI
  ENDIF
  ENDPHASE

PHASE=ADJUST
  BALANCE A2P=1

REPORT A=Y P=Y
ENDPHASE



GENERATION Stack Size = 1438 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\EXTERNALTRIPS.DBF Opened: 18 data records  4 Fields:
ZONE(N)         AADT(N)         EE_TOTAL(N)     IEEI(N)        


FILEI ZDATI=C:\projects\Roanoke\Base\Input\se.dbf Opened: 205 data records  23 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)           Page 517  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------


Variable Values at end of Iteration 1 I loop:

    COEFFHH    :  0.84709
    COEFFIND   :  0.47013
    COEFFSER   :  0.31667
    COEFFOFFHTR:  0.29657
    COEFFRET   :  0.41735
    COEFFSG    :  0.45078
    GRWTHRATE  :  1      
    OFFHTRET   : 15      

Total P/A  1  100,844  143,113

PHASE=ADJUST:Page 518  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT P
Zone           0          1
---------------------------
   0  100,843.68 100,843.68
   1          --         --
   2          --         --
   3          --         --
   4          --         --
   5          --         --
   6          --         --
   7          --         --
   8          --         --
   9          --         --
  10          --         --
  11          --         --
  12          --         --
  13          --         --
  14          --         --
  15          --         --
  16          --         --
  17          --         --
  18          --         --
  19          --         --
  20          --         --
  21          --         --
  22          --         --
  23          --         --
  24          --         --
  25          --         --
  26          --         --
  27          --         --
  28          --         --
  29          --         --
  30          --         --
  31          --         --
  32          --         --
  33          --         --
  34          --         --
  35          --         --
  36          --         --
  37          --         --
  38          --         --
  39          --         --
  40          --         --
  41          --         --
  42          --         --
  43          --         --
  44          --         --
  45          --         --
  46          --         --
  47          --         --
  48          --         --Page 519  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT P
Zone           0          1
---------------------------
  49          --         --
  50          --         --
  51          --         --
  52          --         --
  53          --         --
  54          --         --
  55          --         --
  56          --         --
  57          --         --
  58          --         --
  59          --         --
  60          --         --
  61          --         --
  62          --         --
  63          --         --
  64          --         --
  65          --         --
  66          --         --
  67          --         --
  68          --         --
  69          --         --
  70          --         --
  71          --         --
  72          --         --
  73          --         --
  74          --         --
  75          --         --
  76          --         --
  77          --         --
  78          --         --
  79          --         --
  80          --         --
  81          --         --
  82          --         --
  83          --         --
  84          --         --
  85          --         --
  86          --         --
  87          --         --
  88          --         --
  89          --         --
  90          --         --
  91          --         --
  92          --         --
  93          --         --
  94          --         --
  95          --         --
  96          --         --
  97          --         --Page 520  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT P
Zone           0          1
---------------------------
  98          --         --
  99          --         --
 100          --         --
 101          --         --
 102          --         --
 103          --         --
 104          --         --
 105          --         --
 106          --         --
 107          --         --
 108          --         --
 109          --         --
 110          --         --
 111          --         --
 112          --         --
 113          --         --
 114          --         --
 115          --         --
 116          --         --
 117          --         --
 118          --         --
 119          --         --
 120          --         --
 121          --         --
 122          --         --
 123          --         --
 124          --         --
 125          --         --
 126          --         --
 127          --         --
 128          --         --
 129          --         --
 130          --         --
 131          --         --
 132          --         --
 133          --         --
 134          --         --
 135          --         --
 136          --         --
 137          --         --
 138          --         --
 139          --         --
 140          --         --
 141          --         --
 142          --         --
 143          --         --
 144          --         --
 145          --         --
 146          --         --Page 521  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT P
Zone           0          1
---------------------------
 147          --         --
 148          --         --
 149          --         --
 150          --         --
 151          --         --
 152          --         --
 153          --         --
 154          --         --
 155          --         --
 156          --         --
 157          --         --
 158          --         --
 159          --         --
 160          --         --
 161          --         --
 162          --         --
 163          --         --
 164          --         --
 165          --         --
 166          --         --
 167          --         --
 168          --         --
 169          --         --
 170          --         --
 171          --         --
 172          --         --
 173          --         --
 174          --         --
 175          --         --
 176          --         --
 177          --         --
 178          --         --
 179          --         --
 180          --         --
 181          --         --
 182          --         --
 183          --         --
 184          --         --
 185          --         --
 186          --         --
 187          --         --
 188          --         --
 189          --         --
 190          --         --
 191          --         --
 192          --         --
 193          --         --
 194          --         --
 195          --         --Page 522  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT P
Zone           0          1
---------------------------
 196          --         --
 197          --         --
 198          --         --
 199          --         --
 200          --         --
 201          --         --
 202          --         --
 203          --         --
 204          --         --
 205          --         --
 206          --         --
 207          --         --
 208          --         --
 209          --         --
 210          --         --
 211          --         --
 212          --         --
 213          --         --
 214          --         --
 215          --         --
 216          --         --
 217          --         --
 218          --         --
 219          --         --
 220          --         --
 221          --         --
 222          --         --
 223          --         --
 224          --         --
 225          --         --
 226          --         --
 227          --         --
 228          --         --
 229          --         --
 230          --         --
 231          --         --
 232          --         --
 233          --         --
 234          --         --
 235          --         --
 236          --         --
 237          --         --
 238          --         --
 239          --         --
 240          --         --
 241          --         --
 242          --         --
 243          --         --
 244          --         --Page 523  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT P
Zone           0          1
---------------------------
 245          --         --
 246          --         --
 247          --         --
 248          --         --
 249          --         --
 250   16,109.23  16,109.23
 251    7,673.5    7,673.5 
 252    2,028.15   2,028.15
 253      895.63     895.63
 254    9,147.92   9,147.92
 255          --         --
 256          --         --
 257   10,235.35  10,235.35
 258   14,847.79  14,847.79
 259    1,173.49   1,173.49
 260    5,589.32   5,589.32
 261    4,838.43   4,838.43
 262   21,283.07  21,283.07
 263    1,347.61   1,347.61
 264      990.34     990.34
 265    4,254.13   4,254.13
 266      177.4      177.4 
 267      252.32     252.32Page 524  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT A
Zone           0          1
---------------------------
   0  100,843.68 100,843.68
   1      501.59     501.59
   2       94.08      94.08
   3      456.11     456.11
   4      673.1      673.1 
   5      394.67     394.67
   6      191.3      191.3 
   7       78.09      78.09
   8      426.5      426.5 
   9      212.56     212.56
  10      438.06     438.06
  11      316.75     316.75
  12      309.22     309.22
  13      349.98     349.98
  14      522.42     522.42
  15      354.9      354.9 
  16      251.5      251.5 
  17       26.55      26.55
  18      301.1      301.1 
  19      202.68     202.68
  20      201.4      201.4 
  21      275.34     275.34
  22      432.53     432.53
  23      334.84     334.84
  24      229.38     229.38
  25      331.17     331.17
  26      273.01     273.01
  27      622.7      622.7 
  28      436.5      436.5 
  29      405.47     405.47
  30      441.01     441.01
  31      505.91     505.91
  32      232.57     232.57
  33      237.19     237.19
  34      364.09     364.09
  35      283.51     283.51
  36    1,450.42   1,450.42
  37      469.98     469.98
  38      252.88     252.88
  39    1,311.13   1,311.13
  40    1,455.15   1,455.15
  41    1,001.3    1,001.3 
  42      571.6      571.6 
  43    1,695.19   1,695.19
  44      657.74     657.74
  45    1,228.74   1,228.74
  46      493.53     493.53
  47      167.03     167.03
  48      178.81     178.81Page 525  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT A
Zone           0          1
---------------------------
  49      363.53     363.53
  50      577.31     577.31
  51      234.01     234.01
  52      317.78     317.78
  53      230.87     230.87
  54      255.29     255.29
  55      313.64     313.64
  56      496.3      496.3 
  57      781.86     781.86
  58      936.92     936.92
  59      913.84     913.84
  60      956.26     956.26
  61      147.88     147.88
  62      397.62     397.62
  63      680.95     680.95
  64      817.66     817.66
  65      706.44     706.44
  66      658.03     658.03
  67      426.47     426.47
  68      702.34     702.34
  69      631.01     631.01
  70      492.21     492.21
  71      201.86     201.86
  72      755.2      755.2 
  73      322.79     322.79
  74      226.66     226.66
  75      249.27     249.27
  76      177.45     177.45
  77      453.03     453.03
  78      278.03     278.03
  79      274.16     274.16
  80      278.8      278.8 
  81      299.03     299.03
  82      263.68     263.68
  83      347.48     347.48
  84      368.82     368.82
  85      379.06     379.06
  86      117.38     117.38
  87        9.77       9.77
  88      423.26     423.26
  89      414.14     414.14
  90      695.67     695.67
  91      131.31     131.31
  92    1,147.06   1,147.06
  93      212.28     212.28
  94      160.01     160.01
  95      452.64     452.64
  96    2,019.31   2,019.31
  97      632.05     632.05Page 526  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT A
Zone           0          1
---------------------------
  98      759.7      759.7 
  99      296.01     296.01
 100      961.05     961.05
 101      649.27     649.27
 102      243.29     243.29
 103      163.55     163.55
 104      726.96     726.96
 105      472.8      472.8 
 106      712.35     712.35
 107      490.97     490.97
 108    1,073.06   1,073.06
 109      654.32     654.32
 110      378.71     378.71
 111      296.17     296.17
 112      219.7      219.7 
 113      630.68     630.68
 114      557.88     557.88
 115      156        156   
 116      630.2      630.2 
 117      737.49     737.49
 118      160.78     160.78
 119      341.87     341.87
 120      166.66     166.66
 121      222.75     222.75
 122      263.98     263.98
 123      258        258   
 124      299.22     299.22
 125      351.95     351.95
 126      575.3      575.3 
 127      492.84     492.84
 128      480.95     480.95
 129      482.17     482.17
 130      303.38     303.38
 131      451.4      451.4 
 132      339.54     339.54
 133      302.43     302.43
 134      200.77     200.77
 135      358.1      358.1 
 136      691.38     691.38
 137      258.01     258.01
 138      288.3      288.3 
 139      446.35     446.35
 140      637.89     637.89
 141      867.19     867.19
 142      522.93     522.93
 143      583.88     583.88
 144      690.82     690.82
 145    1,251.44   1,251.44
 146      214.27     214.27Page 527  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT A
Zone           0          1
---------------------------
 147      616.93     616.93
 148    1,818.02   1,818.02
 149      399.9      399.9 
 150      717.11     717.11
 151      335.07     335.07
 152      527.42     527.42
 153      571.93     571.93
 154      227.78     227.78
 155      365.56     365.56
 156      805.68     805.68
 157      469.07     469.07
 158    1,090.65   1,090.65
 159    1,091.49   1,091.49
 160      381.62     381.62
 161      934.72     934.72
 162      937.56     937.56
 163      954.66     954.66
 164      706.66     706.66
 165      953.13     953.13
 166    1,537.79   1,537.79
 167      244.02     244.02
 168      330.04     330.04
 169      370.5      370.5 
 170      211.07     211.07
 171      345.87     345.87
 172      588.62     588.62
 173      472.71     472.71
 174      313.76     313.76
 175      816.19     816.19
 176      652.58     652.58
 177      957.37     957.37
 178      665.96     665.96
 179      369.83     369.83
 180      340.71     340.71
 181      618.53     618.53
 182      534.37     534.37
 183      512.91     512.91
 184      281.17     281.17
 185      499.28     499.28
 186      470.56     470.56
 187      229.8      229.8 
 188      417.56     417.56
 189      261.38     261.38
 190      260.5      260.5 
 191      401.33     401.33
 192      591.89     591.89
 193      348.75     348.75
 194      388.52     388.52
 195        6.19       6.19Page 528  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT A
Zone           0          1
---------------------------
 196          --         --
 197      510.67     510.67
 198      663.69     663.69
 199      631.46     631.46
 200      471.23     471.23
 201      259.95     259.95
 202      342.75     342.75
 203      120.18     120.18
 204      221.19     221.19
 205      215.43     215.43
 206      178.02     178.02
 207          --         --
 208          --         --
 209          --         --
 210          --         --
 211          --         --
 212          --         --
 213          --         --
 214          --         --
 215          --         --
 216          --         --
 217          --         --
 218          --         --
 219          --         --
 220          --         --
 221          --         --
 222          --         --
 223          --         --
 224          --         --
 225          --         --
 226          --         --
 227          --         --
 228          --         --
 229          --         --
 230          --         --
 231          --         --
 232          --         --
 233          --         --
 234          --         --
 235          --         --
 236          --         --
 237          --         --
 238          --         --
 239          --         --
 240          --         --
 241          --         --
 242          --         --
 243          --         --
 244          --         --Page 529  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------

REPORT A
Zone           0          1
---------------------------
 245          --         --
 246          --         --
 247          --         --
 248          --         --
 249          --         --
 250          --         --
 251          --         --
 252          --         --
 253          --         --
 254          --         --
 255          --         --
 256          --         --
 257          --         --
 258          --         --
 259          --         --
 260          --         --
 261          --         --
 262          --         --
 263          --         --
 264          --         --
 265          --         --
 266          --         --
 267          --         --

Total P/A  1  100,844  100,844

File C:\projects\Roanoke\Base\Output\IEEI_PA_2012.DBF opened

GENERATION ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 530  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:54 2016

FILEO RECO[1] = "C:\projects\Roanoke\Base\Output\NHBNR_PA_2012.DBF",
 FIELDS=Z, NHBNR_P, NHBNR_A
FILEI RECI = "C:\projects\Roanoke\Base\Output\IEEI_PA_2012.DBF"


ZONES = 267
NHB_PCT = .30 ; 30% of External trips make NHB trips inside the region

RO.Z=RI.Z
RO.NHBNR_P = RI.P1 * NHB_PCT
RO.NHBNR_A = RI.A1 * NHB_PCT
WRITE RECO=1


MATRIX Stack Size = 474 bytes.
................................................................................


FILEI RECI=C:\projects\Roanoke\Base\Output\IEEI_PA_2012.DBF Opened: 267 data records  3 Fields:
Z N3                P1 N10.3            A1 N10.3           


M(705): 267 RECI records processed,  0 with errors.

Variable Values at end of Iteration 1 I loop:

    RECI   :  267   252.320     0.000
    NHB_PCT:  0.3

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\Output\NHBNR_PA_2012.DBF.

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 531  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
DISTRIBUTION (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:54 2016

FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Output\IEEI_PA_2012.DBF"
FILEO MATO[1] = "C:\projects\Roanoke\Base\Output\IEEI_2012.MAT",
 MO=1, NAME=TRIPS, DEC=D
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Hwyskim.MAT"

PAR maxiters=20 maxrmse=10
setpa p[1]=zi.1.p1, a[1]=zi.1.a1  ;Set P and A Fields

; Gamma Function parameters
alpha   =  1.3544
beta    = -4.0016
epsilon =  .14

MW[2]=mi.1.1      ; total travel time

; First replace any 0 times with a very small travel time to avoid
;  failure of the exponentiation calculation.
JLOOP
  IF (MW[2]=0)
    MW[2]=.1
    ENDIF
  ENDJLOOP

;calculate friction factor using the gamma function
mw[3]  = (alpha * (MW[2]^beta) * EXP(epsilon*MW[2]))

;apply the results of gamma formulation
PAF=0
MW[1] = A[1] * MW[3]
ATTRSUM=ROWSUM(1)
IF (ATTRSUM>0) PAF=P[1]/ATTRSUM
MW[1]=PAF * MW[1]


; ========GENERATE FREQUENCY REPORTS BASED ON TIME============
FREQUENCY VALUEMW=1 BASEMW=2, RANGE=0-42,
TITLE='** IEEI Travel Time Frequency **'

DISTRIBUTION Stack Size = 1220 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Output\IEEI_PA_2012.DBF Opened: 267 data records  3 Fields:
Z(N)            P1(N)           A1(N)          


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:54 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 532  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

Totals after Iteration 1 I loop:

	MI.01.001:     627,483.52   @J=I:         116.87
	MW[1]    :     100,843.68
	MW[2]    :     629,732.02   @J=I:         123.17
	MW[3]    : 727,881,843.55   @J=I: 145,045,718.26

Variable Values at end of Iteration 1 I loop:

    ALPHA  :  1.3544
    BETA   : -4.0016
    EPSILON:  0.14  
    PAF    : 13.8699
    ATTRSUM: 18.1919Page 533  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 2
--------------------

Totals after Iteration 2 I loop:

	MI.01.001:     627,483.52   @J=I:         116.87
	MW[1]    :     100,843.68
	MW[2]    :     629,732.02   @J=I:         123.17
	MW[3]    : 727,881,843.55   @J=I: 145,045,718.26

Variable Values at end of Iteration 2 I loop:

    ALPHA  :  1.3544
    BETA   : -4.0016
    EPSILON:  0.14  
    PAF    : 11.5381
    ATTRSUM: 21.8684Page 534  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 3
--------------------

Totals after Iteration 3 I loop:

	MI.01.001:     627,483.52   @J=I:         116.87
	MW[1]    :     100,843.68
	MW[2]    :     629,732.02   @J=I:         123.17
	MW[3]    : 727,881,843.55   @J=I: 145,045,718.26

Variable Values at end of Iteration 3 I loop:

    ALPHA  :  1.3544
    BETA   : -4.0016
    EPSILON:  0.14  
    PAF    : 11.7373
    ATTRSUM: 21.4973Page 535  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 4
--------------------

Totals after Iteration 4 I loop:

	MI.01.001:     627,483.52   @J=I:         116.87
	MW[1]    :     100,843.68
	MW[2]    :     629,732.02   @J=I:         123.17
	MW[3]    : 727,881,843.55   @J=I: 145,045,718.26

Variable Values at end of Iteration 4 I loop:

    ALPHA  :  1.3544
    BETA   : -4.0016
    EPSILON:  0.14  
    PAF    : 11.7276
    ATTRSUM: 21.515 Page 536  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 5
--------------------

Totals after Iteration 5 I loop:

	MI.01.001:     627,483.52   @J=I:         116.87
	MW[1]    :     100,843.68
	MW[2]    :     629,732.02   @J=I:         123.17
	MW[3]    : 727,881,843.55   @J=I: 145,045,718.26

Variable Values at end of Iteration 5 I loop:

    ALPHA  :  1.3544
    BETA   : -4.0016
    EPSILON:  0.14  
    PAF    : 11.7077
    ATTRSUM: 21.5516

RMSE  MW=  1
------------
 1    796.41
 2     66.85
 3     28.23
 4     14.42
 5      5.84Page 537  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 5
--------------------

Totals after Iteration 5 I loop:

	MI.01.001:     627,483.52   @J=I:         116.87
	MW[1]    :     100,843.68
	MW[2]    :     629,732.02   @J=I:         123.17
	MW[3]    : 727,881,843.55   @J=I: 145,045,718.26
	MO.01.001:     100,843.68

Variable Values at end of Iteration 5 I loop:

    ALPHA  :  1.3544
    BETA   : -4.0016
    EPSILON:  0.14  
    PAF    : 11.6986
    ATTRSUM: 21.5684

RMSE  MW=  1
------------
 1    796.41
 2     66.85
 3     28.23
 4     14.42
 5      2.04Page 538  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

FREQUENCY (Iter=5) ** IEEI Travel Time Frequency **
  BASEMW=2 VALUEMW=1 RANGE=0,42,1
  MW[2]                   Accum
>=  -  < Obs    Sum   Pct  Pct
---------------------------------------------------
  0 -  1   1   322.50 0.3   0.3 |
  1 -  2   2   199.91 0.2   0.5 |
  2 -  3   8 1,693.37 1.7   2.2 |=
  3 -  4   8 2,078.23 2.1   4.3 |==
  4 -  5  15 1,553.43 1.5   5.8 |=
  5 -  6  21 2,589.94 2.6   8.4 |==
  6 -  7  25 2,024.88 2.0  10.4 |==
  7 -  8  35 2,245.69 2.2  12.6 |==
  8 -  9  49 2,475.46 2.5  15.1 |==
  9 - 10  55 2,673.93 2.7  17.7 |==
 10 - 11  64 2,362.06 2.3  20.1 |==
 11 - 12  73 2,908.71 2.9  22.9 |==
 12 - 13  89 4,039.83 4.0  26.9 |====
 13 - 14 100 2,437.59 2.4  29.4 |==
 14 - 15 103 3,394.23 3.4  32.7 |===
 15 - 16 136 5,891.81 5.8  38.6 |=====
 16 - 17 174 6,416.55 6.4  44.9 |======
 17 - 18 154 4,840.75 4.8  49.7 |====
 18 - 19 186 5,331.75 5.3  55.0 |=====
 19 - 20 210 5,996.40 5.9  61.0 |=====
 20 - 21 250 5,574.57 5.5  66.5 |=====
 21 - 22 222 7,184.78 7.1  73.6 |=======
 22 - 23 240 5,065.88 5.0  78.6 |=====
 23 - 24 227 5,118.68 5.1  83.7 |=====
 24 - 25 179 3,709.11 3.7  87.4 |===
 25 - 26 137 2,688.92 2.7  90.1 |==
 26 - 27 131 3,424.29 3.4  93.5 |===
 27 - 28  93 2,022.90 2.0  95.5 |==
 28 - 29  66 1,575.06 1.6  97.0 |=
 29 - 30  62 1,241.46 1.2  98.3 |=
 30 - 31  51   967.53 1.0  99.2 |
 31 - 32  29   130.14 0.1  99.3 |
 32 - 33  29   369.48 0.4  99.7 |
 33 - 34  16   109.36 0.1  99.8 |
 34 - 35  17    65.68 0.1  99.9 |
 35 - 36   6     4.03 0.0  99.9 |
 36 - 37   5    53.77 0.1  99.9 |
 37 - 38  10    60.74 0.1 100.0 |
 38 - 39   2     0.25 0.0 100.0 |
 39 - 40  --       --  -- 100.0 |
 40 - 41  --       --  -- 100.0 |
 41 - 42  --       --  -- 100.0 |
 42+      --       --  -- 100.0 |
--------------------------------Page 539  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

FREQUENCY (Iter=5) ** IEEI Travel Time Frequency **
  BASEMW=2 VALUEMW=1 RANGE=0,42,1
  MW[2]                   Accum
>=  -  < Obs    Sum   Pct  Pct
---------------------------------------------------
Total Obs = 3,280
Total Sum = 100,843.68
Mean      = 17.3
@I=J      = 0

DISTRIBUTION ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################
Page 540  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:55 2016

FILEO MATO[4] = "C:\projects\Roanoke\Base\Output\IEEI_2012_NT.MAT",
 MO=34, NAME=IEEI_NT, DEC=D
FILEO MATO[3] = "C:\projects\Roanoke\Base\Output\IEEI_2012_PM.MAT",
 MO=33, NAME=IEEI_PM, DEC=D
FILEO MATO[2] = "C:\projects\Roanoke\Base\Output\IEEI_2012_MD.MAT",
 MO=32, NAME=IEEI_MD, DEC=D
FILEO MATO[1] = "C:\projects\Roanoke\Base\Output\IEEI_2012_AM.MAT",
 MO=31, NAME=IEEI_AM, DEC=D
FILEI MATI[1] = "C:\projects\Roanoke\Base\Output\IEEI_2012.MAT"
ZONES=267

;Define arrays of time of day factors
ARRAY IEFct=4
IEFct[1] = 0.03  ;AM IE Factor
IEFct[2] = 0.28   ;MD IE Factor
IEFct[3] = 0.08   ;PM IE Factor
IEFct[4] = 0.11   ;NT IE Factor

ARRAY EIFct=4
EIFct[1] = 0.16  ;AM EI Factor
EIFct[2] = 0.20   ;MD EI Factor
EIFct[3] = 0.03   ;PM EI Factor
EIFct[4] = 0.11   ;NT EI Factor

MW[1]=mi.1.1      ;IEEI Daily Trips
MW[2]=mi.1.1.T    ;IEEI Daily Trips

;  MW[11] through MW[14] are the working tables (four time periods) for IE trips
;  MW[21] through MW[24] are the working tables (four time periods) for EI trips
;  MW[31] through MW[34] are the final output tables (four time periods) for total IEEI trips.

LOOP TOD=1,4
  IETable = (10) + TOD
  MW[IETable] = MW[2] * IEFct[TOD]

  EITable = (20) + TOD
  MW[EITable] = MW[1] * EIFct[TOD]

  TODTable = (30) + TOD
  MW[TODTable] = MW[IETable] + MW[EITable]
ENDLOOP


MATRIX Stack Size = 1552 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\Output\IEEI_2012.MAT OpenedPage 541  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MAT PGM=DISTRIBUTION (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:54 2016 
ID=
PAR Zones=267 M=1
  TRIPS

M(792): ARRAY IEFCT requires 40 bytes.

M(792): ARRAY EIFCT requires 40 bytes.

Totals from Transpose:

	MI.01.001.T: 100,844

M(660): Transpose Disk Usage (bytes): Data=38,469, Index=1,068.Page 542  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  : 100,843.7
	MI.01.001.T: 100,843.7
	MW[1]      : 100,843.7
	MW[2]      : 100,843.7
	MW[11]     :   3,025.3
	MW[12]     :  28,236.2
	MW[13]     :   8,067.5
	MW[14]     :  11,092.8
	MW[21]     :  16,135  
	MW[22]     :  20,168.7
	MW[23]     :   3,025.3
	MW[24]     :  11,092.8
	MW[31]     :  19,160.3
	MW[32]     :  48,405  
	MW[33]     :  11,092.8
	MW[34]     :  22,185.6
	MO.04.001  :  22,185.6
	MO.03.001  :  11,092.8
	MO.02.001  :  48,405  
	MO.01.001  :  19,160.3

Variable Values at end of Iteration 1 I loop:

    TOD     :  5
    IETABLE : 14
    EITABLE : 24
    TODTABLE: 34

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 543  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:55 2016

FILEO MATO[4] = "C:\projects\Roanoke\Base\Output\EE_2012_NT.MAT",
MO=14, NAME=EE_NT, DEC=1*D
FILEO MATO[3] = "C:\projects\Roanoke\Base\Output\EE_2012_PM.MAT",
MO=13, NAME=EE_PM, DEC=1*D
FILEO MATO[2] = "C:\projects\Roanoke\Base\Output\EE_2012_MD.MAT",
MO=12, NAME=EE_MD, DEC=1*D
FILEO MATO[1] = "C:\projects\Roanoke\Base\Output\EE_2012_AM.MAT",
 MO=11, NAME=EE_AM, DEC=1*D
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\EE_2012.MAT"


MW[1]=mi.1.1     ;EE Daily Trips

ZONES=267

;Define arrays of time of day factors
ARRAY EEFct=4
EEFct[1] = 0.141 ;AM IE Factor
EEFct[2] = 0.458 ;MD IE Factor
EEFct[3] = 0.154 ;PM IE Factor
EEFct[4] = 0.247  ;NT IE Factor




;  MW[11] through MW[14] are the working tables (four time periods) for EE trips

LOOP TOD=1,4
  EETable = (10) + TOD
  MW[EETable] = MW[1] * EEFct[TOD]
ENDLOOP

MATRIX Stack Size = 1044 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\EE_2012.MAT Opened
MAT PGM=FRATAR (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:54 2016 
ID=
PAR Zones=267 M=1
  EE_TRIPS

M(792): ARRAY EEFCT requires 40 bytes.Page 544  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 41,786.7
	MW[1]    : 41,786.7
	MW[11]   :  5,891.9
	MW[12]   : 19,138.3
	MW[13]   :  6,435.1
	MW[14]   : 10,321.3
	MO.04.001: 10,321.3
	MO.03.001:  6,435.1
	MO.02.001: 19,138.3
	MO.01.001:  5,891.9

Variable Values at end of Iteration 1 I loop:

    TOD    :  5
    EETABLE: 14

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 545  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------
GENERATION (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:55 2016

FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\CVRATES.CSV"
FILEO PAO[1] = "C:\projects\Roanoke\Base\Output\CV_PA_2012.DBF",
FORM=10.3, DBF=T, LIST=Z, P[1], P[2], P[3], A[1], A[2], A[3]
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\se.dbf"

ZONES=206

LOOKUP, LOOKUPI=1,
 NAME=CVRates,
    LOOKUP[1]=1, RESULT=2,
    LOOKUP[2]=1, RESULT=3,
    LOOKUP[3]=1, RESULT=4,
 INTERPOLATE=N, FAIL[1]=0, FAIL[2]=0, FAIL[3]=0, LIST=Y

PHASE=ILOOP

 P[1]= (IND*CVRates(1,1))+((RET + SG_RET)*CVRates(1,2))+(HTRET*CVRates(1,3))+(OFF*CVRates(1,4))+((SER+SG_AIR+SG_COL+SG_HOS)*CVRates(1,5))+(HH*CVRates(1,6))

 P[2]= (IND*CVRates(2,1))+((RET + SG_RET)*CVRates(2,2))+(HTRET*CVRates(2,3))+(OFF*CVRates(2,4))+((SER+SG_AIR+SG_COL+SG_HOS)*CVRates(2,5))+(HH*CVRates(2,6))
 P[3]= (IND*CVRates(3,1))+((RET + SG_RET)*CVRates(3,2))+(HTRET*CVRates(3,3))+(OFF*CVRates(3,4))+((SER+SG_AIR+SG_COL+SG_HOS)*CVRates(3,5))+(HH*CVRates(3,6))

 A[1]=P[1]
  A[2]=P[2]
  A[3]=P[3]

ENDPHASE

PHASE=ADJUST
  BALANCE NHB=1
ENDPHASE


GENERATION Stack Size = 1370 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\se.dbf Opened: 205 data records  23 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)           


LOOKUP   CVRates:  FAIL=  --  --  --
         CVRates(1,1)  = 0.398
         CVRates(1,2)  = 0.051
         CVRates(1,3)  = 0.051
         CVRates(1,4)  = 0.051
         CVRates(1,5)  = 0.051
         CVRates(1,6)  = 0.166
         CVRates(2,1)  = 0.582Page 546  (VOYAGER GENERATION) 
Parsons Brinckerhoff
-------------------------------
         CVRates(2,2)  = 0.048
         CVRates(2,3)  = 0.048
         CVRates(2,4)  = 0.049
         CVRates(2,5)  = 0.02
         CVRates(2,6)  = 0.076
         CVRates(3,1)  = 0.132
         CVRates(3,2)  = 0.02
         CVRates(3,3)  = 0.02
         CVRates(3,4)  = 0.015
         CVRates(3,5)  = 0.015
         CVRates(3,6)  = 0.006


Total P/A  1  32,814  32,814
Total P/A  2  24,746  24,746
Total P/A  3   5,300   5,300

PHASE=ADJUST:

Total P/A  1  32,814  32,814
Total P/A  2  24,746  24,746
Total P/A  3   5,300   5,300

File C:\projects\Roanoke\Base\Output\CV_PA_2012.DBF opened

GENERATION ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 547  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
DISTRIBUTION (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:55 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\Output\CV_2012.MAT",
  MO=1-3, NAME=FourTire, SixTire, Combo, DEC=D
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Hwyskim.MAT"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Output\CV_PA_2012.DBF"


PAR maxiters=20 maxrmse=10

setpa  P[1]=ZI.1.P1, P[2]=ZI.1.P2, P[3]=ZI.1.P3,  ; Set P and A Fields 1-3 = 4-tire, 6-tire, and combo
   A[1]=ZI.1.A1, A[2]=ZI.1.A2, A[3]=ZI.1.A3

; Estmated Gamma Function parameters,  Define array of coefficients and poplate.
 ARRAY alpha=3
 ARRAY beta=3
 ARRAY epsilon=3

; Coefficients are set the the default NCDOT Small Area Travel Demand Model Procedures Manual
;     for all three CV types.  Further testing and calibration may be needed.
  alpha[1] = 4.6750
 beta[1] = 0.2916
 epsilon[1] = 0.1390

 alpha[2] = 4.6750
 beta[2] = 0.2916
 epsilon[2] = 0.1390

 alpha[3] = 4.6750
 beta[3] = 0.2916
 epsilon[3] = 2.4000

MW[10]=mi.1.1      ; total travel time

; First replace any 0 times with a very small travel time to avoid
;  failure of the exponentiation calculation.
JLOOP
  IF (MW[10]=0)
    MW[10]=0.0000001
    ENDIF
  ENDJLOOP

;calculate friction factor using the gamma function
LOOP CVType=1,3
  CVIDX=10+CVType
 MW[CVIDX] = alpha[CVType] * (MW[10]^beta[CVType]) * EXP(epsilon[CVType]*MW[10])
 ENDLOOP

;apply the results of gamma formulation
LOOP PURP= 1, 3
  CVIDX=10+PURP
 PAF=0
 MW[PURP] = A[PURP] * MW[CVIDX]
 ATTRSUM=ROWSUM(PURP)Page 548  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
 IF (ATTRSUM>0) PAF=P[PURP]/ATTRSUM
 MW[PURP]=PAF * MW[PURP]
ENDLOOP

; ========GENERATE FREQUENCY REPORTS BASED ON TIME============
FREQUENCY VALUEMW=1 BASEMW=10, RANGE=0-42,
TITLE='** CV 4-Tire Travel Time Frequency **'

FREQUENCY VALUEMW=2 BASEMW=10, RANGE=0-42,
TITLE='** SUT 6-Tire Travel Time Frequency **'

FREQUENCY VALUEMW=3 BASEMW=10, RANGE=0-42,
TITLE='** MUT Combo Travel Time Frequency **'


DISTRIBUTION Stack Size = 2236 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:54 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME

FILEI ZDATI=C:\projects\Roanoke\Base\Output\CV_PA_2012.DBF Opened: 206 data records  7 Fields:
Z(N)            P1(N)           P2(N)           P3(N)           A1(N)          
A2(N)           A3(N)          


M(792): ARRAY ALPHA requires 32 bytes.

M(792): ARRAY BETA requires 32 bytes.

M(792): ARRAY EPSILON requires 32 bytes.Page 549  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

Totals after Iteration 1 I loop:

	MI.01.001:                 627,483.52     @J=I:                     116.87  
	MW[1]    :                  32,814.354    @J=I:                      17.027 
	MW[2]    :                  24,745.767    @J=I:                      19.1976
	MW[3]    :                   5,299.9      @J=I:                       0     
	MW[10]   :                 627,483.5222   @J=I:                     116.87  
	MW[11]   :               5,278,376.7765   @J=I:                     815.7731
	MW[12]   :               5,278,376.7765   @J=I:                     815.7731
	MW[13]   :      1.0298955139567506e+045   @J=I:                  69,100.3798

Variable Values at end of Iteration 1 I loop:

    CVTYPE :                       4
    CVIDX  :                      13
    PURP   :                       4
    ATTRSUM: 3.4211321666280124e+039Page 550  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 2
--------------------

Totals after Iteration 2 I loop:

	MI.01.001:                 627,483.52     @J=I:                     116.87  
	MW[1]    :                  32,814.354    @J=I:                      24.2759
	MW[2]    :                  24,745.767    @J=I:                      26.3856
	MW[3]    :                   5,299.9      @J=I:                       0     
	MW[10]   :                 627,483.5222   @J=I:                     116.87  
	MW[11]   :               5,278,376.7765   @J=I:                     815.7731
	MW[12]   :               5,278,376.7765   @J=I:                     815.7731
	MW[13]   :      1.0298955139567506e+045   @J=I:                  69,100.3798

Variable Values at end of Iteration 2 I loop:

    CVTYPE :                       4
    CVIDX  :                      13
    PURP   :                       4
    ATTRSUM: 3.8818089806783838e+039Page 551  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 3
--------------------

Totals after Iteration 3 I loop:

	MI.01.001:                 627,483.52      @J=I:                     116.87   
	MW[1]    :                  32,814.354     @J=I:                      24.36151
	MW[2]    :                  24,745.767     @J=I:                      26.40815
	MW[3]    :                   5,299.9       @J=I:                       0.00001
	MW[10]   :                 627,483.52225   @J=I:                     116.87001
	MW[11]   :               5,278,376.7765    @J=I:                     815.77311
	MW[12]   :               5,278,376.7765    @J=I:                     815.77311
	MW[13]   :       1.0298955139567506e+045   @J=I:                  69,100.37984

Variable Values at end of Iteration 3 I loop:

    CVTYPE :                       4
    CVIDX  :                      13
    PURP   :                       4
    ATTRSUM: 6.6018928178593052e+039Page 552  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 4
--------------------

Totals after Iteration 4 I loop:

	MI.01.001:                 627,483.52      @J=I:                     116.87   
	MW[1]    :                  32,814.354     @J=I:                      24.36484
	MW[2]    :                  24,745.767     @J=I:                      26.40631
	MW[3]    :                   5,299.9       @J=I:                       0.00001
	MW[10]   :                 627,483.52225   @J=I:                     116.87001
	MW[11]   :               5,278,376.7765    @J=I:                     815.77311
	MW[12]   :               5,278,376.7765    @J=I:                     815.77311
	MW[13]   :       1.0298955139567506e+045   @J=I:                  69,100.37984

Variable Values at end of Iteration 4 I loop:

    CVTYPE :                     4
    CVIDX  :                    13
    PURP   :                     4
    ATTRSUM: 7.73809812671847e+039Page 553  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 5
--------------------

Totals after Iteration 5 I loop:

	MI.01.001:                 627,483.52      @J=I:                     116.87   
	MW[1]    :                  32,814.354     @J=I:                      24.36515
	MW[2]    :                  24,745.767     @J=I:                      26.40613
	MW[3]    :                   5,299.9       @J=I:                       0.00001
	MW[10]   :                 627,483.52225   @J=I:                     116.87001
	MW[11]   :               5,278,376.7765    @J=I:                     815.77311
	MW[12]   :               5,278,376.7765    @J=I:                     815.77311
	MW[13]   :       1.0298955139567506e+045   @J=I:                  69,100.37984

Variable Values at end of Iteration 5 I loop:

    CVTYPE :                       4
    CVIDX  :                      13
    PURP   :                       4
    ATTRSUM: 7.5705496593886639e+039Page 554  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 6
--------------------

Totals after Iteration 6 I loop:

	MI.01.001:                 627,483.52      @J=I:                     116.87   
	MW[1]    :                  32,814.354     @J=I:                      24.36518
	MW[2]    :                  24,745.767     @J=I:                      26.40612
	MW[3]    :                   5,299.9       @J=I:                       0.00002
	MW[10]   :                 627,483.52225   @J=I:                     116.87001
	MW[11]   :               5,278,376.7765    @J=I:                     815.77311
	MW[12]   :               5,278,376.7765    @J=I:                     815.77311
	MW[13]   :       1.0298955139567506e+045   @J=I:                  69,100.37984

Variable Values at end of Iteration 6 I loop:

    CVTYPE :                       4
    CVIDX  :                      13
    PURP   :                       4
    ATTRSUM: 6.9698135359581363e+039

RMSE  MW=  1       2       3
----------------------------
 1    102.97   81.45  171.12
 2      2.13    1.83   30.02
 3      0.14    0.16   18.93
 4      0.00    0.00   13.97
 5      0.00    0.00   10.66
 6      0.00    0.00    8.60Page 555  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------
Iteration 6
--------------------

Totals after Iteration 6 I loop:

	MI.01.001:                 627,483.52      @J=I:                     116.87   
	MW[1]    :                  32,814.354     @J=I:                      24.36519
	MW[2]    :                  24,745.767     @J=I:                      26.40612
	MW[3]    :                   5,299.9       @J=I:                       0.00002
	MW[10]   :                 627,483.52225   @J=I:                     116.87001
	MW[11]   :               5,278,376.7765    @J=I:                     815.77311
	MW[12]   :               5,278,376.7765    @J=I:                     815.77311
	MW[13]   :       1.0298955139567506e+045   @J=I:                  69,100.37984
	MO.01.001:                  32,814.354  
	MO.01.002:                  24,747.91   
	MO.01.003:                   5,295.36   

Variable Values at end of Iteration 6 I loop:

    CVTYPE :                       4
    CVIDX  :                      13
    PURP   :                       4
    ATTRSUM: 6.3322463407033923e+039

RMSE  MW=  1       2       3
----------------------------
 1    102.97   81.45  171.12
 2      2.13    1.83   30.02
 3      0.14    0.16   18.93
 4      0.00    0.00   13.97
 5      0.00    0.00   10.66
 6      0.00    0.00    7.41Page 556  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

FREQUENCY (Iter=6) ** CV 4-Tire Travel Time Frequency **
  BASEMW=10 VALUEMW=1 RANGE=0,42,1
 MW[10]                     Accum
>=  -  <  Obs     Sum   Pct  Pct
--------------------------------------------------------
  0 -  1   563    73.94 0.2   0.2 |
  1 -  2   690   137.88 0.4   0.6 |
  2 -  3 1,092   320.51 1.0   1.6 |
  3 -  4 1,424   543.50 1.7   3.3 |=
  4 -  5 1,808   819.88 2.5   5.8 |==
  5 -  6 2,074 1,191.59 3.6   9.4 |===
  6 -  7 2,292 1,552.44 4.7  14.1 |====
  7 -  8 2,465 1,801.69 5.5  19.6 |=====
  8 -  9 2,621 2,108.36 6.4  26.1 |======
  9 - 10 2,707 2,535.16 7.7  33.8 |=======
 10 - 11 2,720 2,610.98 8.0  41.7 |=======
 11 - 12 2,724 2,678.78 8.2  49.9 |========
 12 - 13 2,613 2,565.57 7.8  57.7 |=======
 13 - 14 2,457 2,338.17 7.1  64.8 |=======
 14 - 15 2,179 2,246.67 6.8  71.7 |======
 15 - 16 2,039 1,860.24 5.7  77.4 |=====
 16 - 17 1,793 1,552.60 4.7  82.1 |====
 17 - 18 1,508 1,371.92 4.2  86.3 |====
 18 - 19 1,347 1,013.09 3.1  89.4 |===
 19 - 20 1,108   881.12 2.7  92.0 |==
 20 - 21   961   753.94 2.3  94.3 |==
 21 - 22   701   492.68 1.5  95.8 |=
 22 - 23   597   401.75 1.2  97.1 |=
 23 - 24   480   346.80 1.1  98.1 |=
 24 - 25   340   227.19 0.7  98.8 |
 25 - 26   201   119.62 0.4  99.2 |
 26 - 27   163    91.59 0.3  99.5 |
 27 - 28   113    69.38 0.2  99.7 |
 28 - 29    71    37.78 0.1  99.8 |
 29 - 30    57    20.99 0.1  99.9 |
 30 - 31    60    24.98 0.1  99.9 |
 31 - 32    21    11.01 0.0 100.0 |
 32 - 33    12     3.05 0.0 100.0 |
 33 - 34     5     1.95 0.0 100.0 |
 34 - 35    13     5.01 0.0 100.0 |
 35 - 36     5     2.15 0.0 100.0 |
 36 - 37     1     0.45 0.0 100.0 |
 37 - 38    --       --  -- 100.0 |
 38 - 39    --       --  -- 100.0 |
 39 - 40    --       --  -- 100.0 |
 40 - 41    --       --  -- 100.0 |
 41 - 42    --       --  -- 100.0 |
 42+        --       --  -- 100.0 |
----------------------------------Page 557  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

FREQUENCY (Iter=6) ** CV 4-Tire Travel Time Frequency **
  BASEMW=10 VALUEMW=1 RANGE=0,42,1
 MW[10]                     Accum
>=  -  <  Obs     Sum   Pct  Pct
--------------------------------------------------------
Total Obs = 42,025
Total Sum = 32,814.35
Mean      = 12.4
@I=J      = 24.37Page 558  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

FREQUENCY (Iter=6) ** SUT 6-Tire Travel Time Frequency **
  BASEMW=10 VALUEMW=2 RANGE=0,42,1
 MW[10]                     Accum
>=  -  <  Obs     Sum   Pct  Pct
---------------------------------------------------------
  0 -  1   563    66.52 0.3   0.3 |
  1 -  2   690   108.87 0.4   0.7 |
  2 -  3 1,092   234.90 0.9   1.7 |
  3 -  4 1,424   403.86 1.6   3.3 |=
  4 -  5 1,808   592.52 2.4   5.7 |==
  5 -  6 2,074   904.37 3.7   9.3 |===
  6 -  7 2,292 1,145.35 4.6  14.0 |====
  7 -  8 2,465 1,289.28 5.2  19.2 |=====
  8 -  9 2,621 1,545.27 6.2  25.4 |======
  9 - 10 2,707 2,056.53 8.3  33.7 |========
 10 - 11 2,720 2,062.52 8.3  42.1 |========
 11 - 12 2,724 2,125.34 8.6  50.7 |========
 12 - 13 2,613 1,971.61 8.0  58.6 |=======
 13 - 14 2,457 1,743.36 7.0  65.7 |=======
 14 - 15 2,179 1,718.11 6.9  72.6 |======
 15 - 16 2,039 1,379.48 5.6  78.2 |=====
 16 - 17 1,793 1,185.49 4.8  83.0 |====
 17 - 18 1,508 1,034.26 4.2  87.2 |====
 18 - 19 1,347   719.11 2.9  90.1 |==
 19 - 20 1,108   662.93 2.7  92.7 |==
 20 - 21   961   542.96 2.2  94.9 |==
 21 - 22   701   327.53 1.3  96.3 |=
 22 - 23   597   274.72 1.1  97.4 |=
 23 - 24   480   235.54 1.0  98.3 |
 24 - 25   340   159.77 0.6  99.0 |
 25 - 26   201    74.15 0.3  99.3 |
 26 - 27   163    63.79 0.3  99.5 |
 27 - 28   113    46.08 0.2  99.7 |
 28 - 29    71    23.82 0.1  99.8 |
 29 - 30    57    14.52 0.1  99.9 |
 30 - 31    60    17.46 0.1  99.9 |
 31 - 32    21     7.63 0.0 100.0 |
 32 - 33    12     1.81 0.0 100.0 |
 33 - 34     5     1.42 0.0 100.0 |
 34 - 35    13     3.00 0.0 100.0 |
 35 - 36     5     1.50 0.0 100.0 |
 36 - 37     1     0.40 0.0 100.0 |
 37 - 38    --       --  -- 100.0 |
 38 - 39    --       --  -- 100.0 |
 39 - 40    --       --  -- 100.0 |
 40 - 41    --       --  -- 100.0 |
 41 - 42    --       --  -- 100.0 |
 42+        --       --  -- 100.0 |
----------------------------------Page 559  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

FREQUENCY (Iter=6) ** SUT 6-Tire Travel Time Frequency **
  BASEMW=10 VALUEMW=2 RANGE=0,42,1
 MW[10]                     Accum
>=  -  <  Obs     Sum   Pct  Pct
---------------------------------------------------------
Total Obs = 42,025
Total Sum = 24,745.77
Mean      = 12.31
@I=J      = 26.41Page 560  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

FREQUENCY (Iter=6) ** MUT Combo Travel Time Frequency **
  BASEMW=10 VALUEMW=3 RANGE=0,42,1
 MW[10]                    Accum
>=  -  <  Obs    Sum   Pct  Pct
--------------------------------------------------------
  0 -  1   563   0.00  0.0   0.0 |
  1 -  2   690   0.00  0.0   0.0 |
  2 -  3 1,092   0.03  0.0   0.0 |
  3 -  4 1,424   0.45  0.0   0.0 |
  4 -  5 1,808   4.90  0.1   0.1 |
  5 -  6 2,074  33.38  0.6   0.7 |
  6 -  7 2,292 128.66  2.4   3.2 |==
  7 -  8 2,465 148.64  2.8   6.0 |==
  8 -  9 2,621 188.30  3.6   9.5 |===
  9 - 10 2,707 352.60  6.7  16.2 |======
 10 - 11 2,720 420.16  7.9  24.1 |=======
 11 - 12 2,724 489.88  9.2  33.3 |=========
 12 - 13 2,613 550.77 10.4  43.7 |==========
 13 - 14 2,457 530.91 10.0  53.7 |==========
 14 - 15 2,179 510.76  9.6  63.4 |=========
 15 - 16 2,039 417.06  7.9  71.3 |=======
 16 - 17 1,793 341.04  6.4  77.7 |======
 17 - 18 1,508 319.74  6.0  83.7 |======
 18 - 19 1,347 202.67  3.8  87.5 |===
 19 - 20 1,108 181.17  3.4  91.0 |===
 20 - 21   961 153.38  2.9  93.9 |==
 21 - 22   701  83.43  1.6  95.4 |=
 22 - 23   597  81.87  1.5  97.0 |=
 23 - 24   480  59.87  1.1  98.1 |=
 24 - 25   340  40.85  0.8  98.9 |
 25 - 26   201  17.42  0.3  99.2 |
 26 - 27   163  15.25  0.3  99.5 |
 27 - 28   113   9.48  0.2  99.7 |
 28 - 29    71   6.00  0.1  99.8 |
 29 - 30    57   3.70  0.1  99.9 |
 30 - 31    60   3.84  0.1  99.9 |
 31 - 32    21   2.01  0.0 100.0 |
 32 - 33    12   0.20  0.0 100.0 |
 33 - 34     5   0.41  0.0 100.0 |
 34 - 35    13   0.52  0.0 100.0 |
 35 - 36     5   0.37  0.0 100.0 |
 36 - 37     1   0.18  0.0 100.0 |
 37 - 38    --     --   -- 100.0 |
 38 - 39    --     --   -- 100.0 |
 39 - 40    --     --   -- 100.0 |
 40 - 41    --     --   -- 100.0 |
 41 - 42    --     --   -- 100.0 |
 42+        --     --   -- 100.0 |
---------------------------------Page 561  (VOYAGER DISTRIBUTION) 
Parsons Brinckerhoff
---------------------------------

FREQUENCY (Iter=6) ** MUT Combo Travel Time Frequency **
  BASEMW=10 VALUEMW=3 RANGE=0,42,1
 MW[10]                    Accum
>=  -  <  Obs    Sum   Pct  Pct
--------------------------------------------------------
Total Obs = 42,025
Total Sum = 5,299.9
Mean      = 14.03
@I=J      = 0

DISTRIBUTION ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################
Page 562  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:56 2016

FILEO MATO[4] = "C:\projects\Roanoke\Base\Output\CV_2012_NT.MAT",
 MO=41-43, NAME=CV_NT, SUT_NT, MUT_NT, DEC=D
FILEO MATO[3] = "C:\projects\Roanoke\Base\Output\CV_2012_PM.MAT",
 MO=31-33, NAME=CV_PM, SUT_PM, MUT_PM, DEC=D
FILEO MATO[2] = "C:\projects\Roanoke\Base\Output\CV_2012_MD.MAT",
 MO=21-23, NAME=CV_MD, SUT_MD, MUT_MD, DEC=D
FILEO MATO[1] = "C:\projects\Roanoke\Base\Output\CV_2012_AM.MAT",
 MO=11-13, NAME=CV_AM, SUT_AM, MUT_AM, DEC=D
FILEI MATI[1] = "C:\projects\Roanoke\Base\Output\CV_2012.MAT"

ZONES=267

;Define array of time of day factors
;Note that time of day factors for CV trips are the same for PA as AP trips.
;  So rather than apply a PA TOD and an AP TOD and then recombining the table
;  by time period we can simply apply double the PA (or AP)TOD rate.

ARRAY TODFct=4
TODFct[1] = 0.0458 * 2  ;AM Factor
TODFct[2] = 0.1652 * 2  ;MD Factor
TODFct[3] = 0.1634 * 2  ;PM Factor
TODFct[4] = 0.1256 * 2  ;NT Factor

MW[1]=mi.1.1      ;CV  Daily Trips
MW[2]=mi.1.2      ;SUT Daily Trips
MW[3]=mi.1.3      ;MUT Daily Trips

LOOP TOD=1,4
  LOOP CVType=1,3
     TODTable = (10*TOD)+ CVType
    MW[TODTable] = MW[CVType] * TODFct[TOD]
  ENDLOOP
ENDLOOP

MATRIX Stack Size = 1426 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\Output\CV_2012.MAT Opened
MAT PGM=DISTRIBUTION (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:55 2016 
ID=
PAR Zones=267 M=3
  FourTire  SixTire  Combo

M(792): ARRAY TODFCT requires 40 bytes.Page 563  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 32,814.354     @J=I:     24.36519
	MI.01.002: 24,747.91      @J=I:     26.36   
	MI.01.003:  5,295.36   
	MW[1]    : 32,814.354     @J=I:     24.36519
	MW[2]    : 24,747.91      @J=I:     26.36   
	MW[3]    :  5,295.36   
	MW[11]   :  3,005.79483   @J=I:      2.23185
	MW[12]   :  2,266.90856   @J=I:      2.41458
	MW[13]   :    485.05498
	MW[21]   : 10,841.86256   @J=I:      8.05026
	MW[22]   :  8,176.70946   @J=I:      8.70934
	MW[23]   :  1,749.58694
	MW[31]   : 10,723.73089   @J=I:      7.96254
	MW[32]   :  8,087.61699   @J=I:      8.61445
	MW[33]   :  1,730.52365
	MW[41]   :  8,242.96572   @J=I:      6.12053
	MW[42]   :  6,216.67499   @J=I:      6.62163
	MW[43]   :  1,330.19443
	MO.04.001:  8,242.96572
	MO.04.002:  6,248.35   
	MO.04.003:  1,340.83   
	MO.03.001: 10,723.73089
	MO.03.002:  8,099.04   
	MO.03.003:  1,731.2    
	MO.02.001: 10,841.86256
	MO.02.002:  8,190.12   
	MO.02.003:  1,749.51   
	MO.01.001:  3,005.79483
	MO.01.002:  2,261.98   
	MO.01.003:    477.86   

Variable Values at end of Iteration 1 I loop:

    TOD     :  5
    CVTYPE  :  4
    TODTABLE: 43

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\CV_TLFD.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:57 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 575  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:57 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\pk_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\PK_FreeFlow_Skim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1332 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\PK_FreeFlow_Skim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Tue Mar 29 14:11:44 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 576  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,627,483.52   @J=I:     23,000,116.87
	MI.01.002: 22,402,469,244.49
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,837,101.52   @J=I:     23,000,794.87
	MW[1]    : 22,425,627,483.52   @J=I:     23,000,116.87
	MW[2]    : 22,402,469,244.49
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,837,101.52   @J=I:     23,000,794.87
	MW[11]   :        627,483.52   @J=I:            116.87
	MW[12]   :        469,244.49
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        772,901.52   @J=I:            784.87
	MO.01.001:        627,483.52
	MO.01.002:        469,244.49
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        772,901.52

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 577  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:57 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_FreeFlow_Skim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1332 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\OP_FreeFlow_Skim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Tue Mar 29 14:11:44 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 578  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,627,483.52   @J=I:     23,000,116.87
	MI.01.002: 22,402,469,244.49
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,837,101.52   @J=I:     23,000,794.87
	MW[1]    : 22,425,627,483.52   @J=I:     23,000,116.87
	MW[2]    : 22,402,469,244.49
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,837,101.52   @J=I:     23,000,794.87
	MW[11]   :        627,483.52   @J=I:            116.87
	MW[12]   :        469,244.49
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        772,901.52   @J=I:            784.87
	MO.01.001:        627,483.52
	MO.01.002:        469,244.49
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        772,901.52

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBW_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:57 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBO_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:58 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\NHB_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:11:59 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBSC_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:00 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\TDMAT00C.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:01 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\HBSC_distribution.PRN. 
DISTRIBUTION (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:01 2016
DISTRIBUTION ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_D2D_Flwos.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:02 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_noSchoolTrips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:02 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\PARAMS\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:02 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 638  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 639  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 640  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:57 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:57 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 641  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,651.9128   @J=I:         44.308 
	MI.02.DISTANCE:    469,244.49  
	MW[1]         :    -27,651.9128   @J=I:         44.308 
	MW[2]         :    461,845.9   
	MW[100]       :    232,689.9189   @J=I:      1,307.0242
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,066.1162
	MW[115]       :     -6,834.6518
	MW[116]       :              --
	MW[200]       :    117,677.504    @J=I:      3,338.8154
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,338.81545

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 642  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:02 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:12:02 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,999, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 643  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,338.8
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,338.8
	MW[1]      :    117,677.5   @J=I:      3,338.8
	MW[2]      :    117,677.5   @J=I:      3,338.8
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_1.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:03 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 644  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 645  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 646  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:57 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:57 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 647  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,651.9128   @J=I:         44.308 
	MI.02.DISTANCE:    469,244.49  
	MW[1]         :    -27,651.9128   @J=I:         44.308 
	MW[2]         :    461,845.9   
	MW[100]       :    239,316.8589   @J=I:      1,331.8442
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,066.1162
	MW[115]       :     -6,834.6518
	MW[116]       :      6,626.94     @J=I:         24.82  
	MW[200]       :    117,677.504    @J=I:      3,409.7188
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,409.71882

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 648  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:03 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:12:03 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,217, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 649  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,409.7
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,409.7
	MW[1]      :    117,677.5   @J=I:      3,409.7
	MW[2]      :    117,677.5   @J=I:      3,409.7
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_2.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:03 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 650  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 651  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 652  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:57 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:57 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 653  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,651.9128   @J=I:         44.308 
	MI.02.DISTANCE:    469,244.49  
	MW[1]         :    -27,651.9128   @J=I:         44.308 
	MW[2]         :    461,845.9   
	MW[100]       :    245,946.4689   @J=I:      1,356.6742
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,066.1162
	MW[115]       :     -6,834.6518
	MW[116]       :     13,256.55     @J=I:         49.65  
	MW[200]       :    117,677.504    @J=I:      3,458.1568
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,458.15682

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 654  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:04 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:12:03 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,378, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 655  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,458.2
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,458.2
	MW[1]      :    117,677.5   @J=I:      3,458.2
	MW[2]      :    117,677.5   @J=I:      3,458.2
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_3.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:04 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 656  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 657  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 658  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:57 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:57 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 659  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,651.9128   @J=I:         44.308 
	MI.02.DISTANCE:    469,244.49  
	MW[1]         :    -27,651.9128   @J=I:         44.308 
	MW[2]         :    461,845.9   
	MW[100]       :    252,501.3189   @J=I:      1,381.2242
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,066.1162
	MW[115]       :     -6,834.6518
	MW[116]       :     19,811.4      @J=I:         74.2   
	MW[200]       :    117,677.504    @J=I:      3,490.2554
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,490.25538

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 660  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:04 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:12:04 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,471, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 661  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,490.3
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,490.3
	MW[1]      :    117,677.5   @J=I:      3,490.3
	MW[2]      :    117,677.5   @J=I:      3,490.3
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_4.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:04 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 662  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 663  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 664  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:57 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:57 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 665  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,651.9128   @J=I:         44.308 
	MI.02.DISTANCE:    469,244.49  
	MW[1]         :    -27,651.9128   @J=I:         44.308 
	MW[2]         :    461,845.9   
	MW[100]       :    259,165.6389   @J=I:      1,406.1842
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,066.1162
	MW[115]       :     -6,834.6518
	MW[116]       :     26,475.72     @J=I:         99.16  
	MW[200]       :    117,677.504    @J=I:      3,510.3516
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,510.35155

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 666  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:05 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:12:04 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,512, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 667  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,510.4
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,510.4
	MW[1]      :    117,677.5   @J=I:      3,510.4
	MW[2]      :    117,677.5   @J=I:      3,510.4
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_5.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:05 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 668  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 669  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 670  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:57 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:57 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 671  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,651.9128   @J=I:         44.308 
	MI.02.DISTANCE:    469,244.49  
	MW[1]         :    -27,651.9128   @J=I:         44.308 
	MW[2]         :    461,845.9   
	MW[100]       :    265,837.9689   @J=I:      1,431.1742
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,066.1162
	MW[115]       :     -6,834.6518
	MW[116]       :     33,148.05     @J=I:        124.15  
	MW[200]       :    117,677.504    @J=I:      3,519.8682
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,519.86819

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 672  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:05 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:12:05 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,551, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 673  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,519.9
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,519.9
	MW[1]      :    117,677.5   @J=I:      3,519.9
	MW[2]      :    117,677.5   @J=I:      3,519.9
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_6.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:05 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 674  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 675  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 676  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:57 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:57 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 677  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,651.9128   @J=I:         44.308 
	MI.02.DISTANCE:    469,244.49  
	MW[1]         :    -27,651.9128   @J=I:         44.308 
	MW[2]         :    461,845.9   
	MW[100]       :    272,601.0789   @J=I:      1,456.5042
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,066.1162
	MW[115]       :     -6,834.6518
	MW[116]       :     39,911.16     @J=I:        149.48  
	MW[200]       :    117,677.504    @J=I:      3,528.7905
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,528.79047

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 678  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:06 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:12:05 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,578, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 679  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,528.8
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,528.8
	MW[1]      :    117,677.5   @J=I:      3,528.8
	MW[2]      :    117,677.5   @J=I:      3,528.8
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_7.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:06 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 680  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 681  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 682  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:57 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:57 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 683  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,651.9128   @J=I:         44.308 
	MI.02.DISTANCE:    469,244.49  
	MW[1]         :    -27,651.9128   @J=I:         44.308 
	MW[2]         :    461,845.9   
	MW[100]       :    279,329.4789   @J=I:      1,481.7042
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,066.1162
	MW[115]       :     -6,834.6518
	MW[116]       :     46,639.56     @J=I:        174.68  
	MW[200]       :    117,677.504    @J=I:      3,532.5406
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,532.54057

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 684  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:06 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:12:06 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,606, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 685  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,532.5
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,532.5
	MW[1]      :    117,677.5   @J=I:      3,532.5
	MW[2]      :    117,677.5   @J=I:      3,532.5
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_8.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:06 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 686  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 687  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 688  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:57 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:57 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 689  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,651.9128   @J=I:         44.308 
	MI.02.DISTANCE:    469,244.49  
	MW[1]         :    -27,651.9128   @J=I:         44.308 
	MW[2]         :    461,845.9   
	MW[100]       :    286,071.2289   @J=I:      1,506.9542
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,066.1162
	MW[115]       :     -6,834.6518
	MW[116]       :     53,381.31     @J=I:        199.93  
	MW[200]       :    117,677.504    @J=I:      3,535.5648
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,535.56478

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 690  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:07 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:12:06 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,612, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 691  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,535.6
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,535.6
	MW[1]      :    117,677.5   @J=I:      3,535.6
	MW[2]      :    117,677.5   @J=I:      3,535.6
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_9.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:07 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 692  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 693  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 694  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:57 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:57 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 695  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -27,651.9128   @J=I:         44.308 
	MI.02.DISTANCE:    469,244.49  
	MW[1]         :    -27,651.9128   @J=I:         44.308 
	MW[2]         :    461,845.9   
	MW[100]       :    292,983.8589   @J=I:      1,532.8442
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,066.1162
	MW[115]       :     -6,834.6518
	MW[116]       :     60,293.94     @J=I:        225.82  
	MW[200]       :    117,677.504    @J=I:      3,536.0161
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,536.01609

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 696  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:07 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:12:07 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,636, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 697  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,536  
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,536  
	MW[1]      :    117,677.5   @J=I:      3,536  
	MW[2]      :    117,677.5   @J=I:      3,536  
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_10.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBO.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:07 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:08 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:08 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:08 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBSH.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:08 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:08 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:08 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:08 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_NHB.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:09 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:09 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:09 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:09 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_tlfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:09 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_ttfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:09 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_d2d_flows.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:09 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 742  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:09 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT",
 MO = 1, NAME = HBO_HBSH
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT"

MW[1] = MI.1.1 + MI.2.1


MATRIX Stack Size = 344 bytes.
................................................................................


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:12:08 2016 
ID=
PAR Zones=267 M=1
  HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:12:07 2016 
ID=
PAR Zones=267 M=1
  HBO

Totals after Iteration 1 I loop:

	MI.02.001: 136,095   @J=I:  17,487
	MI.01.001: 264,074   @J=I:  49,397
	MW[1]    : 400,170   @J=I:  66,884
	MO.01.001: 400,173

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 743  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:09 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 744  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2804 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:12:07 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:57 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 745  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 117,677.504    @J=I:   3,536.0161
	MI.01.001:  58,636.6198   @J=I:     182.5073
	MI.01.002:   5,644.9391   @J=I:      17.5699
	MI.01.003:   1,027.6561
	MI.01.004:           --
	MI.01.005:   5,979.7851   @J=I:      66.9228
	MI.01.006:  59,539.5905   @J=I:     182.5073
	MI.01.007:   5,731.868    @J=I:      17.5699
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   6,017.5415   @J=I:      66.9228
	MW[1]    : 117,677.504    @J=I:   3,536.0161
	MW[2]    :  36,629.6495   @J=I:   1,230.8239
	MW[3]    :  81,047.8545   @J=I:   2,305.1922
	MW[11]   :  58,636.6198   @J=I:     182.5073
	MW[12]   :   5,644.9391   @J=I:      17.5699
	MW[13]   :   1,027.6561
	MW[14]   :           --
	MW[15]   :   5,979.7851   @J=I:      66.9228
	MW[16]   :  59,539.5905   @J=I:     182.5073
	MW[17]   :   5,731.868    @J=I:      17.5699
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   6,017.5415   @J=I:      66.9228
	MW[21]   : 103,056.7465   @J=I:   2,400.4567
	MW[22]   :   9,921.2585   @J=I:     231.0916
	MW[23]   :   3,031.7507
	MW[24]   :           --
	MW[25]   :   1,667.7483   @J=I:     904.4678
	MO.01.001: 103,060.62  
	MO.01.002:   9,920.48  
	MO.01.003:   3,030.58  
	MO.01.005:   1,662.59  

Variable Values at end of Iteration 1 I loop:

    EDA: 103,056.7
    ESR:   9,921.3
    ELB:   3,031.8
    ENM:   1,667.7
    TRN:   3,031.8
    AUT: 112,978  
    TOT: 117,677.5

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################
Page 746  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:10 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 747  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2808 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:12:09 2016 
ID=
PAR Zones=267 M=1
  HBO_HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:58 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 748  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 400,173.06     @J=I:  66,883.92  
	MI.01.001:  30,690.7729   @J=I:      85.8268
	MI.01.002:  31,714.1215   @J=I:      88.6886
	MI.01.003:     212.0584
	MI.01.004:           --
	MI.01.005:   8,672.0472   @J=I:      92.4847
	MI.01.006:  30,787.8761   @J=I:      85.8268
	MI.01.007:  31,814.4624   @J=I:      88.6886
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   8,686.6615   @J=I:      92.4847
	MW[1]    : 400,173.06     @J=I:  66,883.92  
	MW[2]    : 151,714.1816   @J=I:  23,995.5098
	MW[3]    : 248,458.8784   @J=I:  42,888.4102
	MW[11]   :  30,690.7729   @J=I:      85.8268
	MW[12]   :  31,714.1215   @J=I:      88.6886
	MW[13]   :     212.0584
	MW[14]   :           --
	MW[15]   :   8,672.0472   @J=I:      92.4847
	MW[16]   :  30,787.8761   @J=I:      85.8268
	MW[17]   :  31,814.4624   @J=I:      88.6886
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   8,686.6615   @J=I:      92.4847
	MW[21]   : 176,521.0557   @J=I:  21,419.0974
	MW[22]   : 182,406.9472   @J=I:  22,133.2925
	MW[23]   :   2,074.3279
	MW[24]   :           --
	MW[25]   :  39,170.7292   @J=I:  23,331.5301
	MO.01.001: 176,515.4   
	MO.01.002: 182,419.07  
	MO.01.003:   2,073.87  
	MO.01.005:  39,165.48  

Variable Values at end of Iteration 1 I loop:

    EDA: 176,521.1
    ESR: 182,406.9
    ELB:   2,074.3
    ENM:  39,170.7
    TRN:   2,074.3
    AUT: 358,928  
    TOT: 400,173.1

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 749  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:10 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 750  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2804 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:12:09 2016 
ID=
PAR Zones=267 M=1
  NHB

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:11:59 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 751  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 315,086.909    @J=I:  43,867.2854
	MI.01.001:  33,539.0853   @J=I:     102.3607
	MI.01.002:  31,359.3192   @J=I:      95.7081
	MI.01.003:     115.084 
	MI.01.004:           --
	MI.01.005:   6,275.5115   @J=I:      68.9313
	MI.01.006:  33,595.6733   @J=I:     102.3607
	MI.01.007:  31,412.2294   @J=I:      95.7081
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   6,281.0973   @J=I:      68.9313
	MW[1]    : 315,086.909    @J=I:  43,867.2854
	MW[2]    : 118,047.8806   @J=I:  17,425.743 
	MW[3]    : 197,039.0284   @J=I:  26,441.5424
	MW[11]   :  33,539.0853   @J=I:     102.3607
	MW[12]   :  31,359.3192   @J=I:      95.7081
	MW[13]   :     115.084 
	MW[14]   :           --
	MW[15]   :   6,275.5115   @J=I:      68.9313
	MW[16]   :  33,595.6733   @J=I:     102.3607
	MW[17]   :  31,412.2294   @J=I:      95.7081
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   6,281.0973   @J=I:      68.9313
	MW[21]   : 154,343.2133   @J=I:  16,732.1118
	MW[22]   : 144,312.1671   @J=I:  15,644.6614
	MW[23]   :     854.5671
	MW[24]   :           --
	MW[25]   :  15,576.9615   @J=I:  11,490.5122
	MO.01.001: 154,347.52  
	MO.01.002: 144,315.2   
	MO.01.003:     852.09  
	MO.01.005:  15,571.02  

Variable Values at end of Iteration 1 I loop:

    EDA: 154,343.213
    ESR: 144,312.167
    ELB:     854.567
    ENM:  15,576.961
    TRN:     854.567
    AUT: 298,655.38 
    TOT: 315,086.909

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################
Page 752  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:11 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 753  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2822 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:12:02 2016 
ID=
PAR Zones=267 M=1
  HBSC

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:12:00 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 754  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001:  7,669.87     @J=I:    991.53  
	MI.01.001: 33,539.0853   @J=I:    102.3607
	MI.01.002: 31,359.3192   @J=I:     95.7081
	MI.01.003:    115.084 
	MI.01.004:          --
	MI.01.005:  6,275.5115   @J=I:     68.9313
	MI.01.006: 33,595.6733   @J=I:    102.3607
	MI.01.007: 31,412.2294   @J=I:     95.7081
	MI.01.008:          --
	MI.01.009:          --
	MI.01.010:  6,281.0973   @J=I:     68.9313
	MW[1]    :  7,669.87     @J=I:    991.53  
	MW[2]    :  2,607.1271   @J=I:    301.7739
	MW[3]    :  5,062.7429   @J=I:    689.7561
	MW[11]   : 33,539.0853   @J=I:    102.3607
	MW[12]   : 31,359.3192   @J=I:     95.7081
	MW[13]   :    115.084 
	MW[14]   :          --
	MW[15]   :  6,275.5115   @J=I:     68.9313
	MW[16]   : 33,595.6733   @J=I:    102.3607
	MW[17]   : 31,412.2294   @J=I:     95.7081
	MW[18]   :          --
	MW[19]   :          --
	MW[20]   :  6,281.0973   @J=I:     68.9313
	MW[21]   :  3,601.3134   @J=I:    379.928 
	MW[22]   :  3,367.2575   @J=I:    355.2357
	MW[23]   :     25.0416
	MW[24]   :          --
	MW[25]   :    676.2575   @J=I:    256.3663
	MO.01.001:  3,609.8   
	MO.01.002:  3,359.74  
	MO.01.003:     23.88  
	MO.01.005:    675.39  

Variable Values at end of Iteration 1 I loop:

    EDA: 3,601.3134
    ESR: 3,367.2575
    ELB:    25.0416
    ENM:   676.2575
    TRN:    25.0416
    AUT: 6,968.5708
    TOT: 7,669.87  

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_AM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:11 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_MD.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:11 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_PM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:12 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_NT.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:12 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\MC_Transit_Trips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:12 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:12 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\AM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:13 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:20
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:33 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\MD.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:12:34 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:27
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:01 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:02 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:29
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:31 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\NT.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:31 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:08
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Merge_Hwy_Assignments.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:39 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Hwy_eval.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:39 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PBHWY00B.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:39 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\PBHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:40 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\Output\PK_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\PK_HWYSKIM_1.MAT
M(100): COPY C:\projects\Roanoke\Base\Output\OP_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\OP_HWYSKIM_1.MATPage 862  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:40 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\pk_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\PK_CNG_HwySkim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1330 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\PK_CNG_HwySkim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Tue Mar 29 14:13:39 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 863  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,657,841.6    @J=I:     23,000,118.97
	MI.01.002: 22,402,474,686.07
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,867,459.6    @J=I:     23,000,796.97
	MW[1]    : 22,425,657,841.6    @J=I:     23,000,118.97
	MW[2]    : 22,402,474,686.07
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,867,459.6    @J=I:     23,000,796.97
	MW[11]   :        657,841.6    @J=I:            118.97
	MW[12]   :        474,686.07
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        803,259.6    @J=I:            786.97
	MO.01.001:        657,841.6 
	MO.01.002:        474,686.07
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        803,259.6 

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 864  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:40 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_CNG_HwySkim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1330 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\OP_CNG_HwySkim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Tue Mar 29 14:13:40 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 865  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,685,932.9    @J=I:     23,000,119.89
	MI.01.002: 22,402,470,277.35
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,895,550.9    @J=I:     23,000,797.89
	MW[1]    : 22,425,685,932.9    @J=I:     23,000,119.89
	MW[2]    : 22,402,470,277.35
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,895,550.9    @J=I:     23,000,797.89
	MW[11]   :        685,932.9    @J=I:            119.89
	MW[12]   :        470,277.35
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        831,350.9    @J=I:            787.89
	MO.01.001:        685,932.9 
	MO.01.002:        470,277.35
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        831,350.9 

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBW_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:41 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBO_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:42 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\NHB_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:43 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBSC_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:44 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\TDMAT00C.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:45 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\HBSC_distribution.PRN. 
DISTRIBUTION (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:45 2016
DISTRIBUTION ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_D2D_Flwos.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:46 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_noSchoolTrips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:46 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\PARAMS\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:46 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 930  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 931  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 932  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:41 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:40 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 933  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,515.7079   @J=I:         44.2691
	MI.02.DISTANCE:    474,686.07  
	MW[1]         :    -28,515.7079   @J=I:         44.2691
	MW[2]         :    467,054.73  
	MW[100]       :    231,460.7507   @J=I:      1,307.0018
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,496.2525
	MW[115]       :     -6,872.2117
	MW[116]       :              --
	MW[200]       :    117,677.504    @J=I:      3,408.5594
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,408.55945

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 934  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:46 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:46 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,912, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 935  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,408.6
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,408.6
	MW[1]      :    117,677.5   @J=I:      3,408.6
	MW[2]      :    117,677.5   @J=I:      3,408.6
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_1.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:46 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 936  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 937  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 938  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:41 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:40 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 939  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,515.7079   @J=I:         44.2691
	MI.02.DISTANCE:    474,686.07  
	MW[1]         :    -28,515.7079   @J=I:         44.2691
	MW[2]         :    467,054.73  
	MW[100]       :    238,357.3607   @J=I:      1,332.8318
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,496.2525
	MW[115]       :     -6,872.2117
	MW[116]       :      6,896.61     @J=I:         25.83  
	MW[200]       :    117,677.504    @J=I:      3,476.4072
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,476.40724

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 940  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:47 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:46 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,194, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 941  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,476.4
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,476.4
	MW[1]      :    117,677.5   @J=I:      3,476.4
	MW[2]      :    117,677.5   @J=I:      3,476.4
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_2.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:47 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 942  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 943  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 944  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:41 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:40 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 945  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,515.7079   @J=I:         44.2691
	MI.02.DISTANCE:    474,686.07  
	MW[1]         :    -28,515.7079   @J=I:         44.2691
	MW[2]         :    467,054.73  
	MW[100]       :    245,141.8307   @J=I:      1,358.2418
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,496.2525
	MW[115]       :     -6,872.2117
	MW[116]       :     13,681.08     @J=I:         51.24  
	MW[200]       :    117,677.504    @J=I:      3,521.005 
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,521.00497

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 946  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:47 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:47 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,377, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 947  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,521  
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,521  
	MW[1]      :    117,677.5   @J=I:      3,521  
	MW[2]      :    117,677.5   @J=I:      3,521  
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_3.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:47 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 948  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 949  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 950  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:41 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:40 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 951  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,515.7079   @J=I:         44.2691
	MI.02.DISTANCE:    474,686.07  
	MW[1]         :    -28,515.7079   @J=I:         44.2691
	MW[2]         :    467,054.73  
	MW[100]       :    252,011.7407   @J=I:      1,383.9718
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,496.2525
	MW[115]       :     -6,872.2117
	MW[116]       :     20,550.99     @J=I:         76.97  
	MW[200]       :    117,677.504    @J=I:      3,549.0072
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,549.00716

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 952  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:48 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:47 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,470, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 953  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,549  
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,549  
	MW[1]      :    117,677.5   @J=I:      3,549  
	MW[2]      :    117,677.5   @J=I:      3,549  
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_4.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:48 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 954  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 955  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 956  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:41 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:40 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 957  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,515.7079   @J=I:         44.2691
	MI.02.DISTANCE:    474,686.07  
	MW[1]         :    -28,515.7079   @J=I:         44.2691
	MW[2]         :    467,054.73  
	MW[100]       :    258,833.5907   @J=I:      1,409.5218
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,496.2525
	MW[115]       :     -6,872.2117
	MW[116]       :     27,372.84     @J=I:        102.52  
	MW[200]       :    117,677.504    @J=I:      3,568.5095
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,568.50947

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 958  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:48 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:48 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,523, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 959  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,568.5
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,568.5
	MW[1]      :    117,677.5   @J=I:      3,568.5
	MW[2]      :    117,677.5   @J=I:      3,568.5
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_5.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:48 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 960  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 961  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 962  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:41 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:40 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 963  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,515.7079   @J=I:         44.2691
	MI.02.DISTANCE:    474,686.07  
	MW[1]         :    -28,515.7079   @J=I:         44.2691
	MW[2]         :    467,054.73  
	MW[100]       :    265,516.6007   @J=I:      1,434.5518
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,496.2525
	MW[115]       :     -6,872.2117
	MW[116]       :     34,055.85     @J=I:        127.55  
	MW[200]       :    117,677.504    @J=I:      3,578.7246
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,578.72462

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 964  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:49 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:48 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,563, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 965  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,578.7
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,578.7
	MW[1]      :    117,677.5   @J=I:      3,578.7
	MW[2]      :    117,677.5   @J=I:      3,578.7
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_6.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:49 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 966  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 967  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 968  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:41 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:40 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 969  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,515.7079   @J=I:         44.2691
	MI.02.DISTANCE:    474,686.07  
	MW[1]         :    -28,515.7079   @J=I:         44.2691
	MW[2]         :    467,054.73  
	MW[100]       :    272,271.7007   @J=I:      1,459.8518
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,496.2525
	MW[115]       :     -6,872.2117
	MW[116]       :     40,810.95     @J=I:        152.85  
	MW[200]       :    117,677.504    @J=I:      3,586.5318
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,586.53182

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 970  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:49 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:49 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,603, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 971  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,586.5
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,586.5
	MW[1]      :    117,677.5   @J=I:      3,586.5
	MW[2]      :    117,677.5   @J=I:      3,586.5
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_7.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:49 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 972  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 973  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 974  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:41 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:40 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 975  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,515.7079   @J=I:         44.2691
	MI.02.DISTANCE:    474,686.07  
	MW[1]         :    -28,515.7079   @J=I:         44.2691
	MW[2]         :    467,054.73  
	MW[100]       :    278,992.0907   @J=I:      1,485.0218
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,496.2525
	MW[115]       :     -6,872.2117
	MW[116]       :     47,531.34     @J=I:        178.02  
	MW[200]       :    117,677.504    @J=I:      3,589.6157
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,589.61575

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 976  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:50 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:49 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,597, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 977  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,589.6
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,589.6
	MW[1]      :    117,677.5   @J=I:      3,589.6
	MW[2]      :    117,677.5   @J=I:      3,589.6
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_8.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:50 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 978  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 979  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 980  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:41 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:40 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 981  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,515.7079   @J=I:         44.2691
	MI.02.DISTANCE:    474,686.07  
	MW[1]         :    -28,515.7079   @J=I:         44.2691
	MW[2]         :    467,054.73  
	MW[100]       :    285,875.3507   @J=I:      1,510.8018
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,496.2525
	MW[115]       :     -6,872.2117
	MW[116]       :     54,414.6      @J=I:        203.8   
	MW[200]       :    117,677.504    @J=I:      3,594.1612
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,594.16121

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 982  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:50 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:50 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,603, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 983  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,594.2
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,594.2
	MW[1]      :    117,677.5   @J=I:      3,594.2
	MW[2]      :    117,677.5   @J=I:      3,594.2
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_9.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:50 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 984  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 985  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 986  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:41 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:40 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 987  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,515.7079   @J=I:         44.2691
	MI.02.DISTANCE:    474,686.07  
	MW[1]         :    -28,515.7079   @J=I:         44.2691
	MW[2]         :    467,054.73  
	MW[100]       :    292,595.7407   @J=I:      1,535.9718
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,496.2525
	MW[115]       :     -6,872.2117
	MW[116]       :     61,134.99     @J=I:        228.97  
	MW[200]       :    117,677.504    @J=I:      3,593.319 
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,593.31895

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 988  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:51 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:50 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,581, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 989  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,593.3
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,593.3
	MW[1]      :    117,677.5   @J=I:      3,593.3
	MW[2]      :    117,677.5   @J=I:      3,593.3
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_10.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBO.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:51 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:51 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:51 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:52 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBSH.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:52 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:52 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:52 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:52 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_NHB.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:52 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:53 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:53 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:53 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_tlfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:53 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_ttfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:53 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_d2d_flows.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:53 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 34  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:53 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT",
 MO = 1, NAME = HBO_HBSH
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT"

MW[1] = MI.1.1 + MI.2.1


MATRIX Stack Size = 344 bytes.
................................................................................


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:52 2016 
ID=
PAR Zones=267 M=1
  HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:51 2016 
ID=
PAR Zones=267 M=1
  HBO

Totals after Iteration 1 I loop:

	MI.02.001: 136,095   @J=I:  17,513
	MI.01.001: 264,074   @J=I:  49,437
	MW[1]    : 400,170   @J=I:  66,950
	MO.01.001: 400,174

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 35  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:53 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 36  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------

MATRIX Stack Size = 2804 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:50 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:41 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 37  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 117,677.504    @J=I:   3,593.319 
	MI.01.001:  58,625.4559   @J=I:     182.4981
	MI.01.002:   5,643.8644   @J=I:      17.5691
	MI.01.003:   1,038.2592
	MI.01.004:           --
	MI.01.005:   5,981.4205   @J=I:      66.9328
	MI.01.006:  59,537.8322   @J=I:     182.4981
	MI.01.007:   5,731.6987   @J=I:      17.5691
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   6,019.4691   @J=I:      66.9328
	MW[1]    : 117,677.504    @J=I:   3,593.319 
	MW[2]    :  36,767.7701   @J=I:   1,265.7499
	MW[3]    :  80,909.7339   @J=I:   2,327.569 
	MW[11]   :  58,625.4559   @J=I:     182.4981
	MW[12]   :   5,643.8644   @J=I:      17.5691
	MW[13]   :   1,038.2592
	MW[14]   :           --
	MW[15]   :   5,981.4205   @J=I:      66.9328
	MW[16]   :  59,537.8322   @J=I:     182.4981
	MW[17]   :   5,731.6987   @J=I:      17.5691
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   6,019.4691   @J=I:      66.9328
	MW[21]   : 102,963.8537   @J=I:   2,439.3462
	MW[22]   :   9,912.3157   @J=I:     234.8355
	MW[23]   :   3,097.7293
	MW[24]   :           --
	MW[25]   :   1,703.6053   @J=I:     919.1372
	MO.01.001: 102,967.2   
	MO.01.002:   9,911.61  
	MO.01.003:   3,096.94  
	MO.01.005:   1,698.53  

Variable Values at end of Iteration 1 I loop:

    EDA: 102,963.9
    ESR:   9,912.3
    ELB:   3,097.7
    ENM:   1,703.6
    TRN:   3,097.7
    AUT: 112,876.2
    TOT: 117,677.5

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################
Page 38  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:54 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 39  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------

MATRIX Stack Size = 2808 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:53 2016 
ID=
PAR Zones=267 M=1
  HBO_HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:42 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 40  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 400,173.92     @J=I:  66,950.37  
	MI.01.001:  30,685.5645   @J=I:      85.8217
	MI.01.002:  31,708.7393   @J=I:      88.6833
	MI.01.003:     214.4658
	MI.01.004:           --
	MI.01.005:   8,680.2304   @J=I:      92.495 
	MI.01.006:  30,783.7766   @J=I:      85.8217
	MI.01.007:  31,810.2262   @J=I:      88.6833
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   8,694.9971   @J=I:      92.495 
	MW[1]    : 400,173.92     @J=I:  66,950.37  
	MW[2]    : 151,551.7299   @J=I:  24,056.0725
	MW[3]    : 248,622.1901   @J=I:  42,894.2975
	MW[11]   :  30,685.5645   @J=I:      85.8217
	MW[12]   :  31,708.7393   @J=I:      88.6833
	MW[13]   :     214.4658
	MW[14]   :           --
	MW[15]   :   8,680.2304   @J=I:      92.495 
	MW[16]   :  30,783.7766   @J=I:      85.8217
	MW[17]   :  31,810.2262   @J=I:      88.6833
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   8,694.9971   @J=I:      92.495 
	MW[21]   : 176,376.5725   @J=I:  21,439.8017
	MW[22]   : 182,257.6464   @J=I:  22,154.6873
	MW[23]   :   2,094.1699
	MW[24]   :           --
	MW[25]   :  39,445.5312   @J=I:  23,355.881 
	MO.01.001: 176,370.47  
	MO.01.002: 182,269.73  
	MO.01.003:   2,093     
	MO.01.005:  39,439.92  

Variable Values at end of Iteration 1 I loop:

    EDA: 176,376.6
    ESR: 182,257.6
    ELB:   2,094.2
    ENM:  39,445.5
    TRN:   2,094.2
    AUT: 358,634.2
    TOT: 400,173.9

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 41  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:54 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 42  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------

MATRIX Stack Size = 2804 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:52 2016 
ID=
PAR Zones=267 M=1
  NHB

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:43 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 43  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 315,086.909    @J=I:  44,222.7304
	MI.01.001:  33,536.1381   @J=I:     102.3546
	MI.01.002:  31,356.5635   @J=I:      95.7024
	MI.01.003:     116.619 
	MI.01.004:           --
	MI.01.005:   6,279.6795   @J=I:      68.9429
	MI.01.006:  33,593.4885   @J=I:     102.3546
	MI.01.007:  31,410.1866   @J=I:      95.7024
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   6,285.3248   @J=I:      68.9429
	MW[1]    : 315,086.909    @J=I:  44,222.7304
	MW[2]    : 118,055.833    @J=I:  17,578.2807
	MW[3]    : 197,031.076    @J=I:  26,644.4497
	MW[11]   :  33,536.1381   @J=I:     102.3546
	MW[12]   :  31,356.5635   @J=I:      95.7024
	MW[13]   :     116.619 
	MW[14]   :           --
	MW[15]   :   6,279.6795   @J=I:      68.9429
	MW[16]   :  33,593.4885   @J=I:     102.3546
	MW[17]   :  31,410.1866   @J=I:      95.7024
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   6,285.3248   @J=I:      68.9429
	MW[21]   : 154,232.5471   @J=I:  16,867.6032
	MW[22]   : 144,208.6933   @J=I:  15,771.347 
	MW[23]   :     868.5048
	MW[24]   :           --
	MW[25]   :  15,777.1638   @J=I:  11,583.7802
	MO.01.001: 154,235.92  
	MO.01.002: 144,211.9   
	MO.01.003:     865.62  
	MO.01.005:  15,770.92  

Variable Values at end of Iteration 1 I loop:

    EDA: 154,232.547
    ESR: 144,208.693
    ELB:     868.505
    ENM:  15,777.164
    TRN:     868.505
    AUT: 298,441.24 
    TOT: 315,086.909

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################
Page 44  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:55 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 45  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------

MATRIX Stack Size = 2822 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:46 2016 
ID=
PAR Zones=267 M=1
  HBSC

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:13:44 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 46  (VOYAGER MATRIX) 
Parsons Brinckerhoff
--------------------------

Totals after Iteration 1 I loop:

	MI.02.001:  7,669.56     @J=I:  1,032.13  
	MI.01.001: 33,536.1381   @J=I:    102.3546
	MI.01.002: 31,356.5635   @J=I:     95.7024
	MI.01.003:    116.619 
	MI.01.004:          --
	MI.01.005:  6,279.6795   @J=I:     68.9429
	MI.01.006: 33,593.4885   @J=I:    102.3546
	MI.01.007: 31,410.1866   @J=I:     95.7024
	MI.01.008:          --
	MI.01.009:          --
	MI.01.010:  6,285.3248   @J=I:     68.9429
	MW[1]    :  7,669.56     @J=I:  1,032.13  
	MW[2]    :  2,637.2875   @J=I:    335.1528
	MW[3]    :  5,032.2725   @J=I:    696.9772
	MW[11]   : 33,536.1381   @J=I:    102.3546
	MW[12]   : 31,356.5635   @J=I:     95.7024
	MW[13]   :    116.619 
	MW[14]   :          --
	MW[15]   :  6,279.6795   @J=I:     68.9429
	MW[16]   : 33,593.4885   @J=I:    102.3546
	MW[17]   : 31,410.1866   @J=I:     95.7024
	MW[18]   :          --
	MW[19]   :          --
	MW[20]   :  6,285.3248   @J=I:     68.9429
	MW[21]   :  3,585.6437   @J=I:    395.3219
	MW[22]   :  3,352.6062   @J=I:    369.6292
	MW[23]   :     25.9509
	MW[24]   :          --
	MW[25]   :    705.3592   @J=I:    267.1789
	MO.01.001:  3,593.5   
	MO.01.002:  3,345.07  
	MO.01.003:     24.91  
	MO.01.005:    704.43  

Variable Values at end of Iteration 1 I loop:

    EDA: 3,585.6437
    ESR: 3,352.6062
    ELB:    25.9509
    ENM:   705.3592
    TRN:    25.9509
    AUT: 6,938.25  
    TOT: 7,669.56  

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_AM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:55 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_MD.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:55 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_PM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:56 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_NT.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:56 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\MC_Transit_Trips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:56 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:56 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\AM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:13:57 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:20
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:14:17 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\MD.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:14:18 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:26
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:14:44 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:14:45 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:26
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:11 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\NT.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:11 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:07
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Merge_Hwy_Assignments.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:18 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Hwy_eval.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:18 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PBHWY00B.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:18 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\PBHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:19 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\Output\PK_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\PK_HWYSKIM_2.MAT
M(100): COPY C:\projects\Roanoke\Base\Output\OP_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\OP_HWYSKIM_2.MATPage 152  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:19 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\pk_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\PK_CNG_HwySkim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1330 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\PK_CNG_HwySkim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Tue Mar 29 14:15:18 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 153  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,657,151.22   @J=I:     23,000,118.93
	MI.01.002: 22,402,474,520.59
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,866,769.22   @J=I:     23,000,796.93
	MW[1]    : 22,425,657,151.22   @J=I:     23,000,118.93
	MW[2]    : 22,402,474,520.59
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,866,769.22   @J=I:     23,000,796.93
	MW[11]   :        657,151.22   @J=I:            118.93
	MW[12]   :        474,520.59
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        802,569.22   @J=I:            786.93
	MO.01.001:        657,151.22
	MO.01.002:        474,520.59
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        802,569.22

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 154  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:19 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_CNG_HwySkim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1330 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\OP_CNG_HwySkim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Tue Mar 29 14:15:19 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 155  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,684,942.61   @J=I:     23,000,119.88
	MI.01.002: 22,402,470,247.71
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,894,560.61   @J=I:     23,000,797.88
	MW[1]    : 22,425,684,942.61   @J=I:     23,000,119.88
	MW[2]    : 22,402,470,247.71
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,894,560.61   @J=I:     23,000,797.88
	MW[11]   :        684,942.61   @J=I:            119.88
	MW[12]   :        470,247.71
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        830,360.61   @J=I:            787.88
	MO.01.001:        684,942.61
	MO.01.002:        470,247.71
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        830,360.61

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBW_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:20 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBO_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:21 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\NHB_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:22 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBSC_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:23 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\TDMAT00C.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:24 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\HBSC_distribution.PRN. 
DISTRIBUTION (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:24 2016
DISTRIBUTION ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_D2D_Flwos.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:24 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_noSchoolTrips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:24 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################

M(100): COPY C:\projects\Roanoke\PARAMS\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:25 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 220  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 221  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 222  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:20 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:19 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 223  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,495.4287   @J=I:         44.2699
	MI.02.DISTANCE:    474,520.59  
	MW[1]         :    -28,495.4287   @J=I:         44.2699
	MW[2]         :    466,889.25  
	MW[100]       :    231,499.5601   @J=I:      1,307.0023
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,479.8548
	MW[115]       :     -6,870.3122
	MW[116]       :              --
	MW[200]       :    117,677.504    @J=I:      3,406.2259
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,406.22591

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 224  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:25 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:25 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,929, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 225  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,406.2
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,406.2
	MW[1]      :    117,677.5   @J=I:      3,406.2
	MW[2]      :    117,677.5   @J=I:      3,406.2
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_1.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:25 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 226  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 227  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 228  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:20 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:19 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 229  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,495.4287   @J=I:         44.2699
	MI.02.DISTANCE:    474,520.59  
	MW[1]         :    -28,495.4287   @J=I:         44.2699
	MW[2]         :    466,889.25  
	MW[100]       :    238,385.4901   @J=I:      1,332.7923
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,479.8548
	MW[115]       :     -6,870.3122
	MW[116]       :      6,885.93     @J=I:         25.79  
	MW[200]       :    117,677.504    @J=I:      3,474.2943
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,474.29426

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 230  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:25 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:25 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,218, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 231  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,474.3
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,474.3
	MW[1]      :    117,677.5   @J=I:      3,474.3
	MW[2]      :    117,677.5   @J=I:      3,474.3
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_2.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:26 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 232  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 233  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 234  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:20 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:19 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 235  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,495.4287   @J=I:         44.2699
	MI.02.DISTANCE:    474,520.59  
	MW[1]         :    -28,495.4287   @J=I:         44.2699
	MW[2]         :    466,889.25  
	MW[100]       :    245,164.6201   @J=I:      1,358.1823
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,479.8548
	MW[115]       :     -6,870.3122
	MW[116]       :     13,665.06     @J=I:         51.18  
	MW[200]       :    117,677.504    @J=I:      3,519.7392
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,519.73921

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 236  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:26 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:26 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,390, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 237  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,519.7
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,519.7
	MW[1]      :    117,677.5   @J=I:      3,519.7
	MW[2]      :    117,677.5   @J=I:      3,519.7
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_3.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:26 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 238  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 239  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 240  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:20 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:19 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 241  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,495.4287   @J=I:         44.2699
	MI.02.DISTANCE:    474,520.59  
	MW[1]         :    -28,495.4287   @J=I:         44.2699
	MW[2]         :    466,889.25  
	MW[100]       :    252,026.5201   @J=I:      1,383.8823
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,479.8548
	MW[115]       :     -6,870.3122
	MW[116]       :     20,526.96     @J=I:         76.88  
	MW[200]       :    117,677.504    @J=I:      3,549.0242
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,549.02419

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 242  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:26 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:26 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,484, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 243  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,549  
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,549  
	MW[1]      :    117,677.5   @J=I:      3,549  
	MW[2]      :    117,677.5   @J=I:      3,549  
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_4.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:27 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 244  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 245  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 246  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:20 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:19 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 247  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,495.4287   @J=I:         44.2699
	MI.02.DISTANCE:    474,520.59  
	MW[1]         :    -28,495.4287   @J=I:         44.2699
	MW[2]         :    466,889.25  
	MW[100]       :    258,829.6801   @J=I:      1,409.3623
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,479.8548
	MW[115]       :     -6,870.3122
	MW[116]       :     27,330.12     @J=I:        102.36  
	MW[200]       :    117,677.504    @J=I:      3,568.4182
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,568.41821

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 248  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:27 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:27 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,524, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 249  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,568.4
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,568.4
	MW[1]      :    117,677.5   @J=I:      3,568.4
	MW[2]      :    117,677.5   @J=I:      3,568.4
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_5.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:27 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 250  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 251  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 252  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:20 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:19 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 253  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,495.4287   @J=I:         44.2699
	MI.02.DISTANCE:    474,520.59  
	MW[1]         :    -28,495.4287   @J=I:         44.2699
	MW[2]         :    466,889.25  
	MW[100]       :    265,494.0001   @J=I:      1,434.3223
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,479.8548
	MW[115]       :     -6,870.3122
	MW[116]       :     33,994.44     @J=I:        127.32  
	MW[200]       :    117,677.504    @J=I:      3,577.9586
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,577.95864

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 254  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:27 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:27 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,585, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 255  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,578  
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,578  
	MW[1]      :    117,677.5   @J=I:      3,578  
	MW[2]      :    117,677.5   @J=I:      3,578  
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_6.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:28 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 256  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 257  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 258  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:20 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:19 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 259  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,495.4287   @J=I:         44.2699
	MI.02.DISTANCE:    474,520.59  
	MW[1]         :    -28,495.4287   @J=I:         44.2699
	MW[2]         :    466,889.25  
	MW[100]       :    272,249.1001   @J=I:      1,459.6223
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,479.8548
	MW[115]       :     -6,870.3122
	MW[116]       :     40,749.54     @J=I:        152.62  
	MW[200]       :    117,677.504    @J=I:      3,583.9103
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,583.91029

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 260  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:28 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:28 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,600, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 261  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,583.9
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,583.9
	MW[1]      :    117,677.5   @J=I:      3,583.9
	MW[2]      :    117,677.5   @J=I:      3,583.9
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_7.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:28 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 262  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 263  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 264  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:20 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:19 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 265  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,495.4287   @J=I:         44.2699
	MI.02.DISTANCE:    474,520.59  
	MW[1]         :    -28,495.4287   @J=I:         44.2699
	MW[2]         :    466,889.25  
	MW[100]       :    278,961.4801   @J=I:      1,484.7623
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,479.8548
	MW[115]       :     -6,870.3122
	MW[116]       :     47,461.92     @J=I:        177.76  
	MW[200]       :    117,677.504    @J=I:      3,587.5844
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,587.58437

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 266  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:28 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:28 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,607, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 267  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,587.6
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,587.6
	MW[1]      :    117,677.5   @J=I:      3,587.6
	MW[2]      :    117,677.5   @J=I:      3,587.6
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_8.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:29 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 268  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 269  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 270  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:20 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:19 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 271  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,495.4287   @J=I:         44.2699
	MI.02.DISTANCE:    474,520.59  
	MW[1]         :    -28,495.4287   @J=I:         44.2699
	MW[2]         :    466,889.25  
	MW[100]       :    285,697.8901   @J=I:      1,509.9923
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,479.8548
	MW[115]       :     -6,870.3122
	MW[116]       :     54,198.33     @J=I:        202.99  
	MW[200]       :    117,677.504    @J=I:      3,590.592 
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,590.59203

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 272  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:29 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:29 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,599, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 273  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,590.6
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,590.6
	MW[1]      :    117,677.5   @J=I:      3,590.6
	MW[2]      :    117,677.5   @J=I:      3,590.6
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_9.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:29 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 274  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 275  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 276  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:20 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:19 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 277  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,495.4287   @J=I:         44.2699
	MI.02.DISTANCE:    474,520.59  
	MW[1]         :    -28,495.4287   @J=I:         44.2699
	MW[2]         :    466,889.25  
	MW[100]       :    292,581.1501   @J=I:      1,535.7723
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,479.8548
	MW[115]       :     -6,870.3122
	MW[116]       :     61,081.59     @J=I:        228.77  
	MW[200]       :    117,677.504    @J=I:      3,592.0439
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,592.0439 

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 278  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:29 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:29 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,608, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 279  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,592  
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,592  
	MW[1]      :    117,677.5   @J=I:      3,592  
	MW[2]      :    117,677.5   @J=I:      3,592  
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_10.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBO.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:30 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:30 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:30 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:30 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBSH.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:30 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:31 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:31 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:31 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_NHB.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:31 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:31 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:31 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:32 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_tlfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:32 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_ttfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:32 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_d2d_flows.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:32 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 324  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:32 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT",
 MO = 1, NAME = HBO_HBSH
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT"

MW[1] = MI.1.1 + MI.2.1


MATRIX Stack Size = 344 bytes.
................................................................................


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:30 2016 
ID=
PAR Zones=267 M=1
  HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:30 2016 
ID=
PAR Zones=267 M=1
  HBO

Totals after Iteration 1 I loop:

	MI.02.001: 136,095   @J=I:  17,507
	MI.01.001: 264,074   @J=I:  49,434
	MW[1]    : 400,170   @J=I:  66,941
	MO.01.001: 400,175

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 325  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:32 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 326  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2804 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:29 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:20 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 327  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 117,677.504    @J=I:   3,592.0439
	MI.01.001:  58,625.9202   @J=I:     182.4983
	MI.01.002:   5,643.9091   @J=I:      17.5691
	MI.01.003:   1,037.8873
	MI.01.004:           --
	MI.01.005:   5,981.2834   @J=I:      66.9326
	MI.01.006:  59,537.9829   @J=I:     182.4983
	MI.01.007:   5,731.7132   @J=I:      17.5691
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   6,019.3039   @J=I:      66.9326
	MW[1]    : 117,677.504    @J=I:   3,592.0439
	MW[2]    :  36,759.522    @J=I:   1,264.5053
	MW[3]    :  80,917.982    @J=I:   2,327.5386
	MW[11]   :  58,625.9202   @J=I:     182.4983
	MW[12]   :   5,643.9091   @J=I:      17.5691
	MW[13]   :   1,037.8873
	MW[14]   :           --
	MW[15]   :   5,981.2834   @J=I:      66.9326
	MW[16]   :  59,537.9829   @J=I:     182.4983
	MW[17]   :   5,731.7132   @J=I:      17.5691
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   6,019.3039   @J=I:      66.9326
	MW[21]   : 102,967.0974   @J=I:   2,438.4353
	MW[22]   :   9,912.6279   @J=I:     234.7478
	MW[23]   :   3,095.4297
	MW[24]   :           --
	MW[25]   :   1,702.3489   @J=I:     918.8607
	MO.01.001: 102,969.63  
	MO.01.002:   9,911.8   
	MO.01.003:   3,094.51  
	MO.01.005:   1,697.07  

Variable Values at end of Iteration 1 I loop:

    EDA: 102,967.1
    ESR:   9,912.6
    ELB:   3,095.4
    ENM:   1,702.3
    TRN:   3,095.4
    AUT: 112,879.7
    TOT: 117,677.5

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 328  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:32 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 329  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2808 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:32 2016 
ID=
PAR Zones=267 M=1
  HBO_HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:21 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 330  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 400,174.62     @J=I:  66,941     
	MI.01.001:  30,685.6213   @J=I:      85.8217
	MI.01.002:  31,708.7981   @J=I:      88.6833
	MI.01.003:     214.405 
	MI.01.004:           --
	MI.01.005:   8,680.1756   @J=I:      92.4949
	MI.01.006:  30,783.8043   @J=I:      85.8217
	MI.01.007:  31,810.2549   @J=I:      88.6833
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   8,694.9408   @J=I:      92.4949
	MW[1]    : 400,174.62     @J=I:  66,941     
	MW[2]    : 151,505.242    @J=I:  24,039.8267
	MW[3]    : 248,669.378    @J=I:  42,901.1733
	MW[11]   :  30,685.6213   @J=I:      85.8217
	MW[12]   :  31,708.7981   @J=I:      88.6833
	MW[13]   :     214.405 
	MW[14]   :           --
	MW[15]   :   8,680.1756   @J=I:      92.4949
	MW[16]   :  30,783.8043   @J=I:      85.8217
	MW[17]   :  31,810.2549   @J=I:      88.6833
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   8,694.9408   @J=I:      92.4949
	MW[21]   : 176,383.1678   @J=I:  21,436.9346
	MW[22]   : 182,264.4616   @J=I:  22,151.7245
	MW[23]   :   2,092.5804
	MW[24]   :           --
	MW[25]   :  39,434.4103   @J=I:  23,352.3409
	MO.01.001: 176,377.73  
	MO.01.002: 182,276.33  
	MO.01.003:   2,091.44  
	MO.01.005:  39,429.05  

Variable Values at end of Iteration 1 I loop:

    EDA: 176,383.2
    ESR: 182,264.5
    ELB:   2,092.6
    ENM:  39,434.4
    TRN:   2,092.6
    AUT: 358,647.6
    TOT: 400,174.6

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################
Page 331  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:33 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 332  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2804 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:31 2016 
ID=
PAR Zones=267 M=1
  NHB

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:22 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 333  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 315,086.909    @J=I:  44,208.056 
	MI.01.001:  33,536.1883   @J=I:     102.3547
	MI.01.002:  31,356.6104   @J=I:      95.7025
	MI.01.003:     116.5817
	MI.01.004:           --
	MI.01.005:   6,279.6196   @J=I:      68.9429
	MI.01.006:  33,593.5202   @J=I:     102.3547
	MI.01.007:  31,410.2162   @J=I:      95.7025
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   6,285.2636   @J=I:      68.9429
	MW[1]    : 315,086.909    @J=I:  44,208.056 
	MW[2]    : 118,035.889    @J=I:  17,565.7306
	MW[3]    : 197,051.02     @J=I:  26,642.3254
	MW[11]   :  33,536.1883   @J=I:     102.3547
	MW[12]   :  31,356.6104   @J=I:      95.7025
	MW[13]   :     116.5817
	MW[14]   :           --
	MW[15]   :   6,279.6196   @J=I:      68.9429
	MW[16]   :  33,593.5202   @J=I:     102.3547
	MW[17]   :  31,410.2162   @J=I:      95.7025
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   6,285.2636   @J=I:      68.9429
	MW[21]   : 154,236.2932   @J=I:  16,862.0061
	MW[22]   : 144,212.196    @J=I:  15,766.1137
	MW[23]   :     867.732 
	MW[24]   :           --
	MW[25]   :  15,770.6878   @J=I:  11,579.9363
	MO.01.001: 154,239.81  
	MO.01.002: 144,215.15  
	MO.01.003:     864.91  
	MO.01.005:  15,764.53  

Variable Values at end of Iteration 1 I loop:

    EDA: 154,236.293
    ESR: 144,212.196
    ELB:     867.732
    ENM:  15,770.688
    TRN:     867.732
    AUT: 298,448.489
    TOT: 315,086.909

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 334  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:33 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 335  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2822 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:24 2016 
ID=
PAR Zones=267 M=1
  HBSC

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:15:23 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 336  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001:  7,669.89     @J=I:  1,031.57  
	MI.01.001: 33,536.1883   @J=I:    102.3547
	MI.01.002: 31,356.6104   @J=I:     95.7025
	MI.01.003:    116.5817
	MI.01.004:          --
	MI.01.005:  6,279.6196   @J=I:     68.9429
	MI.01.006: 33,593.5202   @J=I:    102.3547
	MI.01.007: 31,410.2162   @J=I:     95.7025
	MI.01.008:          --
	MI.01.009:          --
	MI.01.010:  6,285.2636   @J=I:     68.9429
	MW[1]    :  7,669.89     @J=I:  1,031.57  
	MW[2]    :  2,636.4448   @J=I:    334.5522
	MW[3]    :  5,033.4452   @J=I:    697.0178
	MW[11]   : 33,536.1883   @J=I:    102.3547
	MW[12]   : 31,356.6104   @J=I:     95.7025
	MW[13]   :    116.5817
	MW[14]   :          --
	MW[15]   :  6,279.6196   @J=I:     68.9429
	MW[16]   : 33,593.5202   @J=I:    102.3547
	MW[17]   : 31,410.2162   @J=I:     95.7025
	MW[18]   :          --
	MW[19]   :          --
	MW[20]   :  6,285.2636   @J=I:     68.9429
	MW[21]   :  3,586.164    @J=I:    395.1135
	MW[22]   :  3,353.0927   @J=I:    369.4344
	MW[23]   :     25.9141
	MW[24]   :          --
	MW[25]   :    704.7193   @J=I:    267.0221
	MO.01.001:  3,593.94  
	MO.01.002:  3,345.78  
	MO.01.003:     24.8   
	MO.01.005:    703.71  

Variable Values at end of Iteration 1 I loop:

    EDA: 3,586.164 
    ESR: 3,353.0927
    ELB:    25.9141
    ENM:   704.7193
    TRN:    25.9141
    AUT: 6,939.2566
    TOT: 7,669.89  

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_AM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:33 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_MD.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:34 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_PM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:34 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_NT.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:34 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\MC_Transit_Trips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:35 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:35 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\AM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:35 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:20
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:55 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\MD.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:15:56 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:20
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:16 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:16 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:26
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:42 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\NT.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:42 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:08
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Merge_Hwy_Assignments.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:50 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Hwy_eval.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:50 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PBHWY00B.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:50 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\PBHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:50 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################

M(100): COPY C:\projects\Roanoke\Base\Output\PK_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\PK_HWYSKIM_3.MAT
M(100): COPY C:\projects\Roanoke\Base\Output\OP_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\OP_HWYSKIM_3.MATPage 439  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:51 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\pk_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\PK_CNG_HwySkim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1330 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\PK_CNG_HwySkim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Tue Mar 29 14:16:50 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 440  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,657,215.87   @J=I:     23,000,118.94
	MI.01.002: 22,402,474,446.98
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,866,833.87   @J=I:     23,000,796.94
	MW[1]    : 22,425,657,215.87   @J=I:     23,000,118.94
	MW[2]    : 22,402,474,446.98
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,866,833.87   @J=I:     23,000,796.94
	MW[11]   :        657,215.87   @J=I:            118.94
	MW[12]   :        474,446.98
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        802,633.87   @J=I:            786.94
	MO.01.001:        657,215.87
	MO.01.002:        474,446.98
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        802,633.87

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 441  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:51 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_CNG_HwySkim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1330 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\OP_CNG_HwySkim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Tue Mar 29 14:16:50 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 442  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,684,985.2   @J=I:     23,000,119.9
	MI.01.002: 22,402,470,228.4
	MI.01.003:         90,513     @J=I:            339  
	MI.01.004:        119,105     @J=I:            339  
	MI.01.005: 22,425,894,603.2   @J=I:     23,000,797.9
	MW[1]    : 22,425,684,985.2   @J=I:     23,000,119.9
	MW[2]    : 22,402,470,228.4
	MW[3]    :         90,513     @J=I:            339  
	MW[4]    :        119,105     @J=I:            339  
	MW[5]    : 22,425,894,603.2   @J=I:     23,000,797.9
	MW[11]   :        684,985.1   @J=I:            119.9
	MW[12]   :        470,228.4
	MW[13]   :         90,513     @J=I:            339  
	MW[14]   :        119,105     @J=I:            339  
	MW[15]   :        830,403.2   @J=I:            787.9
	MO.01.001:        684,985.1
	MO.01.002:        470,228.4
	MO.01.003:         90,513  
	MO.01.004:        119,105  
	MO.01.005:        830,403.2

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBW_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:51 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBO_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:52 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\NHB_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:53 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBSC_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:54 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\TDMAT00C.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:55 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\HBSC_distribution.PRN. 
DISTRIBUTION (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:55 2016
DISTRIBUTION ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_D2D_Flwos.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:56 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_noSchoolTrips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:56 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\PARAMS\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:56 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 507  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 508  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 509  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:51 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:51 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 510  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,495.4348   @J=I:         44.2697
	MI.02.DISTANCE:    474,446.98  
	MW[1]         :    -28,495.4348   @J=I:         44.2697
	MW[2]         :    466,818.51  
	MW[100]       :    231,501.1046   @J=I:      1,307.0021
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,474.098 
	MW[115]       :     -6,876.9591
	MW[116]       :              --
	MW[200]       :    117,677.504    @J=I:      3,406.1652
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,406.1652 

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 511  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:57 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:56 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,954, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 512  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,406.2
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,406.2
	MW[1]      :    117,677.5   @J=I:      3,406.2
	MW[2]      :    117,677.5   @J=I:      3,406.2
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_1.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:57 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 513  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 514  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 515  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:51 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:51 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 516  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,495.4348   @J=I:         44.2697
	MI.02.DISTANCE:    474,446.98  
	MW[1]         :    -28,495.4348   @J=I:         44.2697
	MW[2]         :    466,818.51  
	MW[100]       :    238,387.0346   @J=I:      1,332.7921
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,474.098 
	MW[115]       :     -6,876.9591
	MW[116]       :      6,885.93     @J=I:         25.79  
	MW[200]       :    117,677.504    @J=I:      3,474.2736
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,474.27359

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 517  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:57 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:57 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,216, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 518  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,474.3
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,474.3
	MW[1]      :    117,677.5   @J=I:      3,474.3
	MW[2]      :    117,677.5   @J=I:      3,474.3
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_2.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:57 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 519  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 520  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 521  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:51 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:51 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 522  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,495.4348   @J=I:         44.2697
	MI.02.DISTANCE:    474,446.98  
	MW[1]         :    -28,495.4348   @J=I:         44.2697
	MW[2]         :    466,818.51  
	MW[100]       :    245,163.4946   @J=I:      1,358.1721
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,474.098 
	MW[115]       :     -6,876.9591
	MW[116]       :     13,662.39     @J=I:         51.17  
	MW[200]       :    117,677.504    @J=I:      3,518.7304
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,518.73037

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 523  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:58 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:57 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,387, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 524  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,518.7
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,518.7
	MW[1]      :    117,677.5   @J=I:      3,518.7
	MW[2]      :    117,677.5   @J=I:      3,518.7
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_3.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:58 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 525  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 526  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 527  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:51 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:51 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 528  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,495.4348   @J=I:         44.2697
	MI.02.DISTANCE:    474,446.98  
	MW[1]         :    -28,495.4348   @J=I:         44.2697
	MW[2]         :    466,818.51  
	MW[100]       :    252,028.0646   @J=I:      1,383.8821
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,474.098 
	MW[115]       :     -6,876.9591
	MW[116]       :     20,526.96     @J=I:         76.88  
	MW[200]       :    117,677.504    @J=I:      3,548.2231
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,548.22308

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 529  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:58 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:58 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,476, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 530  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,548.2
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,548.2
	MW[1]      :    117,677.5   @J=I:      3,548.2
	MW[2]      :    117,677.5   @J=I:      3,548.2
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_4.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:58 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 531  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 532  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 533  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:51 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:51 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 534  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,495.4348   @J=I:         44.2697
	MI.02.DISTANCE:    474,446.98  
	MW[1]         :    -28,495.4348   @J=I:         44.2697
	MW[2]         :    466,818.51  
	MW[100]       :    258,836.5646   @J=I:      1,409.3821
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,474.098 
	MW[115]       :     -6,876.9591
	MW[116]       :     27,335.46     @J=I:        102.38  
	MW[200]       :    117,677.504    @J=I:      3,567.4797
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,567.47975

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 535  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:59 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:58 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,523, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 536  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,567.5
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,567.5
	MW[1]      :    117,677.5   @J=I:      3,567.5
	MW[2]      :    117,677.5   @J=I:      3,567.5
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_5.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:59 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 537  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 538  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 539  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:51 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:51 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 540  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,495.4348   @J=I:         44.2697
	MI.02.DISTANCE:    474,446.98  
	MW[1]         :    -28,495.4348   @J=I:         44.2697
	MW[2]         :    466,818.51  
	MW[100]       :    265,506.2246   @J=I:      1,434.3621
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,474.098 
	MW[115]       :     -6,876.9591
	MW[116]       :     34,005.12     @J=I:        127.36  
	MW[200]       :    117,677.504    @J=I:      3,577.2935
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,577.29354

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 541  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:59 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:59 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,583, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 542  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,577.3
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,577.3
	MW[1]      :    117,677.5   @J=I:      3,577.3
	MW[2]      :    117,677.5   @J=I:      3,577.3
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_6.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:16:59 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 543  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 544  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 545  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:51 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:51 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 546  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,495.4348   @J=I:         44.2697
	MI.02.DISTANCE:    474,446.98  
	MW[1]         :    -28,495.4348   @J=I:         44.2697
	MW[2]         :    466,818.51  
	MW[100]       :    272,261.3246   @J=I:      1,459.6621
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,474.098 
	MW[115]       :     -6,876.9591
	MW[116]       :     40,760.22     @J=I:        152.66  
	MW[200]       :    117,677.504    @J=I:      3,583.3312
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,583.33119

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 547  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:00 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:59 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,598, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 548  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,583.3
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,583.3
	MW[1]      :    117,677.5   @J=I:      3,583.3
	MW[2]      :    117,677.5   @J=I:      3,583.3
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_7.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:00 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 549  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 550  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 551  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:51 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:51 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 552  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,495.4348   @J=I:         44.2697
	MI.02.DISTANCE:    474,446.98  
	MW[1]         :    -28,495.4348   @J=I:         44.2697
	MW[2]         :    466,818.51  
	MW[100]       :    278,968.3646   @J=I:      1,484.7821
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,474.098 
	MW[115]       :     -6,876.9591
	MW[116]       :     47,467.26     @J=I:        177.78  
	MW[200]       :    117,677.504    @J=I:      3,586.9062
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,586.90616

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 553  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:00 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:17:00 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,598, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 554  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,586.9
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,586.9
	MW[1]      :    117,677.5   @J=I:      3,586.9
	MW[2]      :    117,677.5   @J=I:      3,586.9
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_8.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:01 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 555  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 556  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 557  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:51 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:51 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 558  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,495.4348   @J=I:         44.2697
	MI.02.DISTANCE:    474,446.98  
	MW[1]         :    -28,495.4348   @J=I:         44.2697
	MW[2]         :    466,818.51  
	MW[100]       :    285,712.7846   @J=I:      1,510.0421
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,474.098 
	MW[115]       :     -6,876.9591
	MW[116]       :     54,211.68     @J=I:        203.04  
	MW[200]       :    117,677.504    @J=I:      3,589.3505
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,589.35054

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 559  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:01 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:17:01 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,597, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 560  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,589.4
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,589.4
	MW[1]      :    117,677.5   @J=I:      3,589.4
	MW[2]      :    117,677.5   @J=I:      3,589.4
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_9.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:01 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 561  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 562  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 563  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:51 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:51 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 564  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,495.4348   @J=I:         44.2697
	MI.02.DISTANCE:    474,446.98  
	MW[1]         :    -28,495.4348   @J=I:         44.2697
	MW[2]         :    466,818.51  
	MW[100]       :    292,593.3746   @J=I:      1,535.8121
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,474.098 
	MW[115]       :     -6,876.9591
	MW[116]       :     61,092.27     @J=I:        228.81  
	MW[200]       :    117,677.504    @J=I:      3,591.5989
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,591.5989 

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 565  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:01 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:17:01 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,597, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 566  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,591.6
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,591.6
	MW[1]      :    117,677.5   @J=I:      3,591.6
	MW[2]      :    117,677.5   @J=I:      3,591.6
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_10.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBO.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:02 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:02 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:02 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:02 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBSH.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:02 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:03 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:03 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:03 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_NHB.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:03 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:03 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:03 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:03 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_tlfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:04 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_ttfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:04 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_d2d_flows.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:04 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 611  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:04 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT",
 MO = 1, NAME = HBO_HBSH
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT"

MW[1] = MI.1.1 + MI.2.1


MATRIX Stack Size = 344 bytes.
................................................................................


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:17:02 2016 
ID=
PAR Zones=267 M=1
  HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:17:02 2016 
ID=
PAR Zones=267 M=1
  HBO

Totals after Iteration 1 I loop:

	MI.02.001: 136,095   @J=I:  17,508
	MI.01.001: 264,074   @J=I:  49,429
	MW[1]    : 400,170   @J=I:  66,937
	MO.01.001: 400,174

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 612  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:04 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 613  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2804 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:17:01 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:51 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 614  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 117,677.504    @J=I:   3,591.5989
	MI.01.001:  58,625.8929   @J=I:     182.4983
	MI.01.002:   5,643.9064   @J=I:      17.5691
	MI.01.003:   1,037.9013
	MI.01.004:           --
	MI.01.005:   5,981.2993   @J=I:      66.9327
	MI.01.006:  59,537.9659   @J=I:     182.4983
	MI.01.007:   5,731.7116   @J=I:      17.5691
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   6,019.3226   @J=I:      66.9327
	MW[1]    : 117,677.504    @J=I:   3,591.5989
	MW[2]    :  36,754.5023   @J=I:   1,264.7447
	MW[3]    :  80,923.0017   @J=I:   2,326.8542
	MW[11]   :  58,625.8929   @J=I:     182.4983
	MW[12]   :   5,643.9064   @J=I:      17.5691
	MW[13]   :   1,037.9013
	MW[14]   :           --
	MW[15]   :   5,981.2993   @J=I:      66.9327
	MW[16]   :  59,537.9659   @J=I:     182.4983
	MW[17]   :   5,731.7116   @J=I:      17.5691
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   6,019.3226   @J=I:      66.9327
	MW[21]   : 102,967.0372   @J=I:   2,438.1389
	MW[22]   :   9,912.6222   @J=I:     234.7193
	MW[23]   :   3,095.3255
	MW[24]   :           --
	MW[25]   :   1,702.5191   @J=I:     918.7408
	MO.01.001: 102,970.74  
	MO.01.002:   9,911.96  
	MO.01.003:   3,094.56  
	MO.01.005:   1,697.26  

Variable Values at end of Iteration 1 I loop:

    EDA: 102,967  
    ESR:   9,912.6
    ELB:   3,095.3
    ENM:   1,702.5
    TRN:   3,095.3
    AUT: 112,879.7
    TOT: 117,677.5

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 615  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:04 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 616  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2808 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:17:04 2016 
ID=
PAR Zones=267 M=1
  HBO_HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:52 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 617  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 400,174.09     @J=I:  66,937.28  
	MI.01.001:  30,685.6009   @J=I:      85.8217
	MI.01.002:  31,708.777    @J=I:      88.6833
	MI.01.003:     214.4633
	MI.01.004:           --
	MI.01.005:   8,680.1588   @J=I:      92.495 
	MI.01.006:  30,783.8135   @J=I:      85.8217
	MI.01.007:  31,810.2644   @J=I:      88.6833
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   8,694.9221   @J=I:      92.495 
	MW[1]    : 400,174.09     @J=I:  66,937.28  
	MW[2]    : 151,541.248    @J=I:  24,044.3692
	MW[3]    : 248,632.842    @J=I:  42,892.9108
	MW[11]   :  30,685.6009   @J=I:      85.8217
	MW[12]   :  31,708.777    @J=I:      88.6833
	MW[13]   :     214.4633
	MW[14]   :           --
	MW[15]   :   8,680.1588   @J=I:      92.495 
	MW[16]   :  30,783.8135   @J=I:      85.8217
	MW[17]   :  31,810.2644   @J=I:      88.6833
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   8,694.9221   @J=I:      92.495 
	MW[21]   : 176,382.4766   @J=I:  21,435.6721
	MW[22]   : 182,263.7474   @J=I:  22,150.4199
	MW[23]   :   2,093.1424
	MW[24]   :           --
	MW[25]   :  39,434.7236   @J=I:  23,351.188 
	MO.01.001: 176,376.45  
	MO.01.002: 182,276.07  
	MO.01.003:   2,091.94  
	MO.01.005:  39,429.12  

Variable Values at end of Iteration 1 I loop:

    EDA: 176,382.5
    ESR: 182,263.7
    ELB:   2,093.1
    ENM:  39,434.7
    TRN:   2,093.1
    AUT: 358,646.2
    TOT: 400,174.1

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################
Page 618  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:05 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 619  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2804 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:17:03 2016 
ID=
PAR Zones=267 M=1
  NHB

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:53 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 620  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 315,086.909    @J=I:  44,204.9958
	MI.01.001:  33,536.1811   @J=I:     102.3546
	MI.01.002:  31,356.6037   @J=I:      95.7024
	MI.01.003:     116.6101
	MI.01.004:           --
	MI.01.005:   6,279.6051   @J=I:      68.943 
	MI.01.006:  33,593.5279   @J=I:     102.3546
	MI.01.007:  31,410.2234   @J=I:      95.7024
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   6,285.2487   @J=I:      68.943 
	MW[1]    : 315,086.909    @J=I:  44,204.9958
	MW[2]    : 118,051.0957   @J=I:  17,566.2713
	MW[3]    : 197,035.8133   @J=I:  26,638.7244
	MW[11]   :  33,536.1811   @J=I:     102.3546
	MW[12]   :  31,356.6037   @J=I:      95.7024
	MW[13]   :     116.6101
	MW[14]   :           --
	MW[15]   :   6,279.6051   @J=I:      68.943 
	MW[16]   :  33,593.5279   @J=I:     102.3546
	MW[17]   :  31,410.2234   @J=I:      95.7024
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   6,285.2487   @J=I:      68.943 
	MW[21]   : 154,236.5517   @J=I:  16,860.8785
	MW[22]   : 144,212.4377   @J=I:  15,765.0593
	MW[23]   :     867.8959
	MW[24]   :           --
	MW[25]   :  15,770.0238   @J=I:  11,579.058 
	MO.01.001: 154,239.6   
	MO.01.002: 144,215.03  
	MO.01.003:     865.19  
	MO.01.005:  15,763.75  

Variable Values at end of Iteration 1 I loop:

    EDA: 154,236.552
    ESR: 144,212.438
    ELB:     867.896
    ENM:  15,770.024
    TRN:     867.896
    AUT: 298,448.989
    TOT: 315,086.909

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 621  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:05 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 622  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2822 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:56 2016 
ID=
PAR Zones=267 M=1
  HBSC

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:16:54 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 623  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001:  7,669.94     @J=I:  1,031.32  
	MI.01.001: 33,536.1811   @J=I:    102.3546
	MI.01.002: 31,356.6037   @J=I:     95.7024
	MI.01.003:    116.6101
	MI.01.004:          --
	MI.01.005:  6,279.6051   @J=I:     68.943 
	MI.01.006: 33,593.5279   @J=I:    102.3546
	MI.01.007: 31,410.2234   @J=I:     95.7024
	MI.01.008:          --
	MI.01.009:          --
	MI.01.010:  6,285.2487   @J=I:     68.943 
	MW[1]    :  7,669.94     @J=I:  1,031.32  
	MW[2]    :  2,636.8064   @J=I:    334.4206
	MW[3]    :  5,033.1335   @J=I:    696.8994
	MW[11]   : 33,536.1811   @J=I:    102.3546
	MW[12]   : 31,356.6037   @J=I:     95.7024
	MW[13]   :    116.6101
	MW[14]   :          --
	MW[15]   :  6,279.6051   @J=I:     68.943 
	MW[16]   : 33,593.5279   @J=I:    102.3546
	MW[17]   : 31,410.2234   @J=I:     95.7024
	MW[18]   :          --
	MW[19]   :          --
	MW[20]   :  6,285.2487   @J=I:     68.943 
	MW[21]   :  3,586.2184   @J=I:    395.0162
	MW[22]   :  3,353.1435   @J=I:    369.3434
	MW[23]   :     25.925 
	MW[24]   :          --
	MW[25]   :    704.6531   @J=I:    266.9603
	MO.01.001:  3,594     
	MO.01.002:  3,345.74  
	MO.01.003:     24.87  
	MO.01.005:    703.59  

Variable Values at end of Iteration 1 I loop:

    EDA: 3,586.2184
    ESR: 3,353.1435
    ELB:    25.925 
    ENM:   704.6531
    TRN:    25.925 
    AUT: 6,939.3619
    TOT: 7,669.94  

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_AM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:05 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_MD.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:06 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_PM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:06 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_NT.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:06 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\MC_Transit_Trips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:07 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:07 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\AM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:07 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:23
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:30 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\MD.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:30 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:21
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:51 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:17:51 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:32
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:23 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\NT.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:24 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:07
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Merge_Hwy_Assignments.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:31 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Hwy_eval.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:31 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PBHWY00B.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:31 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\PBHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:32 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\Output\PK_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\PK_HWYSKIM_4.MAT
M(100): COPY C:\projects\Roanoke\Base\Output\OP_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\OP_HWYSKIM_4.MATPage 730  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:32 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\pk_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\PK_CNG_HwySkim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1330 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\PK_CNG_HwySkim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Tue Mar 29 14:18:31 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 731  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,657,213.94   @J=I:     23,000,118.94
	MI.01.002: 22,402,474,400.31
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,866,831.94   @J=I:     23,000,796.94
	MW[1]    : 22,425,657,213.94   @J=I:     23,000,118.94
	MW[2]    : 22,402,474,400.31
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,866,831.94   @J=I:     23,000,796.94
	MW[11]   :        657,213.94   @J=I:            118.94
	MW[12]   :        474,400.31
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        802,631.94   @J=I:            786.94
	MO.01.001:        657,213.94
	MO.01.002:        474,400.31
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        802,631.94

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 732  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:32 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_Hwyskim.MAT",
 MO=11-15,DEC=5*D,NAME=TIME,DISTANCE,OTERM,DTERM,TOTAL_TIME
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\OP_CNG_HwySkim.MAT"

FILLMW MW[1]=MI.1.1(5)                ; highway skims

; Reset invalid values to zero
  JLOOP
      IF (MW[1] > 1000)
          MW[11] = 0
      ELSE
          MW[11] = MW[1]
      ENDIF

      IF (MW[2] > 1000)
          MW[12] = 0
      ELSE
          MW[12] = MW[2]
      ENDIF

      IF (MW[3] > 1000)
          MW[13] = 0
      ELSE
          MW[13] = MW[3]
      ENDIF

      IF (MW[4] > 1000)
          MW[14] = 0
      ELSE
          MW[14] = MW[4]
      ENDIF

      IF (MW[5] > 1000)
          MW[15] = 0
      ELSE
          MW[15] = MW[5]
      ENDIF

      ENDJLOOP


MATRIX Stack Size = 1330 bytes.
................................................................................


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\OP_CNG_HwySkim.MAT Opened
MAT PGM=HIGHWAY (v.08/05/2014 [6.1.1]) DATE=Tue Mar 29 14:18:32 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIMEPage 733  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001: 22,425,684,888.54   @J=I:     23,000,119.89
	MI.01.002: 22,402,470,186.05
	MI.01.003:         90,513      @J=I:            339   
	MI.01.004:        119,105      @J=I:            339   
	MI.01.005: 22,425,894,506.54   @J=I:     23,000,797.89
	MW[1]    : 22,425,684,888.54   @J=I:     23,000,119.89
	MW[2]    : 22,402,470,186.05
	MW[3]    :         90,513      @J=I:            339   
	MW[4]    :        119,105      @J=I:            339   
	MW[5]    : 22,425,894,506.54   @J=I:     23,000,797.89
	MW[11]   :        684,888.54   @J=I:            119.89
	MW[12]   :        470,186.05
	MW[13]   :         90,513      @J=I:            339   
	MW[14]   :        119,105      @J=I:            339   
	MW[15]   :        830,306.54   @J=I:            787.89
	MO.01.001:        684,888.54
	MO.01.002:        470,186.05
	MO.01.003:         90,513   
	MO.01.004:        119,105   
	MO.01.005:        830,306.54

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBW_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:32 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:02
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBO_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:34 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\NHB_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:35 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\LOGS\HBSC_logsum.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:36 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:02
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\TDMAT00C.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:38 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\HBSC_distribution.PRN. 
DISTRIBUTION (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:38 2016
DISTRIBUTION ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_D2D_Flwos.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:39 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSC_noSchoolTrips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:39 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\PARAMS\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:39 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 798  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 799  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 800  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:32 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:32 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 801  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,494.3709   @J=I:         44.2697
	MI.02.DISTANCE:    474,400.31  
	MW[1]         :    -28,494.3709   @J=I:         44.2697
	MW[2]         :    466,774.45  
	MW[100]       :    231,504.4479   @J=I:      1,307.0021
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,467.4356
	MW[115]       :     -6,880.9525
	MW[116]       :              --
	MW[200]       :    117,677.504    @J=I:      3,405.7291
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,405.72907

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 802  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:39 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 264 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:39 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=328,932, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 803  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,405.7
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,405.7
	MW[1]      :    117,677.5   @J=I:      3,405.7
	MW[2]      :    117,677.5   @J=I:      3,405.7
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_1.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:39 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 804  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 805  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 806  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:32 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:32 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 807  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,494.3709   @J=I:         44.2697
	MI.02.DISTANCE:    474,400.31  
	MW[1]         :    -28,494.3709   @J=I:         44.2697
	MW[2]         :    466,774.45  
	MW[100]       :    238,390.3779   @J=I:      1,332.7921
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,467.4356
	MW[115]       :     -6,880.9525
	MW[116]       :      6,885.93     @J=I:         25.79  
	MW[200]       :    117,677.504    @J=I:      3,473.8124
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,473.8124 

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 808  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:40 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:39 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,209, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 809  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,473.8
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,473.8
	MW[1]      :    117,677.5   @J=I:      3,473.8
	MW[2]      :    117,677.5   @J=I:      3,473.8
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_2.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:40 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 810  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 811  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 812  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:32 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:32 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 813  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,494.3709   @J=I:         44.2697
	MI.02.DISTANCE:    474,400.31  
	MW[1]         :    -28,494.3709   @J=I:         44.2697
	MW[2]         :    466,774.45  
	MW[100]       :    245,164.1679   @J=I:      1,358.1621
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,467.4356
	MW[115]       :     -6,880.9525
	MW[116]       :     13,659.72     @J=I:         51.16  
	MW[200]       :    117,677.504    @J=I:      3,519.0271
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,519.02711

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 814  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:40 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:40 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,378, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 815  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,519  
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,519  
	MW[1]      :    117,677.5   @J=I:      3,519  
	MW[2]      :    117,677.5   @J=I:      3,519  
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_3.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:41 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 816  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 817  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 818  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:32 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:32 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 819  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,494.3709   @J=I:         44.2697
	MI.02.DISTANCE:    474,400.31  
	MW[1]         :    -28,494.3709   @J=I:         44.2697
	MW[2]         :    466,774.45  
	MW[100]       :    252,028.7379   @J=I:      1,383.8721
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,467.4356
	MW[115]       :     -6,880.9525
	MW[116]       :     20,524.29     @J=I:         76.87  
	MW[200]       :    117,677.504    @J=I:      3,548.1414
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,548.14144

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 820  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:41 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:41 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,470, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 821  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,548.1
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,548.1
	MW[1]      :    117,677.5   @J=I:      3,548.1
	MW[2]      :    117,677.5   @J=I:      3,548.1
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_4.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:41 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 822  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 823  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 824  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:32 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:32 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 825  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,494.3709   @J=I:         44.2697
	MI.02.DISTANCE:    474,400.31  
	MW[1]         :    -28,494.3709   @J=I:         44.2697
	MW[2]         :    466,774.45  
	MW[100]       :    258,837.2379   @J=I:      1,409.3721
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,467.4356
	MW[115]       :     -6,880.9525
	MW[116]       :     27,332.79     @J=I:        102.37  
	MW[200]       :    117,677.504    @J=I:      3,567.4661
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,567.46615

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 826  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:42 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:41 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,536, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 827  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,567.5
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,567.5
	MW[1]      :    117,677.5   @J=I:      3,567.5
	MW[2]      :    117,677.5   @J=I:      3,567.5
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_5.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:42 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 828  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 829  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 830  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:32 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:32 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 831  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,494.3709   @J=I:         44.2697
	MI.02.DISTANCE:    474,400.31  
	MW[1]         :    -28,494.3709   @J=I:         44.2697
	MW[2]         :    466,774.45  
	MW[100]       :    265,506.8979   @J=I:      1,434.3521
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,467.4356
	MW[115]       :     -6,880.9525
	MW[116]       :     34,002.45     @J=I:        127.35  
	MW[200]       :    117,677.504    @J=I:      3,575.91  
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,575.90999

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 832  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:42 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:42 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,586, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 833  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,575.9
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,575.9
	MW[1]      :    117,677.5   @J=I:      3,575.9
	MW[2]      :    117,677.5   @J=I:      3,575.9
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_6.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:42 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 834  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 835  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 836  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:32 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:32 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 837  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,494.3709   @J=I:         44.2697
	MI.02.DISTANCE:    474,400.31  
	MW[1]         :    -28,494.3709   @J=I:         44.2697
	MW[2]         :    466,774.45  
	MW[100]       :    272,253.9879   @J=I:      1,459.6221
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,467.4356
	MW[115]       :     -6,880.9525
	MW[116]       :     40,749.54     @J=I:        152.62  
	MW[200]       :    117,677.504    @J=I:      3,582.563 
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,582.56295

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 838  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:43 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:42 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,607, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 839  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,582.6
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,582.6
	MW[1]      :    117,677.5   @J=I:      3,582.6
	MW[2]      :    117,677.5   @J=I:      3,582.6
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_7.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:43 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 840  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 841  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 842  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:32 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:32 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 843  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,494.3709   @J=I:         44.2697
	MI.02.DISTANCE:    474,400.31  
	MW[1]         :    -28,494.3709   @J=I:         44.2697
	MW[2]         :    466,774.45  
	MW[100]       :    278,979.7179   @J=I:      1,484.8121
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,467.4356
	MW[115]       :     -6,880.9525
	MW[116]       :     47,475.27     @J=I:        177.81  
	MW[200]       :    117,677.504    @J=I:      3,586.4418
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,586.44183

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 844  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:43 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:43 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,612, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 845  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,586.4
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,586.4
	MW[1]      :    117,677.5   @J=I:      3,586.4
	MW[2]      :    117,677.5   @J=I:      3,586.4
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_8.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:43 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 846  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 847  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 848  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:32 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:32 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 849  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,494.3709   @J=I:         44.2697
	MI.02.DISTANCE:    474,400.31  
	MW[1]         :    -28,494.3709   @J=I:         44.2697
	MW[2]         :    466,774.45  
	MW[100]       :    285,700.1079   @J=I:      1,509.9821
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,467.4356
	MW[115]       :     -6,880.9525
	MW[116]       :     54,195.66     @J=I:        202.98  
	MW[200]       :    117,677.504    @J=I:      3,589.3171
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,589.3171 

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################
Page 850  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:44 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:43 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,600, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 851  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,589.3
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,589.3
	MW[1]      :    117,677.5   @J=I:      3,589.3
	MW[2]      :    117,677.5   @J=I:      3,589.3
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_9.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN.
W(102): Error opening PRNFILE C:\projects\Roanoke\Base\OUTPUT\LOGS0\DC_HBW.PRN
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:44 2016

FILEI ZDATI[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF"
FILEI ZDATI[2] = "C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF"
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf"
FILEI LOOKUPI[1] = "C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT"

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT",
  MO=200,112, DEC=1*D, NAME=HBW, SizeTerm
FILEO PRINTO[1] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_DEBUG.RPT"
FILEO PRINTO[2] = "C:\projects\Roanoke\Base\OUTPUT\DESTCHOICE_SUMMARY.TXT"
FILEO PRINTO[3] = "C:\projects\Roanoke\Base\OUTPUT\HBW_Zonal_Trips.csv"

  ZONES = 267
  ARRAY personTrips = ZONES

  ; READ IN MODEL PARAMETERS
  LOOKUP, NAME=COEFF, LOOKUP[1]=NVAR, RESULT=HBW, INTERPOLATE=N, LIST=Y, LOOKUPI=1
  Coeff_HH = COEFF(1,1)              ; SizeTerm = household coefficient
  Coeff_OTH_OFF_EMP = COEFF(1,2)     ; SizeTerm = Other + Office Emp coefficient
  Coeff_OFF_EMP = COEFF(1,3)         ; SizeTerm = Office Emp coefficient
  Coeff_OTH_EMP = COEFF(1,4)         ; SizeTerm = Other Emp coefficient
  Coeff_RET_EMP = COEFF(1,5)         ; SizeTerm = Retail Emp coefficient
  DISTCAP       = COEFF(1,6)         ; Capped distance (this is a value, not coefficient) ?
  CLSUM         = COEFF(1,7)         ; Logsum coefficient
  CDIST         = COEFF(1,8)         ; distance coefficient
  CDISTSQ       = COEFF(1,9)         ; distance square coeffficient
  CDISTCUB      = COEFF(1,10)        ; distance cube coefficient
  CDISTLN       = COEFF(1,11)        ; distance log coefficient
  KINTRAZ       = COEFF(1,12)        ; Intrazonal constant
  KDIST01       = COEFF(1,13)        ; distance calibration constant (0-1 Mile)
  KDIST12       = COEFF(1,14)        ; distance calibration constant (1-2 Mile)
  KDIST23       = COEFF(1,15)        ; distance calibration constant (2-3 Mile)
  KDIST34       = COEFF(1,16)        ; distance calibration constant (3-4 Mile)
  KDIST45       = COEFF(1,17)        ; distance calibration constant (4-5 Mile)
  KDIST56       = COEFF(1,18)        ; distance calibration constant (5-6 Mile)
  KDIST67       = COEFF(1,19)        ; distance calibration constant (6-7 Mile)

  ; Mode choice logsums
  MW[1] = MI.1.1

  ; Hwy distance skim
  MW[2] = DISTCAP

    ; Distance calibration
    MW[113] = 0
  JLOOP
Page 852  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
    ; Read productions
    personTrips[I] = ZI.2.HBWP

    ; Compute size term
    MW[112] = Coeff_HH * ZI.1.HH[J] + Coeff_OFF_EMP * ZI.1.OFF[J] + Coeff_RET_EMP * (ZI.1.RET[J] + ZI.1.HTRET[J]) + Coeff_OTH_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.OFF[J]  - ZI.1.RET[J] - ZI.1.HTRET[J]) + Coeff_OTH_OFF_EMP * (ZI.1.EMP_NOSG[J] - ZI.1.RET[J] - ZI.1.HTRET[J])

       ; ShadowPrice
      MW[116] = ZI.3.SHADOW_PRIC[J]

    ; Log (sizeTerm)
    IF (MW[112] > 0)   MW[113] = Ln(MW[112])

    ; Intrazonal boolean
    IF (J == I) MW[111] = 1

    ; Hwy distance
    IF (MI.2.Distance < DISTCAP)  MW[2] = MI.2.Distance
    IF (MI.2.Distance > 0)  MW[114] = Ln(MI.2.Distance)

    ; Distance calibration constants
    IF (MW[2] > 0 && MW[2] <=1) MW[115] = KDIST01    ; Calibration constant for distance 0-1 bin
    IF (MW[2] > 1 && MW[2] <=2) MW[115] = KDIST12    ; Calibration constant for distance 1-2 bin
    IF (MW[2] > 2 && MW[2] <=3) MW[115] = KDIST23    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 3 && MW[2] <=4) MW[115] = KDIST34    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 4 && MW[2] <=5) MW[115] = KDIST45    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 5 && MW[2] <=6) MW[115] = KDIST56    ; Calibration constant for distance 2-5 bin
    IF (MW[2] > 6 && MW[2] <=7) MW[115] = KDIST67    ; Calibration constant for distance 2-5 bin



    ; Utility expression
    MW[100] =  CLSUM * MW[1] +                ; modechoice logsum
               CDIST * MW[2] +                ; distance
               CDISTSQ * (POW(MW[2],2)) +     ; distance sq
               CDISTCUB * (POW(MW[2],3)) +    ; distance cube
               CDISTLN * MW[114] +       ; log(distance)
               MW[113] +            ; log(sizeterm)
               KINTRAZ * MW[111] +            ; intrazonal
               MW[115] +                      ; calibration distance
               MW[116]                        ; Shadow Price
  ENDJLOOP

   ; Destination choice model
   XCHOICE,
   ALTERNATIVES = All,
   DEMAND = personTrips[I],
   UTILITIESMW = 100,
   ODEMANDMW = 200,
   DESTSPLIT= TOTAL All, INCLUDE=1-206,
   STARTMW = 800

; Report coefficient values to summary file and debug file;
    JLOOP
  ; Debug destination choicePage 853  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
   IF (1 = 1 && I = 1 && J = 159)
    PRINT PRINTO=1 CSV=F LIST ='DESTINTION CHOICE TRACE HBSC','\n\n'
    PRINT PRINTO=1 CSV=F LIST =' Destination Choice Model Trace \n\nSelected Interchange for Tracing:    ',1(4.0),'-',159(4.0),'\n'
    PRINT PRINTO=1 CSV=F LIST ='\n PURPOSE -                   HBSC  '
    PRINT PRINTO=1 CSV=F LIST ='\n Size Term is computed on the Destination '
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = household coefficient                    ', Coeff_HH          , ' * ' , ZI.1.HH[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other + Office Emp coefficient           ', Coeff_OTH_OFF_EMP , ' * ' , ZI.1.EMP[J], ZI.1.RET[J] ,ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Office Emp coefficient                   ', Coeff_OFF_EMP     , ' * ' , ZI.1.OFF[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Other Emp coefficient                    ', Coeff_OTH_EMP     , ' * ' , ZI.1.EMP[J],  ZI.1.OFF[J], ZI.1.RET[J], ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n SizeTerm = Retail Emp coefficient                   ', Coeff_RET_EMP     , ' * ' , ZI.1.RET[J] , ZI.1.HTRET[J]
    PRINT PRINTO=1 CSV=F LIST ='\n Capped distance (this is a value)           ', DISTCAP
    PRINT PRINTO=1 CSV=F LIST ='\n Logsum coefficient                                  ', CLSUM             , ' * ' , MW[1]
    PRINT PRINTO=1 CSV=F LIST ='\n distance coefficient                                ', CDIST             , ' * ' , MW[2]
    PRINT PRINTO=1 CSV=F LIST ='\n distance square coeffficient                        ', CDISTSQ           , ' * ' , POW(MW[2],2)
    PRINT PRINTO=1 CSV=F LIST ='\n distance cube coefficient                           ', CDISTCUB          , ' * ' , POW(MW[2],3)
    PRINT PRINTO=1 CSV=F LIST ='\n distance log coefficient                            ', CDISTLN           , ' * ' , MW[114]
    PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal constant                                 ', KINTRAZ           , ' * ' , MW[111]
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (0-1 Mile)            ', KDIST01
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (1-2 Mile)            ', KDIST12
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (2-3 Mile)            ', KDIST23
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (3-4 Mile)            ', KDIST34
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (4-5 Mile)            ', KDIST45
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (5-6 Mile)            ', KDIST56
    PRINT PRINTO=1 CSV=F LIST ='\n distance calibration constant (6-7 Mile)            ', KDIST67
    PRINT PRINTO=1 CSV=F LIST ='\n Applied  calibration constant                       ', MW[113]
      PRINT PRINTO=1 CSV=F LIST ='\n Size Term                                           ', MW[112]
      PRINT PRINTO=1 CSV=F LIST ='\n Ln(Size Term)                                       ', MW[113]
    PRINT PRINTO=1 CSV=F LIST ='\n Computed Utility                                    ', MW[100]
    PRINT PRINTO=1 CSV=F LIST ='\n Total Productions in Origin                         ', personTrips[I]
    PRINT PRINTO=1 CSV=F LIST ='\n Trip Attractions                                    ', MW[200]
   ENDIF

   ; Report total intrazonals
    IF (I = J)  INTRAZONAL_sum = INTRAZONAL_sum + MW[200]
    IF (I = ZONES && J = ZONES) PRINT PRINTO=1 CSV=F LIST ='\n Intrazonal Sum            ', INTRAZONAL_sum
 ENDJLOOP


MATRIX Stack Size = 9242 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_ShadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HH_PROD.DBF Opened: 267 data records  7 Fields:
TAZ(N)          HBWP(N)         NHBWP(N)        HBOP(N)         HBSCP(N)       
HBSHP(N)        NHBOP(N)       


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\se_classified_2012A.dbf Opened: 205 data records  55 Fields:
Z(N)            DISTRICT(N)     COUNTY(N)       ACRES(N)        POP(N)         
HH(N)           WORK(N)         VEH(N)          EMP(N)          EMP_NOSG(N)    Page 854  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
SCHOOL(N)       IND(N)          RET(N)          HTRET(N)        OFF(N)         
SER(N)          SG_RET(N)       SG_HOS(N)       SG_AIR(N)       SG_COL(N)      
SG_NAME(C)      ID(N)           N(N)            w0v0(N)         w0v1(N)        
w0v2(N)         w0v3(N)         w1v0(N)         w1v1(N)         w1v2(N)        
w1v3(N)         w2v0(N)         w2v1(N)         w2v2(N)         w2v3(N)        
w3v0(N)         w3v1(N)         w3v2(N)         w3v3(N)         p1v0(N)        
p1v1(N)         p1v2(N)         p1v3(N)         p2v0(N)         p2v1(N)        
p2v2(N)         p2v3(N)         p3v0(N)         p3v1(N)         p3v2(N)        
p3v3(N)         p4v0(N)         p4v1(N)         p4v2(N)         p4v3(N)        


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCLS.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:32 2016 
ID=
PAR Zones=267 M=1
  LSUM

MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\PK_Hwyskim.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:32 2016 
ID=
PAR Zones=267 M=5
  TIME  DISTANCE  OTERM  DTERM  TOTAL_TIME
LOOKUP #1: COEFF C:\projects\Roanoke\PARAMS\DESTCHOICE_PARAMETERS.DBF:
NVAR        N8      VAR         C22     HBW         N15.4   HBO         N15.4  
HBSH        N15.4   NHB         N15.4  


LOOKUP   COEFF:  FAIL=  --  --  --
         COEFF(1,1)   = 0
         COEFF(1,2)   = 0
         COEFF(1,3)   = 0.45859
         COEFF(1,4)   = 1.6827
         COEFF(1,5)   = 0.60867
         COEFF(1,6)   = 22
         COEFF(1,7)   = 0.5769
         COEFF(1,8)   = -0.4383
         COEFF(1,9)   = 0.0137
         COEFF(1,10)  = -0.0002
         COEFF(1,11)  = 0.7066
         COEFF(1,12)  = 0.24319
         COEFF(1,13)  = -0.64
         COEFF(1,14)  = -0.63
         COEFF(1,15)  = -0.55
         COEFF(1,16)  = -0.46
         COEFF(1,17)  = -0.45
         COEFF(1,18)  = -0.68172
         COEFF(1,19)  = 0.56224


M(792): ARRAY PERSONTRIPS requires 2,144 bytes.Page 855  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001     :    -28,494.3709   @J=I:         44.2697
	MI.02.DISTANCE:    474,400.31  
	MW[1]         :    -28,494.3709   @J=I:         44.2697
	MW[2]         :    466,774.45  
	MW[100]       :    292,591.3779   @J=I:      1,535.7921
	MW[111]       :        267        @J=I:        267     
	MW[112]       : 39,146,781.9176   @J=I:    146,617.1607
	MW[113]       :    324,814.1261   @J=I:      1,216.5323
	MW[114]       :     98,467.4356
	MW[115]       :     -6,880.9525
	MW[116]       :     61,086.93     @J=I:        228.79  
	MW[200]       :    117,677.504    @J=I:      3,590.5289
	MO.01.001     :    117,677.504 
	MO.01.002     : 39,146,779.05  

Variable Values at end of Iteration 1 I loop:

    COEFF_OFF_EMP :     0.45859
    COEFF_OTH_EMP :     1.6827 
    COEFF_RET_EMP :     0.60867
    DISTCAP       :    22      
    CLSUM         :     0.5769 
    CDIST         :    -0.4383 
    CDISTSQ       :     0.0137 
    CDISTCUB      :    -0.0002 
    CDISTLN       :     0.7066 
    KINTRAZ       :     0.24319
    KDIST01       :    -0.64   
    KDIST12       :    -0.63   
    KDIST23       :    -0.55   
    KDIST34       :    -0.46   
    KDIST45       :    -0.45   
    KDIST56       :    -0.68172
    KDIST67       :     0.56224
    INTRAZONAL_SUM: 3,590.52885

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################
Page 856  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:44 2016


FILEI ZDATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF"
FILEO RECO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF",
 fields=Z,PROD1,ATTR1,SizeTerm,Shadow_price
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"

MW[1]=mi.1.1
MW[2]=mi.1.1.t
MW[3]=mi.1.2

RO.PROD1=ROWSUM(1)
RO.ATTR1=ROWSUM(2)
RO.Z=I
RO.SizeTerm = MW[3][I]
Ro.prev =  ZI.1.SHADOW_PRIC

IF (RO.ATTR1 > 0 )
  RO.Shadow_price = Ro.prev + LOG(MW[3][I]/RO.ATTR1)
ENDIF

WRITE RECO=1

MATRIX Stack Size = 918 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF Opened: 267 data records  5 Fields:
Z(N)            PROD1(N)        ATTR1(N)        SIZETERM(N)     SHADOW_PRIC(N) 


MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:44 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

W(789): RECO[1] Shadow_price renamed to SHADOW_PRIC

W(754): Following RO.vars not in any RECO:
   PREV       

Totals from Transpose:

	MI.01.001.T: 117,678

M(660): Transpose Disk Usage (bytes): Data=329,599, Index=1,068.

W(646): I=196 J=1 Error (Invalid values in math function) in:
        RO.SHADOW_PRICE = Ro.prev + LOG(MW[3][I]/RO.ATTR1)Page 857  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.01.001  :    117,677.5   @J=I:      3,590.5
	MI.01.002  : 39,146,779     @J=I:    146,617.2
	MI.01.001.T:    117,677.5   @J=I:      3,590.5
	MW[1]      :    117,677.5   @J=I:      3,590.5
	MW[2]      :    117,677.5   @J=I:      3,590.5
	MW[3]      : 39,146,779     @J=I:    146,617.2

W(717): 1 COMP errors.

M(751): 267 records written to RECO[1]=C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.DBF.

MATRIX   ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice.dbf C:\projects\Roanoke\Base\OUTPUT\HBW_shadowPrice_10.dbf

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBO.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:44 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:45 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:45 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:45 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_HBSH.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:45 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:45 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:46 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:46 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\tripDist_NHB.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:46 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_tlfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:46 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work_ttfd.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:46 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\non-work.d2d_flowsPRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:46 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_tlfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:46 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_ttfd_msg.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:46 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\work_d2d_flows.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:47 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 902  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:47 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT",
 MO = 1, NAME = HBO_HBSH
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT"

MW[1] = MI.1.1 + MI.2.1


MATRIX Stack Size = 344 bytes.
................................................................................


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:45 2016 
ID=
PAR Zones=267 M=1
  HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:44 2016 
ID=
PAR Zones=267 M=1
  HBO

Totals after Iteration 1 I loop:

	MI.02.001: 136,095   @J=I:  17,508
	MI.01.001: 264,074   @J=I:  49,434
	MW[1]    : 400,170   @J=I:  66,941
	MO.01.001: 400,174

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 903  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:47 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBWESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 904  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2804 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBW.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:44 2016 
ID=
PAR Zones=267 M=2
  HBW  SizeTerm

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBW_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:32 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 905  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 117,677.504    @J=I:   3,590.5289
	MI.01.001:  58,625.8864   @J=I:     182.4983
	MI.01.002:   5,643.9058   @J=I:      17.5691
	MI.01.003:   1,037.8973
	MI.01.004:           --
	MI.01.005:   5,981.3105   @J=I:      66.9327
	MI.01.006:  59,537.9541   @J=I:     182.4983
	MI.01.007:   5,731.7104   @J=I:      17.5691
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   6,019.3355   @J=I:      66.9327
	MW[1]    : 117,677.504    @J=I:   3,590.5289
	MW[2]    :  36,752.9363   @J=I:   1,264.5743
	MW[3]    :  80,924.5677   @J=I:   2,325.9545
	MW[11]   :  58,625.8864   @J=I:     182.4983
	MW[12]   :   5,643.9058   @J=I:      17.5691
	MW[13]   :   1,037.8973
	MW[14]   :           --
	MW[15]   :   5,981.3105   @J=I:      66.9327
	MW[16]   :  59,537.9541   @J=I:     182.4983
	MW[17]   :   5,731.7104   @J=I:      17.5691
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   6,019.3355   @J=I:      66.9327
	MW[21]   : 102,964.2126   @J=I:   2,437.3528
	MW[22]   :   9,912.3502   @J=I:     234.6436
	MW[23]   :   3,098.043 
	MW[24]   :           --
	MW[25]   :   1,702.8982   @J=I:     918.5324
	MO.01.001: 102,967.46  
	MO.01.002:   9,911.76  
	MO.01.003:   3,096.96  
	MO.01.005:   1,697.62  

Variable Values at end of Iteration 1 I loop:

    EDA: 102,964.2
    ESR:   9,912.4
    ELB:   3,098  
    ENM:   1,702.9
    TRN:   3,098  
    AUT: 112,876.6
    TOT: 117,677.5

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 906  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:47 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBOESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 907  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2808 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBO_HBSH.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:47 2016 
ID=
PAR Zones=267 M=1
  HBO_HBSH

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBO_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:34 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 908  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 400,173.92     @J=I:  66,941.47  
	MI.01.001:  30,685.5312   @J=I:      85.8217
	MI.01.002:  31,708.705    @J=I:      88.6833
	MI.01.003:     214.4472
	MI.01.004:           --
	MI.01.005:   8,680.3166   @J=I:      92.495 
	MI.01.006:  30,783.7335   @J=I:      85.8217
	MI.01.007:  31,810.1817   @J=I:      88.6833
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   8,695.0849   @J=I:      92.495 
	MW[1]    : 400,173.92     @J=I:  66,941.47  
	MW[2]    : 151,529.9359   @J=I:  24,044.3745
	MW[3]    : 248,643.9841   @J=I:  42,897.0955
	MW[11]   :  30,685.5312   @J=I:      85.8217
	MW[12]   :  31,708.705    @J=I:      88.6833
	MW[13]   :     214.4472
	MW[14]   :           --
	MW[15]   :   8,680.3166   @J=I:      92.495 
	MW[16]   :  30,783.7335   @J=I:      85.8217
	MW[17]   :  31,810.1817   @J=I:      88.6833
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   8,695.0849   @J=I:      92.495 
	MW[21]   : 176,382.2313   @J=I:  21,436.9994
	MW[22]   : 182,263.494    @J=I:  22,151.7915
	MW[23]   :   2,093.3248
	MW[24]   :           --
	MW[25]   :  39,434.8699   @J=I:  23,352.6792
	MO.01.001: 176,376.74  
	MO.01.002: 182,275.31  
	MO.01.003:   2,092.1   
	MO.01.005:  39,429.87  

Variable Values at end of Iteration 1 I loop:

    EDA: 176,382.2
    ESR: 182,263.5
    ELB:   2,093.3
    ENM:  39,434.9
    TRN:   2,093.3
    AUT: 358,645.7
    TOT: 400,173.9

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################
Page 909  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:47 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\NHBESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 910  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2804 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_NHB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:46 2016 
ID=
PAR Zones=267 M=1
  NHB

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\NHB_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:35 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 911  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001: 315,086.909    @J=I:  44,207.7369
	MI.01.001:  33,536.151    @J=I:     102.3546
	MI.01.002:  31,356.5756   @J=I:      95.7024
	MI.01.003:     116.6039
	MI.01.004:           --
	MI.01.005:   6,279.6695   @J=I:      68.9429
	MI.01.006:  33,593.494    @J=I:     102.3546
	MI.01.007:  31,410.1917   @J=I:      95.7024
	MI.01.008:           --
	MI.01.009:           --
	MI.01.010:   6,285.3143   @J=I:      68.9429
	MW[1]    : 315,086.909    @J=I:  44,207.7369
	MW[2]    : 118,043.6488   @J=I:  17,566.0886
	MW[3]    : 197,043.2602   @J=I:  26,641.6483
	MW[11]   :  33,536.151    @J=I:     102.3546
	MW[12]   :  31,356.5756   @J=I:      95.7024
	MW[13]   :     116.6039
	MW[14]   :           --
	MW[15]   :   6,279.6695   @J=I:      68.9429
	MW[16]   :  33,593.494    @J=I:     102.3546
	MW[17]   :  31,410.1917   @J=I:      95.7024
	MW[18]   :           --
	MW[19]   :           --
	MW[20]   :   6,285.3143   @J=I:      68.9429
	MW[21]   : 154,236.4219   @J=I:  16,861.9188
	MW[22]   : 144,212.3163   @J=I:  15,766.032 
	MW[23]   :     867.8469
	MW[24]   :           --
	MW[25]   :  15,770.3238   @J=I:  11,579.7861
	MO.01.001: 154,239.11  
	MO.01.002: 144,215.21  
	MO.01.003:     865.11  
	MO.01.005:  15,764.21  

Variable Values at end of Iteration 1 I loop:

    EDA: 154,236.422
    ESR: 144,212.316
    ELB:     867.847
    ENM:  15,770.324
    TRN:     867.847
    AUT: 298,448.738
    TOT: 315,086.909

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################
Page 912  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:48 2016

FILEO MATO[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCTRIPS.MAT",
 MO = 21-25, NAME = DA, SR, WLB, PMB, NOM
FILEI ZDATI[1] = "C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf"
FILEI MATI[2] = "C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT"
FILEI MATI[1] = "C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT"

        MW[1] = MI.2.1
        FILLMW MW[11] = MI.1.1(10)

     MW[2] = MW[1] * (ZI.1.PCWPROD[I] * 0.01) * (ZI.1.PCWATTR[J] * 0.01)      ; Can Walk
        MW[3] = MW[1] - MW[2]                                                    ; No Trn Access

     MW[21] = MW[11] * MW[2] +  MW[16] * MW[3] ; DA trips
     MW[22] = MW[12] * MW[2] +  MW[17] * MW[3] ; SR trips
     MW[23] = MW[13] * MW[2] +  MW[18] * MW[3] ; LB trips
     MW[24] = MW[14] * MW[2] +  MW[19] * MW[3] ; PM trips
     MW[25] = MW[15] * MW[2] +  MW[20] * MW[3] ; NM trips

        ; Aggregate all trips
        JLOOP

           EDA = EDA + MW[21]
           ESR = ESR + MW[22]
           ELB = ELB + MW[23]
           EPM = EPM + MW[24]
           ENM = ENM + MW[25]

           TRN    = ELB + EPM
           AUT    = EDA + ESR
           TOT    = AUT + TRN + ENM

           IF (I==264 && J==264)
              print,list= "EST_EDA"  ," = ",EDA , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ESR"  ," = ",ESR , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ELB"  ," = ",ELB , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_EPM"  ," = ",EPM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_ENM"  ," = ",ENM , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TRN"  ," = ",TRN , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_AUT"  ," = ",AUT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
              print,list= "EST_TOT"  ," = ",TOT , FILE = "C:\projects\Roanoke\Base\OUTPUT\LOGS\HBSCESTIMATED.DAT",
 append = F
           ENDIF
        ENDJLOOP
Page 913  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

MATRIX Stack Size = 2822 bytes.
................................................................................


FILEI ZDATI=C:\projects\Roanoke\Base\Input\TrnWalkPercent.dbf Opened: 205 data records  6 Fields:
TAZ(N)          SHORTPARK(N)    LONGPARK(N)     PCWPROD(N)      PCWATTR(N)     
CBD(N)         


MATI[2] TPP C:\projects\Roanoke\Base\OUTPUT\Dest_HBSC.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:39 2016 
ID=
PAR Zones=267 M=1
  HBSC

MATI[1] TPP C:\projects\Roanoke\Base\OUTPUT\HBSC_MCPROB.MAT Opened
MAT PGM=MATRIX (v.08/05/2014 [6.1.1])  DATE=Tue Mar 29 14:18:36 2016 
ID=
PAR Zones=267 M=10
  cw_da_prob  cw_sr_prob  cw_wlkbus_prob  cw_wlkprem_prob  cw_nmot_prob  nt_da_prob
  nt_sr_prob  nt_wlkbus_prob  nt_wlkprem_prob  nt_nmot_probPage 914  (VOYAGER MATRIX) 
Parsons Brinckerhoff
---------------------------

Totals after Iteration 1 I loop:

	MI.02.001:  7,669.78     @J=I:  1,031.57  
	MI.01.001: 33,536.151    @J=I:    102.3546
	MI.01.002: 31,356.5756   @J=I:     95.7024
	MI.01.003:    116.6039
	MI.01.004:          --
	MI.01.005:  6,279.6695   @J=I:     68.9429
	MI.01.006: 33,593.494    @J=I:    102.3546
	MI.01.007: 31,410.1917   @J=I:     95.7024
	MI.01.008:          --
	MI.01.009:          --
	MI.01.010:  6,285.3143   @J=I:     68.9429
	MW[1]    :  7,669.78     @J=I:  1,031.57  
	MW[2]    :  2,636.7301   @J=I:    334.5146
	MW[3]    :  5,033.0499   @J=I:    697.0554
	MW[11]   : 33,536.151    @J=I:    102.3546
	MW[12]   : 31,356.5756   @J=I:     95.7024
	MW[13]   :    116.6039
	MW[14]   :          --
	MW[15]   :  6,279.6695   @J=I:     68.9429
	MW[16]   : 33,593.494    @J=I:    102.3546
	MW[17]   : 31,410.1917   @J=I:     95.7024
	MW[18]   :          --
	MW[19]   :          --
	MW[20]   :  6,285.3143   @J=I:     68.9429
	MW[21]   :  3,586.0637   @J=I:    395.1127
	MW[22]   :  3,352.9989   @J=I:    369.4336
	MW[23]   :     25.9185
	MW[24]   :          --
	MW[25]   :    704.7989   @J=I:    267.0237
	MO.01.001:  3,593.99  
	MO.01.002:  3,345.41  
	MO.01.003:     24.83  
	MO.01.005:    703.83  

Variable Values at end of Iteration 1 I loop:

    EDA: 3,586.0637
    ESR: 3,352.9989
    ELB:    25.9185
    ENM:   704.7989
    TRN:    25.9185
    AUT: 6,939.0626
    TOT: 7,669.78  

MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_AM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:48 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_MD.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:48 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_PM.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:49 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\TOD_Model_NT.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:49 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\MC_Transit_Trips.PRN. 
MATRIX (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:49 2016
MATRIX   ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:50 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\AM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:18:50 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:20
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:19:10 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\MD.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:19:11 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:16
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:19:27 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PM.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:19:28 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:34
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\ASHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:20:02 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\NT.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:20:02 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:07
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Merge_Hwy_Assignments.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Tue Mar 29 14:20:09 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Hwy_eval.PRN. 
NETWORK (v.08/05/2014 [6.1.1])  Tue Mar 29 14:20:09 2016
NETWORK  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\Output\Logs\PBHWY00B.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:20:09 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\ROANOKE\CUBE\PBHWY00A.PRN. 
HIGHWAY (v.08/05/2014 [6.1.1])  Tue Mar 29 14:20:10 2016
HIGHWAY  ReturnCode = 0  Elapsed Time = 00:00:00
################################################################################

M(100): COPY C:\projects\Roanoke\Base\Output\PK_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\PK_HWYSKIM_5.MAT
M(100): COPY C:\projects\Roanoke\Base\Output\OP_CNG_HwySkim.MAT C:\projects\Roanoke\Base\OUTPUT\OP_HWYSKIM_5.MAT

M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\Trn_Assignment_PK.PRN. 
PUBLIC TRANSPORT (v.08/05/2014 [6.1.1])  Tue Mar 29 14:20:10 2016
PUBLIC TRANSPORT ReturnCode = 1  Elapsed Time = 00:00:01
################################################################################


M(635): Switching print to C:\projects\Roanoke\Base\OUTPUT\LOGS\Trn_Assignment_OP.PRN. 
PUBLIC TRANSPORT (v.08/05/2014 [6.1.1])  Tue Mar 29 14:20:11 2016
PUBLIC TRANSPORT ReturnCode = 1  Elapsed Time = 00:00:00
################################################################################


--------------------------------------------------------------------------------

SYS "COPY "C:\projects\Roanoke\CUBE\*.PRN" "C:\projects\Roanoke\Base\OUTPUT\LOGS\*.PRN""
C:\projects\Roanoke\CUBE\ASHWY00A.PRN
C:\projects\Roanoke\CUBE\CVMAT00B.PRN
C:\projects\Roanoke\CUBE\PBHWY00A.PRN
C:\projects\Roanoke\CUBE\Roanoke Area MPO Model_0000.PRN
        4 file(s) copied.

SYS ReturnCode = 0

--------------------------------------------------------------------------------

--------------------------------------------------------------------------------

SYS "DEL "C:\projects\Roanoke\CUBE\*.PRN""
C:\projects\Roanoke\CUBE\Roanoke Area MPO Model_0000.PRN

SYS ReturnCode = 0

--------------------------------------------------------------------------------

VOYAGER  ReturnCode = 1  Elapsed Time = 00:09:11